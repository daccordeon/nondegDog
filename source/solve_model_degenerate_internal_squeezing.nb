(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    296068,       7266]
NotebookOptionsPosition[    291790,       7212]
NotebookOutlinePosition[    292155,       7228]
CellTagsIndexPosition[    292112,       7225]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell["\<\
Radiation pressure for degenerate internal squeezing
Using radiation pressure term from Hamiltonian in Li et al, 2020\
\>", "Text",
 CellChangeTimes->{{3.836608145765127*^9, 3.8366081624844303`*^9}, 
   3.836954525659338*^9, {3.8370281077462997`*^9, 3.8370281279494123`*^9}, {
   3.8371193960042877`*^9, 
   3.8371193966850567`*^9}},ExpressionUUID->"45536b2d-a4a5-4af5-902b-\
e0c4b447a39d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"unifying", " ", 
     RowBox[{"symbols", ":", " ", 
      RowBox[{"SRC", " ", "mode", " ", "is", " ", "now", " ", "b"}]}]}], ",", 
    " ", 
    RowBox[{"losses", " ", "are", " ", "now", " ", "\[Gamma]"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "changing", " ", "\[Omega]s", " ", "to", " ", "\[ImaginaryI]", " ", 
     "\[Omega]s", " ", "in", " ", "Hamiltonian"}], ",", " ", 
    RowBox[{"\[Phi]", "=", 
     RowBox[{
      FractionBox["\[Pi]", "2"], " ", "preserves", " ", "sign", " ", "of", 
      " ", "\[Chi]", " ", "for", " ", "squeezing"}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"setting", " ", "global", " ", "assumptions"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"$Assumptions", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[CapitalOmega]", "\[GreaterEqual]", "0"}], ",", 
       RowBox[{"\[Gamma]a", "\[GreaterEqual]", "0"}], ",", 
       RowBox[{"\[Gamma]btot", "\[GreaterEqual]", "\[Gamma]R", ">", "0"}], 
       ",", 
       RowBox[{"1", ">", "Rpd", "\[GreaterEqual]", "0"}], ",", 
       RowBox[{"\[Chi]", "\[GreaterEqual]", "0"}], ",", 
       RowBox[{"\[Omega]s", ">", "0"}], ",", 
       RowBox[{"Element", "[", 
        RowBox[{"\[Beta]", ",", "Reals"}], "]"}], ",", 
       RowBox[{"\[Rho]RP", "\[GreaterEqual]", "0"}], ",", 
       RowBox[{"Element", "[", 
        RowBox[{"\[Phi]", ",", "Reals"}], "]"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"\[Beta]", "=", 
      FractionBox[
       RowBox[{"\[Alpha]GW", " ", "Larm"}], 
       RowBox[{
        SuperscriptBox["2", 
         RowBox[{"1", "/", "2"}]], "\[HBar]"}]]}], ",", " ", 
     RowBox[{
      RowBox[{"\[Rho]RP", "=", 
       FractionBox[
        SuperscriptBox["\[Alpha]GW", "2"], 
        RowBox[{
         SuperscriptBox["2", 
          RowBox[{"1", "/", "2"}]], "\[HBar]", " ", "\[Mu]"}]]}], ";"}]}], 
    "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Id", "=", 
     RowBox[{"IdentityMatrix", "[", "2", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "simplifying", " ", "upstream", " ", "to", " ", "better", " ", "the", " ",
      "end", " ", "result"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Ma", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"\[Gamma]a", "-", 
         RowBox[{"\[ImaginaryI]", " ", "\[CapitalOmega]"}]}], ")"}], "Id"}], 
      "+", 
      RowBox[{
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", "\[Rho]RP"}], 
        RowBox[{
         SuperscriptBox["2", 
          RowBox[{"1", "/", "2"}]], 
         SuperscriptBox["\[CapitalOmega]", "2"]}]], 
       RowBox[{"(", GridBox[{
          {"1", "1"},
          {
           RowBox[{"-", "1"}], 
           RowBox[{"-", "1"}]}
         }], ")"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"invMa", "=", 
     RowBox[{
      RowBox[{"Inverse", "[", "Ma", "]"}], "//", "Simplify"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Mb", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"\[Gamma]btot", "-", 
         RowBox[{"\[ImaginaryI]", " ", "\[CapitalOmega]"}]}], ")"}], "Id"}], 
      "+", 
      RowBox[{
       SuperscriptBox["\[Omega]s", "2"], "invMa"}], "+", 
      RowBox[{"\[Chi]", 
       RowBox[{"(", GridBox[{
          {"0", 
           RowBox[{"\[ImaginaryI]", " ", 
            RowBox[{"Exp", "[", 
             RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}], "]"}]}]},
          {
           RowBox[{
            RowBox[{"-", "\[ImaginaryI]"}], " ", 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Phi]"}], "]"}]}], "0"}
         }], ")"}]}]}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"\[Phi]", " ", "free", " ", "in", " ", "Hamiltonian"}], ",", " ", 
     RowBox[{
      RowBox[{"recover", " ", "when", " ", "\[Phi]"}], "=", 
      FractionBox["\[Pi]", "2"]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"invMb", "=", 
     RowBox[{
      RowBox[{"Inverse", "[", "Mb", "]"}], "//", "Simplify"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[CapitalGamma]", "=", 
     RowBox[{
      FractionBox["1", 
       SuperscriptBox["2", 
        RowBox[{"1", "/", "2"}]]], 
      RowBox[{"(", GridBox[{
         {"1", "1"},
         {
          RowBox[{"-", "\[ImaginaryI]"}], "\[ImaginaryI]"}
        }], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Rin", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "-", "Rpd"}], ")"}], 
         RowBox[{"1", "/", "2"}]], 
        RowBox[{"\[CapitalGamma]", ".", 
         RowBox[{"(", 
          RowBox[{"Id", "-", 
           RowBox[{"2", " ", "\[Gamma]R", " ", "invMb"}]}], ")"}], ".", 
         RowBox[{"Inverse", "[", "\[CapitalGamma]", "]"}]}]}], ")"}], "//", 
      "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Ra", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "-", "Rpd"}], ")"}], 
          RowBox[{"1", "/", "2"}]]}], "2", " ", "\[Omega]s", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"\[Gamma]R", " ", "\[Gamma]a"}], ")"}], 
         RowBox[{"1", "/", "2"}]], 
        RowBox[{"\[CapitalGamma]", ".", " ", "invMb", ".", "invMa", ".", 
         RowBox[{"Inverse", "[", "\[CapitalGamma]", "]"}]}]}], ")"}], "//", 
      "Simplify"}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{
    "\[Omega]s", " ", "to", " ", "\[ImaginaryI]", " ", "\[Omega]s", " ", "in",
      " ", "Hamiltonian"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Rb", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "-", "Rpd"}], ")"}], 
          RowBox[{"1", "/", "2"}]]}], "2", 
        SuperscriptBox[
         RowBox[{"(", " ", 
          RowBox[{"\[Gamma]R", 
           RowBox[{"(", 
            RowBox[{"\[Gamma]btot", "-", "\[Gamma]R"}], ")"}]}], ")"}], 
         RowBox[{"1", "/", "2"}]], 
        RowBox[{"\[CapitalGamma]", ".", " ", "invMb", ".", 
         RowBox[{"Inverse", "[", "\[CapitalGamma]", "]"}]}]}], ")"}], "//", 
      "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"T", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "-", "Rpd"}], ")"}], 
          RowBox[{"1", "/", "2"}]]}], "\[Omega]s", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Beta]"}], ")"}], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"2", " ", "\[Gamma]R"}], ")"}], 
         RowBox[{"1", "/", "2"}]], 
        RowBox[{"\[CapitalGamma]", ".", " ", "invMb", ".", "invMa", ".", 
         RowBox[{"(", GridBox[{
            {"1", "0"},
            {"0", 
             RowBox[{"-", "1"}]}
           }], ")"}]}]}], ")"}], "//", "Simplify"}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{
    "\[Omega]s", " ", "to", " ", "\[ImaginaryI]", " ", "\[Omega]s", " ", "in",
      " ", "Hamiltonian"}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FlipI", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[ImaginaryI]", "\[Rule]", 
        RowBox[{"-", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"Complex", "[", 
         RowBox[{"RePart_", ",", "ImPart_"}], "]"}], "\[Rule]", 
        RowBox[{"Complex", "[", 
         RowBox[{"RePart", ",", 
          RowBox[{"-", "ImPart"}]}], "]"}]}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ConjugateFlipI", "=", 
     RowBox[{
      RowBox[{"Conjugate", "[", "f_", "]"}], ":>", 
      RowBox[{"(", 
       RowBox[{"f", "/.", "FlipI"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"SxExtSqz", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"extSqzFactor", " ", 
           RowBox[{"Rin", ".", 
            RowBox[{"ConjugateTranspose", "[", "Rin", "]"}]}]}], 
          "\[IndentingNewLine]", "+", 
          RowBox[{"Ra", ".", 
           RowBox[{"ConjugateTranspose", "[", "Ra", "]"}]}], 
          "\[IndentingNewLine]", "+", 
          RowBox[{"Rb", ".", 
           RowBox[{"ConjugateTranspose", "[", "Rb", "]"}]}], 
          "\[IndentingNewLine]", "+", 
          RowBox[{"Rpd", " ", "Id"}]}], ")"}], "/.", "ConjugateFlipI"}], ",", 
       
       RowBox[{"TimeConstraint", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"1", ",", "5"}], "}"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Sx", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{"SxExtSqz", "/.", 
        RowBox[{"{", 
         RowBox[{"extSqzFactor", "\[Rule]", "1"}], "}"}]}], ",", 
       RowBox[{"TimeConstraint", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"1", ",", "5"}], "}"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"signal", " ", "transfer", " ", "function", " ", "is", " ", 
     SubscriptBox["X", 
      RowBox[{"PD", ",", "2"}]], " ", "wrt", " ", "h", " ", "not", " ", 
     SubscriptBox[
      OverscriptBox["X", "\[RightVector]"], "PD"], " ", "wrt", " ", 
     OverscriptBox["h", "\[RightVector]"]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sigTransfer", " ", "=", " ", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"T", ".", 
           RowBox[{"(", GridBox[{
              {"1"},
              {"1"}
             }], ")"}]}], ")"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"TimeConstraint", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"1", ",", "5"}], "}"}]}]}], "]"}]}], ";", 
    RowBox[{"(*", 
     RowBox[{"2", "nd", " ", 
      RowBox[{"index", ":", " ", 
       RowBox[{
        RowBox[{"[", 
         RowBox[{"[", "1", "]"}], "]"}], " ", "to", " ", "remove", " ", 
        "atomic", " ", "brackets", " ", 
        RowBox[{"{", "...", "}"}]}]}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"sigTransferAbs", "=", 
     RowBox[{
      RowBox[{"ComplexExpand", "[", 
       RowBox[{"Abs", "[", "sigTransfer", "]"}], "]"}], "//", "Simplify"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Sh", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       FractionBox[
        RowBox[{"Sx", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "2"}], "]"}], "]"}], 
        SuperscriptBox["sigTransferAbs", "2"]], ",", 
       RowBox[{"TimeConstraint", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"1", ",", "5"}], "}"}]}]}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.8370361340669193`*^9, 3.837036180707151*^9}, {
   3.8370362437573853`*^9, 3.837036307405931*^9}, {3.837036500931703*^9, 
   3.837036517799774*^9}, {3.837114172344533*^9, 3.837114179471784*^9}, {
   3.837115099067765*^9, 3.8371151000737343`*^9}, {3.83711587789888*^9, 
   3.8371158785770407`*^9}, {3.83711870531178*^9, 3.837118754087072*^9}, {
   3.8371193686532707`*^9, 3.83711936985748*^9}, {3.8375577895742197`*^9, 
   3.837557800011529*^9}, {3.837816080840569*^9, 3.837816180567855*^9}, {
   3.8378164984175034`*^9, 3.837816506296455*^9}, {3.83816856719524*^9, 
   3.838168615185586*^9}, {3.838338414285323*^9, 3.8383384153413553`*^9}, {
   3.838343945327281*^9, 3.8383439484992867`*^9}, 3.838408573554141*^9, {
   3.848097729951092*^9, 3.848097794465191*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"82ed1d9d-d455-44d6-abc1-1f61ee2e60e3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"printing", " ", "to", " ", "python"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"toPythonTranslation", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[CapitalOmega]", "\[Rule]", "W"}], ",", 
       RowBox[{"\[Beta]", "\[Rule]", "B"}], ",", 
       RowBox[{"\[Omega]s", "\[Rule]", "ws"}], ",", 
       RowBox[{"\[Chi]", "\[Rule]", "x"}], ",", 
       RowBox[{"\[Gamma]a", "\[Rule]", "ga"}], ",", 
       RowBox[{"\[Gamma]btot", "\[Rule]", "gbtot"}], ",", 
       RowBox[{"\[Gamma]R", "\[Rule]", "gbR"}], ",", 
       RowBox[{"\[Phi]", "\[Rule]", "phiPump"}], ",", 
       RowBox[{"\[Rho]RP", "\[Rule]", "rho"}]}], "}"}]}], ";", 
    RowBox[{"(*", 
     RowBox[{"Rpd", ",", " ", "extSqzFactor"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"path", ",", "nb"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"path", "=", 
        RowBox[{
         RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
         "\"\<ExportToPython.nb\>\""}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"nb", "=", 
        RowBox[{"NotebookOpen", "[", 
         RowBox[{"path", ",", 
          RowBox[{"CellContext", "\[Rule]", "\"\<Global`\>\""}], ",", 
          RowBox[{"Visible", "\[Rule]", "False"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"NotebookEvaluate", "[", 
        RowBox[{"nb", ",", 
         RowBox[{"InsertResults", "\[Rule]", "False"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"NotebookClose", "[", "nb", "]"}]}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pyCode", " ", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Simplify", "[", " ", 
        RowBox[{
         RowBox[{"Sqrt", "[", 
          FractionBox[
           RowBox[{"SxExtSqz", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "2"}], "]"}], "]"}], 
           SuperscriptBox["sigTransferAbs", "2"]], "]"}], ",", 
         RowBox[{"TimeConstraint", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"1", ",", "5"}], "}"}]}]}], "]"}], "/.", 
       "toPythonTranslation"}], "//", "ToPython"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
       "\"\<ASDSh_dIS.py\>\""}], ",", "pyCode", ",", "\"\<Text\>\""}], "]"}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.8480976915603647`*^9, 3.848097712501581*^9}, {
   3.848097808424271*^9, 3.848097885919339*^9}, 3.84809798745649*^9},
 CellLabel->"In[18]:=",ExpressionUUID->"d7fd8a80-29e1-4f12-a9c5-5b0bee0a510a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"T", ".", 
    RowBox[{"(", GridBox[{
       {"1"},
       {"1"}
      }], ")"}]}], "//", "FullSimplify"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.840833930140916*^9, 3.8408339591299353`*^9}, {
  3.840834015106812*^9, 3.840834015534034*^9}},
 CellLabel->"In[22]:=",ExpressionUUID->"e2e25cae-7390-49f8-96ee-d23eff51a728"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"signal", " ", "transfer", " ", 
    RowBox[{"function", " ", "--"}], " ", "demonstration", " ", "of", " ", 
    "factor", " ", "of", " ", "two"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"FullSimplify", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"T", ".", 
          RowBox[{"(", GridBox[{
             {"1"},
             {"1"}
            }], ")"}]}], ")"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Rho]RP", "\[Rule]", "0"}], ",", 
        RowBox[{"Rpd", "\[Rule]", "0"}], ",", 
        RowBox[{"\[Gamma]a", "\[Rule]", "0"}], ",", 
        RowBox[{"\[Gamma]btot", "\[Rule]", "\[Gamma]R"}], ",", 
        RowBox[{"\[Beta]", "->", 
         RowBox[{"-", "\[Beta]"}]}], ",", 
        RowBox[{"\[Phi]", "\[Rule]", 
         FractionBox["\[Pi]", "2"]}]}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FullSimplify", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"T", ".", 
         RowBox[{"ConjugateTranspose", "[", "T", "]"}]}], ")"}], "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "2"}], "]"}], "]"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Rho]RP", "\[Rule]", "0"}], ",", 
        RowBox[{"Rpd", "\[Rule]", "0"}], ",", 
        RowBox[{"\[Gamma]a", "\[Rule]", "0"}], ",", 
        RowBox[{"\[Gamma]btot", "\[Rule]", "\[Gamma]R"}], ",", 
        RowBox[{"\[Beta]", "->", 
         RowBox[{"-", "\[Beta]"}]}], ",", 
        RowBox[{"\[Phi]", "\[Rule]", 
         FractionBox["\[Pi]", "2"]}]}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<sig. transfer fn.: \>\"", ",", 
     RowBox[{"Simplify", "[", 
      RowBox[{"ComplexExpand", "[", 
       SuperscriptBox[
        RowBox[{"Abs", "[", "%%", "]"}], "2"], "]"}], "]"}], ",", 
     "\"\< vs \>\"", ",", " ", "%"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.836852422583626*^9, 3.836852446092558*^9}, {
   3.836852608926764*^9, 3.836852612853466*^9}, {3.836852670946411*^9, 
   3.836852695906394*^9}, {3.836853583920683*^9, 3.836853700033813*^9}, 
   3.836853795651004*^9, 3.836854294221211*^9, {3.8368556314624023`*^9, 
   3.836855791827155*^9}, {3.8368560406605167`*^9, 3.836856107995846*^9}, {
   3.836856275043109*^9, 3.836856347877851*^9}, {3.836856397181004*^9, 
   3.836856481102168*^9}, {3.836857061152836*^9, 3.836857066045846*^9}, {
   3.836961728026432*^9, 3.836961741177249*^9}, {3.837029352985717*^9, 
   3.837029364112761*^9}, {3.837115957406657*^9, 3.837115960655568*^9}, {
   3.837116597912545*^9, 3.837116604536421*^9}, {3.837816258247685*^9, 
   3.837816276542635*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"30f0d068-9672-4682-bcd1-c84a629aa724"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"with", " ", "RP", " ", "off"}], ",", " ", 
    RowBox[{"does", " ", "it", " ", "reduce", " ", "to", " ", 
     SuperscriptBox[
      RowBox[{"(", "ASD", ")"}], "2"], " ", "from", " ", 
     RowBox[{"degIntSqz", ".", 
      RowBox[{"nb", "?"}]}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"PSDShdegIntSqz", "=", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"4", " ", "\[Gamma]R", " ", 
        SuperscriptBox["\[Omega]s", "2"], " ", 
        SuperscriptBox["\[Beta]", "2"], " "}]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", "\[Gamma]R"}], "-", "\[Gamma]btot", "-", 
                "\[Chi]"}], ")"}], "\[Gamma]a"}], "+", 
             SuperscriptBox["\[CapitalOmega]", "2"], "-", 
             SuperscriptBox["\[Omega]s", "2"]}], ")"}], "2"], 
          "\[IndentingNewLine]", "\t\t\t\t\t\t", "+", 
          RowBox[{
           SuperscriptBox["\[CapitalOmega]", "2"], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"\[Gamma]a", "-", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", "\[Gamma]R"}], "-", "\[Gamma]btot", "-", 
                "\[Chi]"}], ")"}]}], ")"}], "2"]}]}], ")"}], 
        "\[IndentingNewLine]", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["\[Gamma]a", "2"], "+", " ", 
           SuperscriptBox["\[CapitalOmega]", "2"]}], ")"}], "4", "\[Gamma]R", 
         " ", 
         RowBox[{"(", 
          RowBox[{"\[Gamma]btot", "-", "\[Gamma]R"}], ")"}]}], 
        "\[IndentingNewLine]", "+", 
        RowBox[{"4", "\[Gamma]R", " ", "\[Gamma]a", " ", 
         SuperscriptBox["\[Omega]s", "2"]}], "\[IndentingNewLine]", "+", " ", 
        
        RowBox[{
         FractionBox["Rpd", 
          RowBox[{"1", "-", "Rpd"}]], 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "\[Gamma]btot"}], "-", "\[Chi]"}], ")"}], 
               "\[Gamma]a"}], "+", 
              SuperscriptBox["\[CapitalOmega]", "2"], "-", 
              SuperscriptBox["\[Omega]s", "2"]}], ")"}], "2"], 
           "\[IndentingNewLine]", "\t\t", "+", 
           RowBox[{
            SuperscriptBox["\[CapitalOmega]", "2"], 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"\[Gamma]a", "-", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "\[Gamma]btot"}], "-", "\[Chi]"}], ")"}]}], 
              ")"}], "2"]}]}], ")"}]}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{
    "\"\<Rad. pressure off, does Sh reduce to degIntSqz?: \>\"", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"%", "==", 
         RowBox[{"(", 
          RowBox[{"Sh", "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\[Rho]RP", "\[Rule]", "0"}], ",", 
             RowBox[{"\[Beta]", "\[Rule]", 
              RowBox[{"-", "\[Beta]"}]}], ",", 
             RowBox[{"\[Phi]", "\[Rule]", 
              FractionBox["\[Pi]", "2"]}]}], "}"}]}], ")"}]}], ")"}], "//", 
       "ComplexExpand"}], "//", "Simplify"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.836856675279872*^9, 3.836856731611006*^9}, {
   3.836856799991077*^9, 3.83685680084929*^9}, 3.836857071679143*^9, {
   3.836857932631248*^9, 3.836857933003357*^9}, {3.836858447635504*^9, 
   3.836858482127761*^9}, {3.8368587838765163`*^9, 3.8368587860779257`*^9}, {
   3.83685884536979*^9, 3.836858870011915*^9}, {3.837029450589748*^9, 
   3.837029550303706*^9}, {3.837029650885507*^9, 3.837029664890517*^9}, {
   3.8370297473607883`*^9, 3.837029773141411*^9}, {3.837029806716217*^9, 
   3.8370298101061497`*^9}, {3.83703030149457*^9, 3.837030337956089*^9}, {
   3.837030513020359*^9, 3.837030513631012*^9}, {3.8371160032191057`*^9, 
   3.837116084645262*^9}, {3.8371161149465714`*^9, 3.837116176037072*^9}, {
   3.83711930018622*^9, 3.837119329873866*^9}, {3.837124309829342*^9, 
   3.837124315654167*^9}, {3.837555655626155*^9, 3.8375556591852427`*^9}, {
   3.8378164325522833`*^9, 3.837816447151998*^9}, {3.83781654671091*^9, 
   3.837816565286861*^9}, {3.8449945579557343`*^9, 
   3.84499455899312*^9}},ExpressionUUID->"6fe9231a-e423-450e-8ffd-\
ff95966f8692"],

Cell[BoxData[
 RowBox[{"Collect", "[", 
  RowBox[{
   RowBox[{"ComplexExpand", "[", 
    RowBox[{
     RowBox[{"Sx", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "2"}], "]"}], "]"}], "/.", 
     RowBox[{"\[Phi]", "\[Rule]", 
      FractionBox["\[Pi]", "2"]}]}], "]"}], ",", 
   RowBox[{"{", "\[Rho]RP", "}"}], ",", "FullSimplify"}], "]"}]], "Input",
 CellChangeTimes->{{3.836872622185857*^9, 3.8368726324945517`*^9}, {
  3.836874631946335*^9, 3.836874647078651*^9}, {3.8371162515156593`*^9, 
  3.837116251665213*^9}, {3.837116356604928*^9, 3.837116359328244*^9}, {
  3.8371166286992207`*^9, 3.837116628858039*^9}, {3.8371194128805723`*^9, 
  3.837119416124069*^9}, {3.8375557942945843`*^9, 3.837555795237213*^9}, {
  3.8378165808550577`*^9, 3.8378166018743753`*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"5482d970-0109-4d15-a2e8-9b7c4ce43fb5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"stability", " ", "is", " ", "not", " ", "the", " ", 
     RowBox[{"same", ":", " ", 
      RowBox[{
      "recognise", " ", "denominator", " ", "as", " ", "the", " ", "same", 
       " ", "as", " ", "degIntSqz", " ", "or", " ", "the", " ", "same", " ", 
       "*", " ", "samewith\[Chi]flip"}]}]}], ",", " ", 
    RowBox[{
     RowBox[{"therefore", " ", "pole"}], "-", 
     RowBox[{
     "defined", " ", "threshold", " ", "values", " ", "are", " ", "the", " ", 
      "same", " ", "with", " ", "the", " ", "addition", " ", "of", " ", "the",
       " ", "\[Chi]flip", " ", "values", " ", "as", " ", "well"}]}]}], "*)"}],
   "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["\[Gamma]btot", "2"], " ", 
          SuperscriptBox["\[CapitalOmega]", "2"]}], "+", 
         RowBox[{"2", " ", "\[Gamma]btot", " ", "\[Chi]", " ", 
          SuperscriptBox["\[CapitalOmega]", "2"]}], "+", 
         RowBox[{
          SuperscriptBox["\[Chi]", "2"], " ", 
          SuperscriptBox["\[CapitalOmega]", "2"]}], "+", 
         SuperscriptBox["\[CapitalOmega]", "4"], "+", 
         RowBox[{
          SuperscriptBox["\[Gamma]a", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["\[Gamma]btot", "2"], "+", 
            RowBox[{"2", " ", "\[Gamma]btot", " ", "\[Chi]"}], "+", 
            SuperscriptBox["\[Chi]", "2"], "+", 
            SuperscriptBox["\[CapitalOmega]", "2"]}], ")"}]}], "+", 
         RowBox[{"2", " ", "\[Gamma]a", " ", 
          RowBox[{"(", 
           RowBox[{"\[Gamma]btot", "+", "\[Chi]"}], ")"}], " ", 
          SuperscriptBox["\[Omega]s", "2"]}], "-", 
         RowBox[{"2", " ", 
          SuperscriptBox["\[CapitalOmega]", "2"], " ", 
          SuperscriptBox["\[Omega]s", "2"]}], "+", 
         SuperscriptBox["\[Omega]s", "4"]}], ")"}], "\[Equal]", 
       SuperscriptBox[
        RowBox[{"Abs", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Gamma]btot", "+", "\[Chi]", "-", 
             RowBox[{"I", " ", "\[CapitalOmega]"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"\[Gamma]a", "-", 
             RowBox[{"\[ImaginaryI]", " ", "\[CapitalOmega]"}]}], ")"}]}], 
          "+", 
          SuperscriptBox["\[Omega]s", "2"]}], "]"}], "2"]}], ")"}], "//", 
     "ComplexExpand"}], "//", "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["\[Gamma]btot", "4"], " ", 
          SuperscriptBox["\[CapitalOmega]", "4"]}], "+", 
         RowBox[{
          SuperscriptBox["\[Gamma]a", "4"], " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["\[Gamma]btot", "4"], "-", 
            RowBox[{"2", " ", 
             SuperscriptBox["\[Gamma]btot", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["\[Chi]", "2"], "-", 
               SuperscriptBox["\[CapitalOmega]", "2"]}], ")"}]}], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["\[Chi]", "2"], "+", 
               SuperscriptBox["\[CapitalOmega]", "2"]}], ")"}], "2"]}], 
           ")"}]}], "+", 
         RowBox[{"4", " ", 
          SuperscriptBox["\[Gamma]a", "3"], " ", "\[Gamma]btot", " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["\[Gamma]btot", "2"], "-", 
            SuperscriptBox["\[Chi]", "2"], "+", 
            SuperscriptBox["\[CapitalOmega]", "2"]}], ")"}], " ", 
          SuperscriptBox["\[Omega]s", "2"]}], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["\[Gamma]btot", "2"], " ", 
          SuperscriptBox["\[CapitalOmega]", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              SuperscriptBox["\[Chi]", "2"]}], " ", 
             SuperscriptBox["\[CapitalOmega]", "2"]}], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["\[CapitalOmega]", "2"], "-", 
               SuperscriptBox["\[Omega]s", "2"]}], ")"}], "2"]}], ")"}]}], 
         "+", 
         RowBox[{"4", " ", "\[Gamma]a", " ", "\[Gamma]btot", " ", 
          SuperscriptBox["\[Omega]s", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["\[Gamma]btot", "2"], " ", 
             SuperscriptBox["\[CapitalOmega]", "2"]}], "-", 
            RowBox[{
             SuperscriptBox["\[Chi]", "2"], " ", 
             SuperscriptBox["\[CapitalOmega]", "2"]}], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["\[CapitalOmega]", "2"], "-", 
               SuperscriptBox["\[Omega]s", "2"]}], ")"}], "2"]}], ")"}]}], 
         "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["\[Chi]", "2"], " ", 
             SuperscriptBox["\[CapitalOmega]", "2"]}], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["\[CapitalOmega]", "2"], "-", 
               SuperscriptBox["\[Omega]s", "2"]}], ")"}], "2"]}], ")"}], "2"],
          "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["\[Gamma]a", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["\[Gamma]btot", "4"], " ", 
             SuperscriptBox["\[CapitalOmega]", "2"]}], "+", 
            RowBox[{
             SuperscriptBox["\[Chi]", "4"], " ", 
             SuperscriptBox["\[CapitalOmega]", "2"]}], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["\[CapitalOmega]", "3"], "-", 
               RowBox[{"\[CapitalOmega]", " ", 
                SuperscriptBox["\[Omega]s", "2"]}]}], ")"}], "2"], "+", 
            RowBox[{
             SuperscriptBox["\[Chi]", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", 
                SuperscriptBox["\[CapitalOmega]", "4"]}], "-", 
               RowBox[{"2", " ", 
                SuperscriptBox["\[CapitalOmega]", "2"], " ", 
                SuperscriptBox["\[Omega]s", "2"]}], "-", 
               SuperscriptBox["\[Omega]s", "4"]}], ")"}]}], "+", 
            RowBox[{
             SuperscriptBox["\[Gamma]btot", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "2"}], " ", 
                SuperscriptBox["\[Chi]", "2"], " ", 
                SuperscriptBox["\[CapitalOmega]", "2"]}], "+", 
               RowBox[{"2", " ", 
                SuperscriptBox["\[CapitalOmega]", "4"]}], "-", 
               RowBox[{"2", " ", 
                SuperscriptBox["\[CapitalOmega]", "2"], " ", 
                SuperscriptBox["\[Omega]s", "2"]}], "+", 
               RowBox[{"3", " ", 
                SuperscriptBox["\[Omega]s", "4"]}]}], ")"}]}]}], ")"}]}]}], 
        ")"}], "\[Equal]", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"\[Gamma]btot", "+", "\[Chi]", "-", 
               RowBox[{"I", " ", "\[CapitalOmega]"}]}], ")"}], 
             RowBox[{"(", 
              RowBox[{"\[Gamma]a", "-", 
               RowBox[{"\[ImaginaryI]", " ", "\[CapitalOmega]"}]}], ")"}]}], 
            "+", 
            SuperscriptBox["\[Omega]s", "2"]}], "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Abs", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"\[Gamma]btot", "+", "\[Chi]", "-", 
                 RowBox[{"I", " ", "\[CapitalOmega]"}]}], ")"}], 
               RowBox[{"(", 
                RowBox[{"\[Gamma]a", "-", 
                 RowBox[{"\[ImaginaryI]", " ", "\[CapitalOmega]"}]}], ")"}]}],
               "+", 
              SuperscriptBox["\[Omega]s", "2"]}], "]"}], "/.", 
            RowBox[{"\[Chi]", "\[Rule]", 
             RowBox[{"-", "\[Chi]"}]}]}], ")"}]}], ")"}], "2"]}], ")"}], "//",
      "ComplexExpand"}], "//", "Simplify"}]}]}]], "Input",
 CellChangeTimes->{{3.836873207222728*^9, 3.836873234141214*^9}, {
   3.836874242070434*^9, 3.836874255793519*^9}, {3.836956467863*^9, 
   3.836956472563044*^9}, {3.837116318721567*^9, 3.837116346565077*^9}, {
   3.837116453012095*^9, 3.8371165286087418`*^9}, {3.837116708438354*^9, 
   3.837116713961341*^9}, {3.837116921340691*^9, 3.837116952861285*^9}, {
   3.8371170206212273`*^9, 3.83711704325019*^9}, {3.837117093350708*^9, 
   3.837117135369665*^9}, {3.8371208219151087`*^9, 3.83712083299234*^9}, 
   3.837120872985526*^9, {3.837120906719513*^9, 3.837120916781329*^9}, {
   3.83755689914712*^9, 3.837556921249544*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"d30fd5b1-af48-46e9-b26a-c7264abd19fc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"simplify", " ", "Sx22"}], ",", " ", 
    RowBox[{"from", " ", 
     RowBox[{"nIS_RP", ".", "nb"}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"noise\[CapitalDelta]Sx", "=", 
        RowBox[{"Together", "[", 
         RowBox[{
          RowBox[{"Sx", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "2"}], "]"}], "]"}], "-", "1"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"SimplifyConstrained", "=", 
        RowBox[{
         RowBox[{"FullSimplify", "[", 
          RowBox[{"#", ",", 
           RowBox[{"TimeConstraint", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"0.1", ",", "1"}], "}"}]}]}], "]"}], "&"}]}]}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"numer\[CapitalDelta]Sx", "=", 
       RowBox[{"Collect", "[", 
        RowBox[{
         RowBox[{"Numerator", "[", "noise\[CapitalDelta]Sx", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Phi]", ",", "\[Rho]RP"}], "}"}], ",", 
         "SimplifyConstrained"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"denom\[CapitalDelta]Sx", "=", 
       RowBox[{"Collect", "[", 
        RowBox[{
         RowBox[{"Denominator", "[", "noise\[CapitalDelta]Sx", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Phi]", ",", "\[Rho]RP"}], "}"}], ",", 
         "SimplifyConstrained"}], "]"}]}], ";"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"commonFactor0", "=", 
     RowBox[{
      FractionBox["1", "4"], 
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", "2"}], "\[ImaginaryI]", " ", "\[Phi]"}], "]"}]}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"numer\[CapitalDelta]SxSimpl", "=", 
     RowBox[{"Collect", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"commonFactor0", " ", "numer\[CapitalDelta]Sx"}], ")"}], "//",
         "ExpToTrig"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Phi]", ",", "\[Rho]RP"}], "}"}], ",", "FullSimplify"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"denom\[CapitalDelta]SxSimpl", "=", 
     RowBox[{"Collect", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"commonFactor0", " ", "denom\[CapitalDelta]Sx"}], ")"}], "//",
         "ExpToTrig"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Phi]", ",", "\[Rho]RP"}], "}"}], ",", "FullSimplify"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "denominator", " ", "is", " ", "not", " ", "the", " ", "same", " ", "as", 
     " ", "no", " ", "RP", " ", "case", " ", "if", " ", "pump", " ", "phase", 
     " ", "is", " ", "not", " ", 
     FractionBox["\[Pi]", "2"]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{
    "\"\<\!\(\*SubscriptBox[\(S\), \(X\)]\)=1 + (\>\"", ",", 
     "numer\[CapitalDelta]SxSimpl", ",", "\"\<)\\n/\\n(\>\"", ",", 
     "denom\[CapitalDelta]SxSimpl", ",", "\"\<)\>\""}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.838168966307119*^9, 3.838169032932461*^9}, {
  3.83816916954093*^9, 3.838169222149097*^9}, {3.838169648670581*^9, 
  3.838169664273117*^9}, {3.838170746536345*^9, 3.83817076457382*^9}, {
  3.838335506049844*^9, 3.8383355069556*^9}, {3.838773731233733*^9, 
  3.838773743108602*^9}, {3.838773808111178*^9, 3.838773855868493*^9}, {
  3.8387739033101673`*^9, 3.838773910519978*^9}, {3.838773972029265*^9, 
  3.838773978510654*^9}, {3.8387743866636333`*^9, 3.838774387370776*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"fdabf410-0428-4cce-a6cb-ac8c28bc1b8d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "+", 
     FractionBox["numer\[CapitalDelta]SxSimpl", 
      "denom\[CapitalDelta]SxSimpl"]}], ")"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Gamma]a", "\[Rule]", "0"}], ",", 
     RowBox[{"\[Gamma]btot", "\[Rule]", "\[Gamma]R"}], ",", 
     RowBox[{"Rpd", "\[Rule]", "0"}], ",", 
     RowBox[{"\[Rho]RP", "\[Rule]", "0"}], ",", 
     RowBox[{"\[Phi]", "\[Rule]", 
      RowBox[{
       RowBox[{"-", "\[Pi]"}], "/", "2"}]}]}], "}"}]}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.840843026018128*^9, 3.840843136887679*^9}, {
  3.84084317157756*^9, 3.840843178205405*^9}, {3.840843460238504*^9, 
  3.840843470544179*^9}},
 CellLabel->"In[54]:=",ExpressionUUID->"1d4ae29c-e9e3-4dfe-9c0f-df988ab62690"],

Cell[BoxData[{
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"sigTsqr", "=", 
     RowBox[{"Together", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"ComplexExpand", "[", 
          RowBox[{"Abs", "[", 
           RowBox[{"Simplify", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"T", ".", 
                 RowBox[{"(", GridBox[{
                    {"1"},
                    {"1"}
                   }], ")"}]}], ")"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"TimeConstraint", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"1", ",", "5"}], "}"}]}]}], "]"}], "]"}], "]"}], "//", 
         "Simplify"}], ")"}], "^", "2"}], "]"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SimplifyConstrained", "=", 
     RowBox[{
      RowBox[{"FullSimplify", "[", 
       RowBox[{"#", ",", 
        RowBox[{"TimeConstraint", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"0.1", ",", "1"}], "}"}]}]}], "]"}], "&"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"commonFactor0", "=", 
     RowBox[{"1", "/", "2"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"numerTsqr", "=", 
     RowBox[{"Collect", "[", 
      RowBox[{
       RowBox[{"commonFactor0", " ", 
        RowBox[{"Numerator", "[", "sigTsqr", "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Phi]", ",", "\[Rho]RP"}], "}"}], ",", 
       "SimplifyConstrained"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"denomTsqr", "=", 
     RowBox[{"Collect", "[", 
      RowBox[{
       RowBox[{"commonFactor0", " ", 
        RowBox[{"Denominator", "[", "sigTsqr", "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Phi]", ",", "\[Rho]RP"}], "}"}], ",", 
       "SimplifyConstrained"}], "]"}]}], ";"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{
  "\"\<(\>\"", ",", "numerTsqr", ",", "\"\<)\\n/\\n(\>\"", ",", "denomTsqr", 
   ",", "\"\<)\>\""}], "]"}]}], "Input",
 CellChangeTimes->{{3.840838356806849*^9, 3.840838403117729*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"f55820aa-1de0-499e-b921-88ea8750a664"],

Cell[BoxData[
 RowBox[{"numerTsqr", "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.8408385441271763`*^9, 3.840838560488057*^9}, {
   3.840838604925634*^9, 3.840838608131765*^9}, 3.840838692761793*^9},
 CellLabel->"In[35]:=",ExpressionUUID->"d0adf565-d976-40fa-b655-c2deb818e844"],

Cell[BoxData[{
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"sigTsqr", "=", 
     RowBox[{"Together", "[", 
      RowBox[{"sigTransferAbs", "^", "2"}], "]"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SimplifyConstrained", "=", 
     RowBox[{
      RowBox[{"FullSimplify", "[", 
       RowBox[{"#", ",", 
        RowBox[{"TimeConstraint", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"0.1", ",", "1"}], "}"}]}]}], "]"}], "&"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"commonFactor0", "=", 
     RowBox[{"1", "/", "2"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"numerTsqr", "=", 
     RowBox[{"Collect", "[", 
      RowBox[{
       RowBox[{"commonFactor0", " ", 
        RowBox[{"Numerator", "[", "sigTsqr", "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Phi]", ",", "\[Rho]RP"}], "}"}], ",", 
       "SimplifyConstrained"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"denomTsqr", "=", 
     RowBox[{"Collect", "[", 
      RowBox[{
       RowBox[{"commonFactor0", " ", 
        RowBox[{"Denominator", "[", "sigTsqr", "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Phi]", ",", "\[Rho]RP"}], "}"}], ",", 
       "SimplifyConstrained"}], "]"}]}], ";"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{
  "\"\<(\>\"", ",", "numerTsqr", ",", "\"\<)\\n/\\n(\>\"", ",", "denomTsqr", 
   ",", "\"\<)\>\""}], "]"}]}], "Input",
 CellChangeTimes->{{3.838334941037148*^9, 3.838334951688712*^9}, {
   3.8383351040323353`*^9, 3.838335176143401*^9}, {3.8383352397795486`*^9, 
   3.838335255475544*^9}, {3.8383353625940657`*^9, 3.838335381777708*^9}, 
   3.838773716116094*^9, {3.838773984563333*^9, 3.838773991590019*^9}, {
   3.8387744042462254`*^9, 3.838774417640807*^9}},
 CellLabel->"In[25]:=",ExpressionUUID->"20c17d5d-017a-45e0-b2cb-6145e70ebeb6"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"SX22", "===", 
    RowBox[{"1", "+", 
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", "\[Ellipsis]", ")"}], "+", 
         RowBox[{
          RowBox[{"(", "\[Ellipsis]", ")"}], 
          RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], ")"}], "+", 
       RowBox[{
        RowBox[{"(", "\[Ellipsis]", ")"}], "\[Rho]RP", " ", 
        RowBox[{"Cos", "[", "\[Phi]", "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", "\[Ellipsis]", ")"}], "+", 
          RowBox[{
           RowBox[{"(", "\[Ellipsis]", ")"}], 
           RowBox[{"Cos", "[", 
            RowBox[{"2", "\[Phi]"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"(", "\[Ellipsis]", ")"}], 
           RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], ")"}], 
        RowBox[{"\[Rho]RP", "^", "2"}]}]}], 
      RowBox[{
       RowBox[{"(", "\[Ellipsis]", ")"}], "+", 
       RowBox[{
        RowBox[{"(", "\[Ellipsis]", ")"}], "\[Rho]RP", " ", 
        RowBox[{"Cos", "[", "\[Phi]", "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", "\[Ellipsis]", ")"}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Rho]RP", " ", 
           RowBox[{"Cos", "[", "\[Phi]", "]"}]}], ")"}], "^", "2"}]}]}]]}]}], 
   ";", "\[IndentingNewLine]", 
   RowBox[{"T", "===", 
    FractionBox[
     RowBox[{
      RowBox[{"(", "\[Ellipsis]", ")"}], "+", 
      RowBox[{
       RowBox[{"(", "\[Ellipsis]", ")"}], 
       RowBox[{"Cos", "[", 
        RowBox[{"2", "\[Phi]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", "\[Ellipsis]", ")"}], 
       RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], 
     RowBox[{
      RowBox[{"(", "\[Ellipsis]", ")"}], "+", 
      RowBox[{
       RowBox[{"(", "\[Ellipsis]", ")"}], "\[Rho]RP", " ", 
       RowBox[{"Cos", "[", "\[Phi]", "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", "\[Ellipsis]", ")"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"\[Rho]RP", " ", 
          RowBox[{"Cos", "[", "\[Phi]", "]"}]}], ")"}], "^", "2"}]}]}]]}]}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.8382332214940243`*^9, 3.838233386986279*^9}, {
  3.838335607152412*^9, 3.838335653481979*^9}},
 CellLabel->"In[32]:=",ExpressionUUID->"930bcdd5-ab40-4c38-944e-35a1c6d0b402"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "zeros", " ", "of", " ", "denominator", " ", "of", " ", "transfer", " ", 
    "functions"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"slowSol", "=", 
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"denom\[CapitalDelta]SxSimpl", "/.", 
          RowBox[{"\[Chi]", "\[Rule]", 
           RowBox[{"-", "\[Chi]"}]}]}], 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"to", " ", "enter", " ", "anti"}], "-", 
           RowBox[{"squeezed", " ", "quadrature"}]}], "*)"}], ")"}], 
        "\[Equal]", "0"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[CapitalOmega]", ",", "\[Chi]"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{
     RowBox[{"Length", "[", "slowSol", "]"}], ",", 
     "\"\< solutions found\>\""}], "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DumpSave", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
       "\"\<dIS_RP_slowSol.mx\>\""}], ",", "slowSol"}], "]"}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.83877512797287*^9, 3.83877518220481*^9}, {
  3.838776548530382*^9, 3.838776552715516*^9}, {3.838777775097375*^9, 
  3.8387777874781437`*^9}, {3.838778413685191*^9, 3.838778429049507*^9}},
 CellLabel->"In[33]:=",ExpressionUUID->"583a91ae-a40d-4796-a20d-cee0fef41511"],

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"slowSol", "[", 
     RowBox[{"[", "4", "]"}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Rho]RP", "\[Rule]", "0"}], ",", 
      RowBox[{"\[Phi]", "\[Rule]", 
       FractionBox["\[Pi]", "2"]}]}], "}"}]}], ",", 
   RowBox[{"TimeConstraint", "->", 
    RowBox[{"{", 
     RowBox[{"1", ",", "10"}], "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8387788937908087`*^9, 3.8387789198826723`*^9}, {
  3.838778980715296*^9, 3.838779031728897*^9}},
 CellLabel->"In[52]:=",ExpressionUUID->"b14c732f-bda2-4ada-aae6-280e1d5a1e77"],

Cell[BoxData[
 RowBox[{"DumpGet", "[", 
  RowBox[{
   RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
   "\"\<dIS_RP_slowSol.mx\>\""}], "]"}]], "Input",
 CellChangeTimes->{{3.838778344347432*^9, 3.838778378955654*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"7fc8280b-1778-4d20-a76a-42a8937db155"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"minsol", " ", "from", " ", 
     RowBox[{"nIS_threshold", ".", 
      RowBox[{"nb", " ", "--"}]}]}], ">", " ", 
    RowBox[{
    "to", " ", "display", " ", "on", " ", "both", " ", "quadrature", " ", 
     "plot"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "doing", " ", "this", " ", "all", " ", "for", " ", "no", " ", "RP", " ", 
     "and", " ", "fixed", " ", "pump", " ", "phase", " ", "at", " ", 
     RowBox[{"\[Pi]", "/", "2"}], "\[IndentingNewLine]", "to"}], "-", 
    RowBox[{"do", ":", " ", 
     RowBox[{
     "convert", " ", "to", " ", "finding", " ", "general", " ", "RP", " ", 
      "and", " ", "phase", " ", "solutions", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Solve", " ", "is", " ", "hanging"}], ",", " ", 
        RowBox[{
         RowBox[{"that", "'"}], "s", " ", "the", " ", "problem"}]}], 
       ")"}]}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Grad0", "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{
           
           FractionBox["numer\[CapitalDelta]SxSimpl", 
            "denom\[CapitalDelta]SxSimpl"], "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\[Rho]RP", "\[Rule]", "0"}], ",", 
             RowBox[{"\[Phi]", "\[Rule]", 
              FractionBox["\[Pi]", "2"]}]}], "}"}]}], ",", 
          "\[CapitalOmega]"}], "]"}], ",", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{
           
           FractionBox["numer\[CapitalDelta]SxSimpl", 
            "denom\[CapitalDelta]SxSimpl"], "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\[Rho]RP", "\[Rule]", "0"}], ",", 
             RowBox[{"\[Phi]", "\[Rule]", 
              FractionBox["\[Pi]", "2"]}]}], "}"}]}], ",", "\[Chi]"}], 
         "]"}]}], "}"}], "//", "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"GradSx0", "[", 
     RowBox[{"\[CapitalOmega]0_", ",", "\[Chi]0_"}], "]"}], ":=", 
    RowBox[{"Grad0", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[CapitalOmega]", "\[Rule]", "\[CapitalOmega]0"}], ",", 
       RowBox[{"\[Chi]", "\[Rule]", "\[Chi]0"}]}], "}"}]}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"minSol", "=", 
     RowBox[{
      RowBox[{"Solve", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"GradSx0", "[", 
            RowBox[{"\[CapitalOmega]", ",", "\[Chi]"}], "]"}], "\[Equal]", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}]}], ",", 
          RowBox[{"\[CapitalOmega]", "\[GreaterEqual]", "0"}], ",", 
          RowBox[{"\[Chi]", "\[GreaterEqual]", "0"}], ",", 
          RowBox[{"\[Gamma]btot", "\[GreaterEqual]", "\[Gamma]R", ">", "0"}], 
          ",", 
          RowBox[{"\[Omega]s", ">", "0"}], ",", 
          RowBox[{"\[Gamma]a", "\[GreaterEqual]", "0"}], ",", 
          RowBox[{"1", ">", "Rpd", "\[GreaterEqual]", "0"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[CapitalOmega]", ",", "\[Chi]"}], "}"}]}], "]"}], "//", 
      "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<Solve[..., {\[CapitalOmega],\[Chi]}] found \>\"", "<>", 
     RowBox[{"ToString", "[", 
      RowBox[{"Length", "[", "minSol", "]"}], "]"}], "<>", 
     "\"\< solutions\>\""}], "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Chi]SqzMinThresh", "[", 
     RowBox[{"\[Gamma]a0_", ",", "\[Gamma]btot0_", ",", "Rpd0_"}], "]"}], ":=", 
    RowBox[{"Min", "[", 
     RowBox[{"Select", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Chi]", "/.", "minSol"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[Gamma]a", "\[Rule]", "\[Gamma]a0"}], ",", 
          RowBox[{"\[Gamma]btot", "\[Rule]", "\[Gamma]btot0"}], ",", 
          RowBox[{"Rpd", "\[Rule]", "Rpd0"}]}], "}"}]}], ",", 
       RowBox[{
        RowBox[{"Not", "[", 
         RowBox[{"#", "===", "Undefined"}], "]"}], "&"}]}], "]"}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.838170155395851*^9, 3.838170222656069*^9}, {
  3.838170265577467*^9, 3.838170348245565*^9}, {3.838170417169754*^9, 
  3.838170429178014*^9}, {3.838170493768675*^9, 3.8381705271571083`*^9}, {
  3.8381706655151243`*^9, 3.838170699466691*^9}, {3.83817072974557*^9, 
  3.838170732876217*^9}},
 CellLabel->"In[31]:=",ExpressionUUID->"a1110fe6-91ae-4338-b631-716e6843dd56"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"-", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  RowBox[{"(*", 
   RowBox[{"physical", " ", "constants"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"c", "=", 
     RowBox[{"3.", " ", 
      SuperscriptBox["10", "8"]}]}], 
    RowBox[{"(*", 
     SuperscriptBox["ms", 
      RowBox[{"-", "1"}]], "*)"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[HBar]", "=", 
     RowBox[{"1.", " ", 
      SuperscriptBox["10", 
       RowBox[{"-", "34"}]]}]}], 
    RowBox[{"(*", "Js", "*)"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"setDerivedParams1", "[", "]"}], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Tau]RoundTripArm", "=", 
       FractionBox[
        RowBox[{"2", " ", "Larm"}], "c"]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Tau]RoundTripSRC", "=", 
       FractionBox[
        RowBox[{"2", "Lsrc"}], "c"]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]R", "=", 
       RowBox[{
        FractionBox[
         RowBox[{"-", "1"}], 
         RowBox[{"2", " ", "\[Tau]RoundTripSRC"}]], 
        RowBox[{"Log", "[", 
         RowBox[{"1", "-", "Tsrm"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"an", " ", "approximation", " ", "when", " ", "\[Omega]s", 
         RowBox[{"<<", "\[Omega]FSR"}]}], "=", 
        RowBox[{"1", "/", "\[Tau]RoundTripArm"}]}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"\[Omega]s", "=", 
       RowBox[{"c", 
        SuperscriptBox[
         RowBox[{"(", 
          FractionBox["Titm", 
           RowBox[{"4", " ", "Lsrc", " ", "Larm"}]], ")"}], 
         RowBox[{"1", "/", "2"}]]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"switching", " ", "to", " ", "Li", " ", 
        RowBox[{"formula", "!"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"\[Beta]", "=", 
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox[
          RowBox[{"Pcirc", " ", "Larm", " ", "\[Omega]0"}], 
          RowBox[{"\[HBar]", " ", "c"}]], ")"}], 
        RowBox[{"1", "/", "2"}]]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Mu]", "=", 
       FractionBox["M", "4"]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Rho]", "=", 
       FractionBox[
        RowBox[{
         SuperscriptBox["2", 
          RowBox[{"1", "/", "2"}]], "\[HBar]", " ", 
         SuperscriptBox["\[Beta]", "2"]}], 
        RowBox[{
         SuperscriptBox["Larm", "2"], "\[Mu]"}]]}], ";"}], ")"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "different", " ", "interferometer", " ", "parameter", " ", "sets"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Clear", "[", 
    RowBox[{
    "\[Lambda]0", ",", "Larm", ",", "Lsrc", ",", "Pcirc", ",", "Titm", ",", 
     "Tsrm", ",", "M"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"setConfigParamsALIGO", "[", "]"}], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"parameters", " ", "of", " ", "Advanced", " ", "LIGO"}], ",", 
       " ", 
       RowBox[{"from", " ", "Adya", " ", "et", " ", "al"}], ",", " ", 
       RowBox[{
        RowBox[{"2020", " ", "and", " ", 
         RowBox[{"https", ":"}]}], "//", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"dcc", ".", "ligo", ".", "org"}], "/", "public"}], "/", 
             "0000"}], "/", "T0900043"}], "/", "011"}], "/", "LIGO"}], "-", 
         "T0900043", "-", 
         RowBox[{"11.", "pdf"}]}]}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"paramSetName", "=", "\"\<Advanced LIGO\>\""}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Lambda]0", "=", 
       RowBox[{"1064.", " ", 
        SuperscriptBox["10", 
         RowBox[{"-", "9"}]]}]}], 
      RowBox[{"(*", "m", "*)"}], ";", 
      RowBox[{"\[Omega]0", "=", 
       RowBox[{"2", "\[Pi]", " ", 
        RowBox[{"c", "/", "\[Lambda]0"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Larm", "=", 
       RowBox[{"4.", " ", 
        SuperscriptBox["10", "3"]}]}], 
      RowBox[{"(*", "m", "*)"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Lsrc", "=", "56."}], 
      RowBox[{"(*", "m", "*)"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Pcirc", "=", 
       RowBox[{"750.", " ", 
        SuperscriptBox["10", "3"]}]}], " ", 
      RowBox[{"(*", "W", "*)"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Titm", "=", "0.014"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Tsrm", "=", "0.325"}], ";", 
      RowBox[{"(*", 
       RowBox[{"should", " ", "be", " ", 
        RowBox[{"0.2", "?"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"M", "=", "40."}], 
      RowBox[{"(*", "kg", "*)"}], ";", "\[IndentingNewLine]", 
      RowBox[{"setDerivedParams1", "[", "]"}], ";"}], ")"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"setConfigParamsVoyager", "[", "]"}], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"parameters", " ", "of", " ", "LIGO", " ", "Voyager"}], ",", 
       " ", 
       RowBox[{"from", " ", "Adhikari", " ", "et", " ", "al"}], ",", " ", 
       "2020"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"paramSetName", "=", "\"\<LIGO Voyager\>\""}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Lambda]0", "=", 
       RowBox[{"2.", " ", 
        SuperscriptBox["10", 
         RowBox[{"-", "6"}]]}]}], 
      RowBox[{"(*", "m", "*)"}], ";", 
      RowBox[{"\[Omega]0", "=", 
       RowBox[{"2", "\[Pi]", " ", 
        RowBox[{"c", "/", "\[Lambda]0"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Larm", "=", 
       RowBox[{"4.", " ", 
        SuperscriptBox["10", "3"]}]}], 
      RowBox[{"(*", "m", "*)"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Lsrc", "=", "56."}], 
      RowBox[{"(*", "m", "*)"}], ";", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "I", " ", "assume", " ", "that", " ", "the", " ", "upgrade", " ", 
         "is", " ", "not", " ", "changing", " ", "Lsrc"}], ",", " ", 
        RowBox[{
        "which", " ", "is", " ", "not", " ", "made", " ", "obvious", " ", 
         "anywhere"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Pcirc", "=", 
       RowBox[{"3.", " ", 
        SuperscriptBox["10", "6"]}]}], " ", 
      RowBox[{"(*", "W", "*)"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Titm", "=", "0.002"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Tsrm", "=", "0.046"}], ";", "\[IndentingNewLine]", 
      RowBox[{"M", "=", "200."}], 
      RowBox[{"(*", "kg", "*)"}], ";", "\[IndentingNewLine]", 
      RowBox[{"setDerivedParams1", "[", "]"}], ";"}], ")"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"setConfigParamsNEMO", "[", "]"}], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"parameters", " ", "of", " ", "NEMO"}], ",", " ", 
       RowBox[{"from", " ", "Ackley", " ", "et", " ", "al"}], ",", " ", 
       "2020"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"paramSetName", "=", "\"\<NEMO\>\""}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Lambda]0", "=", 
       RowBox[{"2.", " ", 
        SuperscriptBox["10", 
         RowBox[{"-", "6"}]]}]}], 
      RowBox[{"(*", "m", "*)"}], ";", 
      RowBox[{"\[Omega]0", "=", 
       RowBox[{"2", "\[Pi]", " ", 
        RowBox[{"c", "/", "\[Lambda]0"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Larm", "=", 
       RowBox[{"4.", " ", 
        SuperscriptBox["10", "3"]}]}], 
      RowBox[{"(*", "m", "*)"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Lsrc", "=", "354."}], 
      RowBox[{"(*", "m", "*)"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Pcirc", "=", " ", 
       RowBox[{"4.5", " ", 
        SuperscriptBox["10", "6"]}]}], 
      RowBox[{"(*", "W", "*)"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Titm", "=", "0.014"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Tsrm", "=", "0.048"}], ";", "\[IndentingNewLine]", 
      RowBox[{"M", "=", "74.1"}], 
      RowBox[{"(*", "kg", "*)"}], ";", "\[IndentingNewLine]", 
      RowBox[{"setDerivedParams1", "[", "]"}], ";"}], ")"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"setConfigParamsKorobko2019", "[", "]"}], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "parameters", " ", "from", " ", "Korobko", " ", "et", " ", "al"}], ",",
        " ", 
       RowBox[{
       "2019", ":", " ", "\"\<benchmark 3rd generation detector\>\""}]}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"paramSetName", "=", "\"\<Korobko et al, 2019\>\""}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Lambda]0", "=", 
       RowBox[{"1550.", " ", 
        SuperscriptBox["10", 
         RowBox[{"-", "9"}]]}]}], 
      RowBox[{"(*", "m", "*)"}], ";", 
      RowBox[{"\[Omega]0", "=", 
       RowBox[{"2", "\[Pi]", " ", 
        RowBox[{"c", "/", "\[Lambda]0"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Larm", "=", 
       RowBox[{"20.", " ", 
        SuperscriptBox["10", "3"]}]}], 
      RowBox[{"(*", "m", "*)"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Lsrc", "=", "56."}], 
      RowBox[{"(*", "m", "*)"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Pcirc", "=", " ", 
       RowBox[{"4.", " ", 
        SuperscriptBox["10", "6"]}]}], 
      RowBox[{"(*", "W", "*)"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Titm", "=", "0.07"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Tsrm", "=", "0.35"}], ";", "\[IndentingNewLine]", 
      RowBox[{"M", "=", "200."}], 
      RowBox[{"(*", "kg", "*)"}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"setDerivedParams1", "[", "]"}], ";"}], ")"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"setConfigParamsLi2020", "[", "]"}], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"parameters", " ", "from", " ", "Li", " ", "et", " ", "al"}], 
       ",", " ", 
       RowBox[{"2020", " ", "-", " ", 
        RowBox[{"NB", ":", 
         RowBox[{
         "\[Omega]s", " ", "and", " ", "\[Gamma]R", " ", "are", " ", "not", 
          " ", "from", " ", "LIGO", " ", 
          RowBox[{"Voyager", "!"}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"paramSetName", "=", "\"\<Li et al, 2020\>\""}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Larm", "=", 
       RowBox[{"4.", " ", 
        SuperscriptBox["10", "3"]}]}], 
      RowBox[{"(*", "m", "*)"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Pcirc", "=", 
       RowBox[{"3.", " ", 
        SuperscriptBox["10", "6"]}]}], 
      RowBox[{"(*", 
       RowBox[{"J", "/", "s"}], "*)"}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Lambda]0", "=", 
       RowBox[{"2.", " ", 
        SuperscriptBox["10", 
         RowBox[{"-", "6"}]]}]}], 
      RowBox[{"(*", "m", "*)"}], ";", 
      RowBox[{"\[Omega]0", "=", 
       RowBox[{"2", "\[Pi]", " ", 
        FractionBox["c", "\[Lambda]0"]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]R", "=", 
       RowBox[{"2", "\[Pi]", " ", "500."}]}], 
      RowBox[{"(*", "Hz", "*)"}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Omega]s", "=", 
       RowBox[{"10", "\[Gamma]R"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Tau]RoundTripArm", "=", 
       FractionBox[
        RowBox[{"2", " ", "Larm"}], "c"]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Tsrm", "=", "0.046"}], ";", " ", 
      RowBox[{"(*", 
       RowBox[{"assuming", " ", "LIGO", " ", 
        RowBox[{"Voyager", "'"}], "s", " ", 
        SubscriptBox["T", "SRM"], " ", "was", " ", "used", " ", "for", " ", 
        "\[Gamma]R"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"\[Tau]RoundTripSRC", "=", 
       RowBox[{
        FractionBox[
         RowBox[{"-", "1"}], 
         RowBox[{"2", " ", "\[Gamma]R"}]], 
        RowBox[{"Log", "[", 
         RowBox[{"1", "-", "Tsrm"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"M", "=", "200."}], 
      RowBox[{"(*", "kg", "*)"}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Beta]", "=", 
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox[
          RowBox[{"Pcirc", " ", "Larm", " ", "\[Omega]0"}], 
          RowBox[{"\[HBar]", " ", "c"}]], ")"}], 
        RowBox[{"1", "/", "2"}]]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Mu]", "=", 
       FractionBox["M", "4"]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Rho]", "=", 
       FractionBox[
        RowBox[{
         SuperscriptBox["2", 
          RowBox[{"1", "/", "2"}]], "\[HBar]", " ", 
         SuperscriptBox["\[Beta]", "2"]}], 
        RowBox[{
         SuperscriptBox["Larm", "2"], "\[Mu]"}]]}], ";"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"\"\<inferred Lsrc (in m) = \>\"", ",", 
         RowBox[{"c", " ", 
          RowBox[{"\[Tau]RoundTripSRC", "/", "2"}]}], ",", "\"\<\\n\>\""}], 
        "]"}], ";"}], "*)"}], ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"setConfigParamsCustom", "[", 
     RowBox[{
     "\[Lambda]00_", ",", "Larm0_", ",", "Lsrc0_", ",", "Pcirc0_", ",", 
      "Titm0_", ",", "Tsrm0_", ",", "M0_", ",", 
      RowBox[{"paramSetName0_:", "None"}], ",", 
      RowBox[{"\[Gamma]bR0_:", "None"}], ",", 
      RowBox[{"\[Omega]s0_:", "None"}]}], "]"}], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Clear", "[", 
       RowBox[{
       "paramSetName", ",", "\[Lambda]0", ",", "Larm", ",", "Lsrc", ",", 
        "Pcirc", ",", "Titm", ",", "Tsrm", ",", "M", ",", 
        "\[Tau]RoundTripArm", ",", "\[Tau]RoundTripSRC", ",", "\[Gamma]bR", 
        ",", "\[Omega]s", ",", "\[Beta]", ",", "\[Mu]", ",", "\[Rho]"}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"manually", " ", "set", " ", "parameters"}], ",", " ", 
        RowBox[{"all", " ", "in", " ", "base", " ", "SI", " ", "units"}]}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"paramSetName", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"paramSetName0", "===", "None"}], ",", 
         "\"\<Custom parameter set\>\"", ",", "paramSetName0"}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"\[Lambda]0", "=", "\[Lambda]00"}], 
      RowBox[{"(*", "m", "*)"}], ";", 
      RowBox[{"\[Omega]0", "=", 
       RowBox[{"2", "\[Pi]", " ", 
        RowBox[{"c", "/", "\[Lambda]0"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Larm", "=", "Larm0"}], 
      RowBox[{"(*", "m", "*)"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "can", " ", "be", " ", "omitted", " ", "if", " ", "\[Gamma]bR", " ", 
        "and", " ", "Tsrm", " ", "are", " ", "specified"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Lsrc", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"Lsrc0", "===", "None"}], ",", "Lsrc", " ", ",", "Lsrc0"}], 
        RowBox[{"(*", "m", "*)"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Pcirc", "=", "Pcirc0"}], 
      RowBox[{"(*", "W", "*)"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "can", " ", "be", " ", "omitted", " ", "if", " ", "\[Omega]s", " ", 
        "is", " ", "specified"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Titm", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"Titm0", "===", "None"}], ",", "Titm", ",", "Titm0"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Tsrm", "=", "Tsrm0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"M", "=", "M0"}], 
      RowBox[{"(*", "kg", "*)"}], ";", "\[IndentingNewLine]", 
      RowBox[{"setDerivedParams1", "[", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"if", " ", "specified"}], ",", " ", 
        RowBox[{
        "then", " ", "override", " ", "\[Gamma]bR", " ", "and", " ", 
         "\[Omega]s"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Not", "[", 
         RowBox[{"\[Gamma]bR0", "===", "None"}], "]"}], ",", 
        RowBox[{"\[Gamma]bR", "=", "\[Gamma]bR0"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Not", "[", 
         RowBox[{"\[Omega]s0", "===", "None"}], "]"}], ",", 
        RowBox[{"\[Omega]s", "=", "\[Omega]s0"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"if", " ", "unspecified"}], ",", " ", 
        RowBox[{
        "then", " ", "use", " ", "\[Gamma]bR", " ", "or", " ", "\[Gamma]cR", 
         " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"if", " ", "\[Gamma]bR"}], "\[Equal]", "0"}], ")"}], " ", 
         "and", " ", "Tsrm", " ", "to", " ", "find", " ", 
         "\[Tau]RoundTripSRC"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Lsrc0", "===", "None"}], ",", 
        RowBox[{
         RowBox[{"\[Tau]RoundTripSRC", "=", 
          RowBox[{
           FractionBox[
            RowBox[{"-", "1"}], 
            RowBox[{"2", " ", "\[Gamma]bR"}]], 
           RowBox[{"Log", "[", 
            RowBox[{"1", "-", "Tsrm"}], "]"}]}]}], "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{"\"\<inferred Lsrc (in m) = \>\"", ",", 
             RowBox[{"c", " ", 
              RowBox[{"\[Tau]RoundTripSRC", "/", "2"}]}], ",", 
             "\"\<\\n\>\""}], "]"}], ";"}], "*)"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"hot", "-", 
           RowBox[{"fix", " ", "Lsrc", " ", "using", " ", "above"}]}], "*)"}],
          "\[IndentingNewLine]", 
         RowBox[{"Lsrc", "=", 
          RowBox[{"c", " ", 
           RowBox[{"\[Tau]RoundTripSRC", "/", "2"}]}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{
         "changing", " ", "now", " ", "to", " ", "use", " ", "Li", " ", 
          "formula", " ", "for", " ", "comparison", " ", "to", " ", 
          "sWLC"}]}], ",", " ", 
        RowBox[{"why", " ", "do", " ", "these", " ", "two", " ", 
         RowBox[{"disagree", "?", " ", "I"}], " ", "do", " ", "not", " ", 
         RowBox[{"know", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"\[Beta]", "=", 
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox[
          RowBox[{"Pcirc", " ", "Larm", " ", "\[Omega]0"}], 
          RowBox[{"\[HBar]", " ", "c"}]], ")"}], 
        RowBox[{"1", "/", "2"}]]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Mu]", "=", 
       FractionBox["M", "4"]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Rho]", "=", 
       RowBox[{
        FractionBox["1", 
         RowBox[{
          SuperscriptBox["2", 
           RowBox[{"1", "/", "2"}]], "\[HBar]", " ", "\[Mu]"}]], 
        FractionBox[
         RowBox[{"2", 
          SuperscriptBox["\[HBar]", "2"]}], 
         SuperscriptBox["Larm", "2"]], 
        SuperscriptBox["\[Beta]", "2"]}]}], 
      RowBox[{"(*", 
       RowBox[{"=", 
        FractionBox[
         RowBox[{
          SuperscriptBox["2", 
           RowBox[{"1", "/", "2"}]], "\[HBar]", " ", 
          SuperscriptBox["\[Beta]", "2"]}], 
         RowBox[{
          SuperscriptBox["Larm", "2"], "\[Mu]"}]]}], "*)"}], ";"}], ")"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"printParams", "[", "]"}], ":=", 
    RowBox[{"Print", "[", 
     RowBox[{"StringForm", "[", "\[IndentingNewLine]", 
      RowBox[{
      "\"\<configuration parameters:\\nparamSetName=``, \[Lambda]0=``, \
Larm=``, Lsrc=``, Pcirc=``, Titm=``, Tsrm=``, M=``\\nderived parameters:\\n\
\[Tau]RoundTripArm=``, \[Tau]RoundTripSRC=``, \[Gamma]R=``, \[Omega]s=``\>\"",
        ",", "paramSetName", ",", 
       RowBox[{"NumberForm", "[", "\[Lambda]0", "]"}], ",", 
       RowBox[{"NumberForm", "[", "Larm", "]"}], ",", 
       RowBox[{"NumberForm", "[", "Lsrc", "]"}], ",", 
       RowBox[{"NumberForm", "[", "Pcirc", "]"}], ",", 
       RowBox[{"NumberForm", "[", "Titm", "]"}], ",", 
       RowBox[{"NumberForm", "[", "Tsrm", "]"}], ",", 
       RowBox[{"NumberForm", "[", "M", "]"}], ",", 
       RowBox[{"NumberForm", "[", "\[Tau]RoundTripArm", "]"}], ",", 
       RowBox[{"NumberForm", "[", "\[Tau]RoundTripSRC", "]"}], ",", 
       RowBox[{"NumberForm", "[", "\[Gamma]R", "]"}], ",", 
       RowBox[{"NumberForm", "[", "\[Omega]s", "]"}]}], "]"}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.839275266341442*^9, 3.839275268196659*^9}, {
   3.8392768812484083`*^9, 3.839276883609186*^9}, 3.84298025303121*^9, {
   3.842980482154316*^9, 3.842980499548571*^9}, {3.842980543185542*^9, 
   3.84298056341811*^9}, {3.84298120920592*^9, 3.842981241930298*^9}, {
   3.842981634558234*^9, 3.842981671781168*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"94b11244-9d7b-4b12-851c-5b6b0612a1b4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"\"\<realistic\>\"", " ", "losses"}], ",", " ", 
    RowBox[{
    "using", " ", "those", " ", "from", " ", "Zhang", " ", "et", " ", "al"}], 
    ",", " ", 
    RowBox[{
    "2021", " ", "which", " ", "seem", " ", "to", " ", "be", " ", "pretty", 
     " ", "representative"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Tla0", "=", 
     RowBox[{"100.", " ", 
      SuperscriptBox["10", 
       RowBox[{"-", "6"}]]}]}], 
    RowBox[{"(*", 
     RowBox[{"=", 
      RowBox[{"100", "ppm"}]}], "*)"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Tlb0", "=", 
     RowBox[{"1000.", " ", 
      SuperscriptBox["10", 
       RowBox[{"-", "6"}]]}]}], 
    RowBox[{"(*", 
     RowBox[{"=", 
      RowBox[{"1000", "ppm"}]}], "*)"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Rpd0", "=", "0.1"}], 
    RowBox[{"(*", 
     RowBox[{"=", 
      RowBox[{"10", "%"}]}], "*)"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Gamma]aFn", "[", "Tla_", "]"}], ":=", 
    RowBox[{
     FractionBox[
      RowBox[{"-", "1"}], 
      RowBox[{"2", " ", "\[Tau]RoundTripArm"}]], 
     RowBox[{"Log", "[", 
      RowBox[{"1", "-", "Tla"}], "]"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Gamma]btotFn", "[", "Tlb_", "]"}], ":=", 
    RowBox[{"\[Gamma]R", "+", 
     RowBox[{
      FractionBox[
       RowBox[{"-", "1"}], 
       RowBox[{"2", " ", "\[Tau]RoundTripSRC"}]], 
      RowBox[{"Log", "[", 
       RowBox[{"1", "-", "Tlb"}], "]"}]}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"singularityThr", "[", 
     RowBox[{"Tla_", ",", "Tlb_"}], "]"}], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"poleSol0", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\[CapitalOmega]", "\[Rule]", "0"}], ",", 
           RowBox[{"\[Chi]", "\[Rule]", 
            RowBox[{"\[Gamma]btot", "+", 
             FractionBox[
              SuperscriptBox["\[Omega]s", "2"], "\[Gamma]a"]}]}]}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\[CapitalOmega]", "\[Rule]", 
            RowBox[{"Sqrt", "[", 
             RowBox[{
              SuperscriptBox["\[Omega]s", "2"], "-", 
              SuperscriptBox["\[Gamma]a", "2"]}], "]"}]}], ",", 
           RowBox[{"\[Chi]", "\[Rule]", 
            RowBox[{"\[Gamma]btot", "+", "\[Gamma]a"}]}]}], "}"}]}], "}"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Tla", "\[NotEqual]", "0"}], ",", 
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{"\[Chi]", "/.", "poleSol0"}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[Gamma]a", "\[Rule]", 
             RowBox[{"\[Gamma]aFn", "[", "Tla", "]"}]}], ",", 
            RowBox[{"\[Gamma]btot", "\[Rule]", 
             RowBox[{"\[Gamma]btotFn", "[", "Tlb", "]"}]}]}], "}"}]}], "]"}], 
        ",", 
        RowBox[{
         RowBox[{"\[Chi]", "/.", 
          RowBox[{"poleSol0", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\[Gamma]a", "\[Rule]", 
            RowBox[{"\[Gamma]aFn", "[", "Tla", "]"}]}], ",", 
           RowBox[{"\[Gamma]btot", "\[Rule]", 
            RowBox[{"\[Gamma]btotFn", "[", "Tlb", "]"}]}]}], "}"}]}]}], 
       "]"}]}], ")"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"plotting", " ", 
      RowBox[{"sensitivity", " ", "--"}], " ", "un"}], "-", 
     RowBox[{"simplified", " ", "Sh"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "taking", " ", "real", " ", "part", " ", "to", " ", "discard", " ", 
     "numerical", " ", "error", " ", "in", " ", "tiny", " ", "imaginary", " ",
      "parts"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"QNwRP", "[", 
     RowBox[{
     "\[CapitalOmega]0_", ",", "\[Chi]0_", ",", "\[Phi]0_", ",", "Tla_", ",", 
      "Tlb_", ",", "Rpd0_", ",", 
      RowBox[{"\[Rho]RPTrue_:", "True"}]}], "]"}], ":=", 
    RowBox[{
     RowBox[{"Re", "[", 
      RowBox[{"Sqrt", "[", 
       RowBox[{"Sx", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "2"}], "]"}], "]"}], "]"}], "]"}], "/.", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[CapitalOmega]", "\[Rule]", "\[CapitalOmega]0"}], ",", 
       RowBox[{"\[Chi]", "\[Rule]", "\[Chi]0"}], ",", 
       RowBox[{"\[Phi]", "\[Rule]", "\[Phi]0"}], ",", 
       RowBox[{"\[Gamma]a", "\[Rule]", 
        RowBox[{"\[Gamma]aFn", "[", "Tla", "]"}]}], ",", 
       RowBox[{"\[Gamma]btot", "\[Rule]", 
        RowBox[{"\[Gamma]btotFn", "[", "Tlb", "]"}]}], ",", 
       RowBox[{"Rpd", "\[Rule]", "Rpd0"}], ",", 
       RowBox[{"\[Rho]RP", "\[Rule]", 
        RowBox[{"If", "[", 
         RowBox[{"\[Rho]RPTrue", ",", "\[Rho]", ",", "0"}], "]"}]}]}], 
      "}"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sigwRP", "[", 
     RowBox[{
     "\[CapitalOmega]0_", ",", "\[Chi]0_", ",", "\[Phi]0_", ",", "Tla_", ",", 
      "Tlb_", ",", "Rpd0_", ",", 
      RowBox[{"\[Rho]RPTrue_:", "True"}]}], "]"}], ":=", 
    RowBox[{
     RowBox[{"Re", "[", "sigTransferAbs", "]"}], "/.", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[CapitalOmega]", "\[Rule]", "\[CapitalOmega]0"}], ",", 
       RowBox[{"\[Chi]", "\[Rule]", "\[Chi]0"}], ",", 
       RowBox[{"\[Phi]", "\[Rule]", "\[Phi]0"}], ",", 
       RowBox[{"\[Gamma]a", "\[Rule]", 
        RowBox[{"\[Gamma]aFn", "[", "Tla", "]"}]}], ",", 
       RowBox[{"\[Gamma]btot", "\[Rule]", 
        RowBox[{"\[Gamma]btotFn", "[", "Tlb", "]"}]}], ",", 
       RowBox[{"Rpd", "\[Rule]", "Rpd0"}], ",", 
       RowBox[{"\[Rho]RP", "\[Rule]", 
        RowBox[{"If", "[", 
         RowBox[{"\[Rho]RPTrue", ",", "\[Rho]", ",", "0"}], "]"}]}]}], 
      "}"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ASDShwRP", "[", 
     RowBox[{
     "\[CapitalOmega]0_", ",", "\[Chi]0_", ",", "\[Phi]0_", ",", "Tla_", ",", 
      "Tlb_", ",", "Rpd0_", ",", 
      RowBox[{"\[Rho]RPTrue_:", "True"}]}], "]"}], ":=", 
    RowBox[{
     RowBox[{"Re", "[", 
      RowBox[{"Sqrt", "[", "Sh", "]"}], "]"}], "/.", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[CapitalOmega]", "\[Rule]", "\[CapitalOmega]0"}], ",", 
       RowBox[{"\[Chi]", "\[Rule]", "\[Chi]0"}], ",", 
       RowBox[{"\[Phi]", "\[Rule]", "\[Phi]0"}], ",", 
       RowBox[{"\[Gamma]a", "\[Rule]", 
        RowBox[{"\[Gamma]aFn", "[", "Tla", "]"}]}], ",", 
       RowBox[{"\[Gamma]btot", "\[Rule]", 
        RowBox[{"\[Gamma]btotFn", "[", "Tlb", "]"}]}], ",", 
       RowBox[{"Rpd", "\[Rule]", "Rpd0"}], ",", 
       RowBox[{"\[Rho]RP", "\[Rule]", 
        RowBox[{"If", "[", 
         RowBox[{"\[Rho]RPTrue", ",", "\[Rho]", ",", "0"}], "]"}]}]}], 
      "}"}]}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"legendStyler", "[", "vals0_", "]"}], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "vals0", "]"}], "\[Equal]", "5"}], ",", 
        RowBox[{"vals", "=", 
         RowBox[{"Join", "[", 
          RowBox[{"vals0", ",", 
           RowBox[{"{", "True", "}"}]}], "]"}]}], ",", 
        RowBox[{"vals", "=", "vals0"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"paddedStrings", "=", 
       RowBox[{"Insert", "[", 
        RowBox[{
         RowBox[{"StringPadRight", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"ToString", "[", 
              RowBox[{"N", "[", 
               RowBox[{
                RowBox[{"vals", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "/", 
                RowBox[{"singularityThr", "[", 
                 RowBox[{
                  RowBox[{"vals", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], ",", 
                  RowBox[{"vals", "[", 
                   RowBox[{"[", "4", "]"}], "]"}]}], "]"}]}], "]"}], "]"}], 
             ",", 
             RowBox[{"ToString", "[", 
              RowBox[{"vals", "[", 
               RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", 
             RowBox[{"ToString", "[", 
              RowBox[{"vals", "[", 
               RowBox[{"[", "4", "]"}], "]"}], "]"}], ",", 
             RowBox[{"ToString", "[", 
              RowBox[{"vals", "[", 
               RowBox[{"[", "5", "]"}], "]"}], "]"}]}], "}"}], ",", "4"}], 
          "]"}], ",", 
         RowBox[{"StringPadRight", "[", 
          RowBox[{
           RowBox[{"ToString", "[", 
            RowBox[{"N", "[", 
             RowBox[{
              RowBox[{"vals", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "/", 
              RowBox[{"(", 
               RowBox[{"2", "\[Pi]"}], ")"}]}], "]"}], "]"}], ",", "5"}], 
          "]"}], ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"<>", " ", "is"}], " ", "StringJoin"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Style", "[", 
       RowBox[{
        RowBox[{"StringForm", "[", 
         RowBox[{
          RowBox[{
          "\"\<\[Chi]/\!\(\*SubscriptBox[\(\[Chi]\), \(thr\)]\)=``, \>\"", "<>", 
           RowBox[{"ToString", "[", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"vals", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "-", 
                  FractionBox["\[Pi]", "2"]}], ",", "\[Pi]"}], "]"}], 
               "\[Equal]", "0"}], ",", 
              RowBox[{"StringPadRight", "[", 
               RowBox[{
                RowBox[{"ToString", "[", 
                 RowBox[{"StringForm", "[", 
                  RowBox[{"\"\<\[Phi]=``\[Pi]/2\>\"", ",", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"vals", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    FractionBox["\[Pi]", "2"]}], ",", 
                    RowBox[{"2", "\[Pi]"}]}], "]"}], "\[Equal]", "0"}], ",", 
                    "\"\<+\>\"", ",", "\"\<-\>\""}], "]"}]}], "]"}], "]"}], 
                ",", "12"}], "]"}], ",", 
              RowBox[{"StringForm", "[", 
               RowBox[{
               "\"\<\[Phi]/(2\[Pi])=``\>\"", ",", "\[IndentingNewLine]", 
                RowBox[{"paddedStrings", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}], "]"}], 
           "<>", "\"\<; \!\(\*SubscriptBox[\(T\), \(l, a\)]\)=``, \
\!\(\*SubscriptBox[\(T\), \(l, b\)]\)=``, \!\(\*SubscriptBox[\(R\), \
\(PD\)]\)=``\>\"", "\[IndentingNewLine]", "<>", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"Not", "[", 
              RowBox[{"vals", "[", 
               RowBox[{"[", "6", "]"}], "]"}], "]"}], ",", "\"\<; no RP\>\"", 
             ",", "\"\<\>\""}], "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"paddedStrings", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"paddedStrings", "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"paddedStrings", "[", 
           RowBox[{"[", "4", "]"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"paddedStrings", "[", 
           RowBox[{"[", "5", "]"}], "]"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"FontFamily", "\[Rule]", "\"\<Monospace\>\""}]}], "]"}]}], 
     ")"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"legendStylerNoPhase", "[", "vals0_", "]"}], ":=", 
    RowBox[{"Style", "[", 
     RowBox[{
      RowBox[{"StringForm", "[", 
       RowBox[{
       "\"\<\[Chi]/\!\(\*SubscriptBox[\(\[Chi]\), \(thr\)]\)=``, \
\!\(\*SubscriptBox[\(T\), \(l, a\)]\)=``ppm,\\n\!\(\*SubscriptBox[\(T\), \(l, \
b\)]\)=``ppm, \!\(\*SubscriptBox[\(R\), \(PD\)]\)=``, \[Rho]``\>\"", ",", 
        RowBox[{"StringPadRight", "[", 
         RowBox[{
          RowBox[{"ToString", "[", 
           RowBox[{"NumberForm", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"vals0", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "//", "ReleaseHold"}], ")"}],
               "/", 
              RowBox[{"singularityThr", "[", 
               RowBox[{
                RowBox[{"vals0", "[", 
                 RowBox[{"[", "3", "]"}], "]"}], ",", 
                RowBox[{"vals0", "[", 
                 RowBox[{"[", "4", "]"}], "]"}]}], "]"}]}], ",", "2"}], "]"}],
            "]"}], ",", "4"}], "]"}], ",", 
        RowBox[{"NumberForm", "[", 
         RowBox[{"N", "[", 
          RowBox[{
           RowBox[{"vals0", "[", 
            RowBox[{"[", "3", "]"}], "]"}], " ", 
           SuperscriptBox["10", "6"]}], "]"}], "]"}], ",", 
        RowBox[{"NumberForm", "[", 
         RowBox[{"N", "[", 
          RowBox[{
           RowBox[{"vals0", "[", 
            RowBox[{"[", "4", "]"}], "]"}], " ", 
           SuperscriptBox["10", "6"]}], "]"}], "]"}], ",", 
        RowBox[{"NumberForm", "[", 
         RowBox[{"N", "[", 
          RowBox[{"vals0", "[", 
           RowBox[{"[", "5", "]"}], "]"}], "]"}], "]"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "vals0", "]"}], "\[Equal]", "5"}], ",", 
          "\"\<\[NotEqual]0\>\"", ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"Not", "[", 
             RowBox[{"vals0", "[", 
              RowBox[{"[", "6", "]"}], "]"}], "]"}], ",", "\"\<=0\>\"", ",", 
            "\"\<\[NotEqual]0\>\""}], "]"}]}], "]"}]}], "]"}], ",", 
      RowBox[{"FontFamily", "\[Rule]", "\"\<Monospace\>\""}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"legendStylerNoPhaseNoSplit", "[", "vals0_", "]"}], ":=", 
    RowBox[{"Style", "[", 
     RowBox[{
      RowBox[{"StringForm", "[", 
       RowBox[{
       "\"\<\[Chi]/\!\(\*SubscriptBox[\(\[Chi]\), \(thr\)]\)=``, \
\!\(\*SubscriptBox[\(T\), \(l, a\)]\)=``ppm, \!\(\*SubscriptBox[\(T\), \(l, b\
\)]\)=``ppm, \!\(\*SubscriptBox[\(R\), \(PD\)]\)=``, \[Rho]``\>\"", ",", 
        RowBox[{"StringPadRight", "[", 
         RowBox[{
          RowBox[{"ToString", "[", 
           RowBox[{"NumberForm", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"vals0", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "//", "ReleaseHold"}], ")"}],
               "/", 
              RowBox[{"singularityThr", "[", 
               RowBox[{
                RowBox[{"vals0", "[", 
                 RowBox[{"[", "3", "]"}], "]"}], ",", 
                RowBox[{"vals0", "[", 
                 RowBox[{"[", "4", "]"}], "]"}]}], "]"}]}], ",", "2"}], "]"}],
            "]"}], ",", "4"}], "]"}], ",", 
        RowBox[{"NumberForm", "[", 
         RowBox[{"N", "[", 
          RowBox[{
           RowBox[{"vals0", "[", 
            RowBox[{"[", "3", "]"}], "]"}], " ", 
           SuperscriptBox["10", "6"]}], "]"}], "]"}], ",", 
        RowBox[{"NumberForm", "[", 
         RowBox[{"N", "[", 
          RowBox[{
           RowBox[{"vals0", "[", 
            RowBox[{"[", "4", "]"}], "]"}], " ", 
           SuperscriptBox["10", "6"]}], "]"}], "]"}], ",", 
        RowBox[{"NumberForm", "[", 
         RowBox[{"N", "[", 
          RowBox[{"vals0", "[", 
           RowBox[{"[", "5", "]"}], "]"}], "]"}], "]"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "vals0", "]"}], "\[Equal]", "5"}], ",", 
          "\"\<\[NotEqual]0\>\"", ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"Not", "[", 
             RowBox[{"vals0", "[", 
              RowBox[{"[", "6", "]"}], "]"}], "]"}], ",", "\"\<=0\>\"", ",", 
            "\"\<\[NotEqual]0\>\""}], "]"}]}], "]"}]}], "]"}], ",", 
      RowBox[{"FontFamily", "\[Rule]", "\"\<Monospace\>\""}]}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"plotwRP", "[", 
     RowBox[{"valsList_", ",", 
      RowBox[{"plotLabel_:", "None"}], ",", 
      RowBox[{"plotStyle_:", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"fmin_:", "1"}], 
      RowBox[{"(*", "Hz", "*)"}], ",", 
      RowBox[{"fmax_:", 
       SuperscriptBox["10", "5"]}]}], 
     RowBox[{"(*", "Hz", "*)"}], "]"}], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"p1", "=", 
       RowBox[{"LogLinearPlot", "[", 
        RowBox[{
         RowBox[{"Evaluate", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"20", 
             RowBox[{"Log10", "[", 
              RowBox[{"QNwRP", "@@", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"2", "\[Pi]", " ", "f"}], "}"}], ",", 
                 RowBox[{"valsList", "[", 
                  RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Length", "[", "valsList", "]"}]}], "}"}]}], "]"}], 
          "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"f", ",", "fmin", ",", "fmax"}], "}"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "350"}], ",", 
         RowBox[{"PlotLegends", "\[Rule]", 
          RowBox[{"LineLegend", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"legendStyler", "[", 
               RowBox[{"valsList", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", 
                RowBox[{"Length", "[", "valsList", "]"}]}], "}"}]}], "]"}], 
            ",", 
            RowBox[{"LabelStyle", "\[Rule]", 
             RowBox[{"Directive", "[", "10", "]"}]}], ",", 
            RowBox[{"LegendMarkerSize", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"{", 
               RowBox[{"25", ",", "15"}], "}"}], "}"}]}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ImagePadding", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"100", ",", "10"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "All"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"TicksStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"FontOpacity", "\[Rule]", "0"}], ",", 
              RowBox[{"FontSize", "\[Rule]", "0"}]}], "]"}], ","}], "}"}]}], 
         ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"fmin", ",", "fmax"}], "}"}], ",", "All"}], "}"}]}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", "plotStyle"}], ",", 
         RowBox[{"Frame", "->", "True"}], ",", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "\"\<quantum noise transfer function,\\n|R| / dB (20log10)\>\"", 
              ","}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"ToString", "[", "plotLabel", "]"}], "\[Equal]", 
                 RowBox[{"ToString", "[", "None", "]"}]}], ",", 
                RowBox[{
                "\"\<degenerate internal squeezing\\nparameters of \>\"", "<>",
                  "paramSetName"}], ",", "plotLabel"}], "]"}]}], "}"}]}], 
           "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"PerformanceGoal", "\[Rule]", "\"\<Speed\>\""}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"p2", "=", 
       RowBox[{"LogLogPlot", "[", 
        RowBox[{
         RowBox[{"Evaluate", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"sigwRP", "@@", 
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"2", "\[Pi]", " ", "f"}], "}"}], ",", 
               RowBox[{"valsList", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Length", "[", "valsList", "]"}]}], "}"}]}], "]"}], 
          "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"f", ",", "fmin", ",", "fmax"}], "}"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "350"}], ",", 
         RowBox[{"PlotLegends", "\[Rule]", 
          RowBox[{"LineLegend", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"legendStyler", "[", 
               RowBox[{"valsList", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", 
                RowBox[{"Length", "[", "valsList", "]"}]}], "}"}]}], "]"}], 
            ",", 
            RowBox[{"LabelStyle", "\[Rule]", 
             RowBox[{"Directive", "[", "10", "]"}]}], ",", 
            RowBox[{"LegendMarkerSize", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"{", 
               RowBox[{"25", ",", "15"}], "}"}], "}"}]}]}], "]"}]}], ",", 
         RowBox[{"ImagePadding", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"100", ",", "10"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "1"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"TicksStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"FontOpacity", "\[Rule]", "0"}], ",", 
              RowBox[{"FontSize", "\[Rule]", "0"}]}], "]"}], ","}], "}"}]}], 
         ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"fmin", ",", "fmax"}], "}"}], ",", "All"}], "}"}]}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", "plotStyle"}], ",", 
         RowBox[{"Frame", "->", "True"}], ",", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "\"\<signal transfer function,\\n|T| / [?] (log scale)\>\"", 
              ","}], "}"}], ",", 
            RowBox[{"{", ",", "}"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"PerformanceGoal", "\[Rule]", "\"\<Speed\>\""}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"p3", "=", 
       RowBox[{"LogLogPlot", "[", 
        RowBox[{
         RowBox[{"Evaluate", "[", 
          RowBox[{"Join", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"ASDShwRP", "@@", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"2", "\[Pi]", " ", "f"}], "}"}], ",", 
                 RowBox[{"valsList", "[", 
                  RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", 
                RowBox[{"Length", "[", "valsList", "]"}]}], "}"}]}], "]"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  SuperscriptBox["10", "3"], "<", "#", "<", 
                  RowBox[{"4", " ", 
                   SuperscriptBox["10", "3"]}]}], ",", 
                 RowBox[{"5", " ", 
                  SuperscriptBox["10", 
                   RowBox[{"-", "25"}]]}], ",", "Null"}], "]"}], "&"}], "[", 
              "f", "]"}], "}"}]}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"f", ",", "fmin", ",", "fmax"}], "}"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "350"}], ",", 
         RowBox[{"ImagePadding", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"100", ",", "10"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"50", ",", "1"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"PlotLegends", "\[Rule]", 
          RowBox[{"LineLegend", "[", 
           RowBox[{
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"legendStyler", "[", 
                 RowBox[{"valsList", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "1", ",", 
                  RowBox[{"Length", "[", "valsList", "]"}]}], "}"}]}], "]"}], 
              ",", 
              RowBox[{
              "{", "\"\<5\[Cross]\!\(\*SuperscriptBox[\(10\), \
\(-25\)]\)\!\(\*SuperscriptBox[\(Hz\), \(\(-1\)/2\)]\) target for 1\[Dash]4 \
kHz\>\"", "}"}]}], "]"}], ",", 
            RowBox[{"LabelStyle", "\[Rule]", 
             RowBox[{"Directive", "[", "10", "]"}]}], ",", 
            RowBox[{"LegendMarkerSize", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"{", 
               RowBox[{"25", ",", "15"}], "}"}], "}"}]}]}], "]"}]}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"q0", ",", "r0"}], "}"}], "=", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"plotStyle", "\[NotEqual]", 
                RowBox[{"{", "}"}]}], ",", 
               RowBox[{"QuotientRemainder", "[", 
                RowBox[{
                 RowBox[{"Length", "[", "valsList", "]"}], ",", 
                 RowBox[{"Length", "[", "plotStyle", "]"}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", 
                 RowBox[{"Length", "[", "valsList", "]"}]}], "}"}]}], "]"}]}],
             ";", "\[IndentingNewLine]", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"Flatten", "[", 
               RowBox[{
                RowBox[{"Table", "[", 
                 RowBox[{"plotStyle", ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", "1", ",", "q0"}], "}"}]}], "]"}], ",", 
                "1"}], "]"}], ",", 
              RowBox[{"Table", "[", 
               RowBox[{",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "1", ",", "r0"}], "}"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"Directive", "[", 
                RowBox[{"Red", ",", "DotDashed"}], "]"}], "}"}]}], "]"}]}], 
           ")"}]}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"fmin", ",", "fmax"}], "}"}], ",", "All"}], "}"}]}], ",", 
         RowBox[{"Filling", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "valsList", "]"}], "+", "1"}], "\[Rule]", 
            "Bottom"}], "}"}]}], ",", 
         RowBox[{"Frame", "->", "True"}], ",", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "\"\<strain sensitivity (NSR)\\n/ \!\(\*SuperscriptBox[\(Hz\), \
\(\(-1\)/2\)]\) (log scale)\>\"", ","}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
             "\"\<frequency, f=\[CapitalOmega]/(2\[Pi]) / Hz (log scale)\>\"",
               ","}], "}"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"PerformanceGoal", "\[Rule]", "\"\<Speed\>\""}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"Column", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"p1", ",", "p2", ",", "p3"}], "}"}], ",", 
        RowBox[{"Spacings", "\[Rule]", "0"}]}], "]"}]}], ")"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"Clear", "[", "plotwRPPretty", "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"plotwRPPretty", "[", 
     RowBox[{"valsList_", ",", 
      RowBox[{"plotLabel_:", "None"}], ",", 
      RowBox[{"plotStyle_:", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"fmin_:", "1"}], 
      RowBox[{"(*", "Hz", "*)"}], ",", 
      RowBox[{"fmax_:", 
       SuperscriptBox["10", "5"]}], 
      RowBox[{"(*", "Hz", "*)"}], ",", 
      RowBox[{"legendLabels_:", "None"}]}], "]"}], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"performanceGoal", "=", "\"\<Quality\>\""}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"yRanges", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"All", ",", "All"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"All", ",", "All"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"All", ",", "All"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"leftPad", "=", "120"}], ";", "\[IndentingNewLine]", 
      RowBox[{"gridLine", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Omega]s", "/", 
          RowBox[{"(", 
           RowBox[{"2", "\[Pi]"}], ")"}]}], ",", "Cyan"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"p1", "=", 
       RowBox[{"LogLinearPlot", "[", 
        RowBox[{
         RowBox[{"Evaluate", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"20", 
             RowBox[{"Log10", "[", 
              RowBox[{"QNwRP", "@@", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"2", "\[Pi]", " ", "f"}], "}"}], ",", 
                 RowBox[{"valsList", "[", 
                  RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Length", "[", "valsList", "]"}]}], "}"}]}], "]"}], 
          "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"f", ",", "fmin", ",", "fmax"}], "}"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "350"}], ",", "\[IndentingNewLine]", 
         
         RowBox[{"ImagePadding", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"leftPad", ",", "10"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "All"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"FrameTicksStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Directive", "[", 
               RowBox[{"FontSize", "\[Rule]", "14"}], "]"}], ","}], "}"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"FontOpacity", "\[Rule]", "0"}], ",", 
                RowBox[{"FontSize", "\[Rule]", "0"}]}], "]"}], ","}], "}"}]}],
            "}"}]}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"fmin", ",", "fmax"}], "}"}], ",", 
            RowBox[{"yRanges", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", "plotStyle"}], ",", 
         RowBox[{"Frame", "->", "True"}], ",", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{"\"\<noise response / dB\>\"", ",", "14"}], "]"}], 
              ","}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{",", "plotLabel"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"PerformanceGoal", "\[Rule]", "performanceGoal"}], ",", 
         RowBox[{"GridLines", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "gridLine", "}"}], ",", 
            RowBox[{"{", "0", "}"}]}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"p2", "=", 
       RowBox[{"LogLogPlot", "[", 
        RowBox[{
         RowBox[{"Evaluate", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"sigwRP", "@@", 
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"2", "\[Pi]", " ", "f"}], "}"}], ",", 
               RowBox[{"valsList", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Length", "[", "valsList", "]"}]}], "}"}]}], "]"}], 
          "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"f", ",", "fmin", ",", "fmax"}], "}"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "350"}], ",", 
         RowBox[{"ImagePadding", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"leftPad", ",", "10"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "1"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"FrameTicksStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Directive", "[", 
               RowBox[{"FontSize", "\[Rule]", "14"}], "]"}], ","}], "}"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"FontOpacity", "\[Rule]", "0"}], ",", 
                RowBox[{"FontSize", "\[Rule]", "0"}]}], "]"}], ","}], "}"}]}],
            "}"}]}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"fmin", ",", "fmax"}], "}"}], ",", 
            RowBox[{"yRanges", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", "plotStyle"}], ",", 
         RowBox[{"Frame", "->", "True"}], ",", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{"\"\<signal response\>\"", ",", "14"}], "]"}], ","}], 
             "}"}], ",", 
            RowBox[{"{", ",", "}"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"PerformanceGoal", "\[Rule]", "performanceGoal"}], ",", 
         RowBox[{"GridLines", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "gridLine", "}"}], ",", 
            RowBox[{"{", "}"}]}], "}"}]}], ",", 
         RowBox[{"FrameTicks", "->", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Block", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"ticks", "=", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"10", "^", "i"}], ",", 
                    RowBox[{"Superscript", "[", 
                    RowBox[{"10", ",", "i"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "20", ",", "25"}], "}"}]}], "]"}]}], 
                 "}"}], ",", "\[IndentingNewLine]", 
                RowBox[{"Join", "[", 
                 RowBox[{"ticks", ",", 
                  RowBox[{"Flatten", "[", 
                   RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"k", "*", "j"}], ",", "Null"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", "2", ",", "9"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", 
                    RowBox[{"ticks", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "}"}]}], "]"}],
                     ",", "1"}], "]"}]}], "]"}]}], "]"}], ",", "None"}], 
             "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"Automatic", ",", "None"}], "}"}]}], "}"}]}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"p3", "=", 
       RowBox[{"LogLogPlot", "[", 
        RowBox[{
         RowBox[{"Evaluate", "[", "\[IndentingNewLine]", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"ASDShwRP", "@@", 
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"2", "\[Pi]", " ", "f"}], "}"}], ",", 
               RowBox[{"valsList", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Length", "[", "valsList", "]"}]}], "}"}]}], "]"}], 
          "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"f", ",", "fmin", ",", "fmax"}], "}"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "350"}], ",", 
         RowBox[{"ImagePadding", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"leftPad", ",", "10"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"All", ",", "1"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", "plotStyle"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"fmin", ",", "fmax"}], "}"}], ",", 
            RowBox[{"yRanges", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], ",", 
         RowBox[{"Frame", "\[Rule]", "True"}], ",", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{
               "\"\<sensitivity / \!\(\*SuperscriptBox[\(Hz\), \
\(\(-1\)/2\)]\)\>\"", ",", "14"}], "]"}], ","}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{"\"\<frequency / Hz\>\"", ",", "14"}], "]"}], ","}], 
             "}"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"PerformanceGoal", "\[Rule]", "performanceGoal"}], ",", 
         RowBox[{"FrameTicksStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"FontSize", "\[Rule]", "14"}], ","}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"FontSize", "\[Rule]", "14"}], ","}], "}"}]}], "}"}]}], 
         ",", 
         RowBox[{"FrameTicks", "->", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Block", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"ticks", "=", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"10", "^", "i"}], ",", 
                    RowBox[{"Superscript", "[", 
                    RowBox[{"10", ",", "i"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"-", "25"}], ",", 
                    RowBox[{"-", "20"}]}], "}"}]}], "]"}]}], "}"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Join", "[", 
                 RowBox[{"ticks", ",", 
                  RowBox[{"Flatten", "[", 
                   RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"k", "*", "j"}], ",", "Null"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", "2", ",", "9"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", 
                    RowBox[{"ticks", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "}"}]}], "]"}],
                     ",", "1"}], "]"}]}], "]"}]}], "]"}], ",", "None"}], 
             "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"Automatic", ",", "None"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"GridLines", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "gridLine", "}"}], ",", 
            RowBox[{"{", "}"}]}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Labeled", "[", 
       RowBox[{
        RowBox[{"Column", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"p1", ",", "p2", ",", "p3"}], "}"}], ",", 
          RowBox[{"Spacings", "\[Rule]", "0"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"LineLegend", "[", 
          RowBox[{
           RowBox[{"Join", "[", 
            RowBox[{"plotStyle", ",", 
             RowBox[{"{", "Cyan", "}"}]}], "]"}], ",", 
           RowBox[{"Join", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"legendLabels", "===", "None"}], ",", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"legendStylerNoPhase", "[", 
                  RowBox[{"valsList", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "1", ",", 
                   RowBox[{"Length", "[", "valsList", "]"}]}], "}"}]}], "]"}],
                ",", "legendLabels"}], "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{
             "{", "\"\<\!\(\*SubscriptBox[\(\[Omega]\), \(s\)]\), sloshing \
frequency\>\"", "}"}]}], "]"}], ",", 
           RowBox[{"LabelStyle", "\[Rule]", 
            RowBox[{"Directive", "[", "14", "]"}]}], ",", 
           RowBox[{"LegendMarkerSize", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"25", ",", "15"}], "}"}], "}"}]}]}], "]"}], "}"}], ",", 
        
        RowBox[{"{", "Right", "}"}]}], "]"}]}], "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Labeled", "[", 
       RowBox[{"%", ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"LineLegend", "[", 
          RowBox[{
           RowBox[{"{", "Cyan", "}"}], ",", 
           RowBox[{
           "{", "\"\<\!\(\*SubscriptBox[\(\[Omega]\), \(s\)]\), sloshing \
frequency\>\"", "}"}], ",", 
           RowBox[{"LabelStyle", "\[Rule]", 
            RowBox[{"Directive", "[", "14", "]"}]}], ",", 
           RowBox[{"LegendMarkerSize", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"25", ",", "15"}], "}"}], "}"}]}]}], "]"}], "}"}], ",", 
        
        RowBox[{"{", "Right", "}"}]}], "]"}], "*)"}], ")"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"Clear", "[", "plotwRPCompact", "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"plotwRPCompact", "[", 
     RowBox[{"varsListList_", ",", 
      RowBox[{"plotLabel_:", "None"}], ",", 
      RowBox[{"plotStyle_:", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"fmin_:", "1"}], 
      RowBox[{"(*", "Hz", "*)"}], ",", 
      RowBox[{"fmax_:", 
       SuperscriptBox["10", "5"]}], 
      RowBox[{"(*", "Hz", "*)"}], ",", 
      RowBox[{"legendLabels_:", "None"}], ",", 
      RowBox[{"performanceGoal_:", "\"\<Quality\>\""}]}], "]"}], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"leftPad", "=", "65"}], ";", "\[IndentingNewLine]", 
      RowBox[{"imageHeight", "=", "150"}], ";", "\[IndentingNewLine]", 
      RowBox[{"bottomPad", "=", "55"}], ";", "\[IndentingNewLine]", 
      RowBox[{"rightPad", "=", "11"}], ";", "\[IndentingNewLine]", 
      RowBox[{"yRanges", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"All", ",", "All"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"All", ",", "All"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"All", ",", "All"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gridLine", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Omega]s", "/", 
          RowBox[{"(", 
           RowBox[{"2", "\[Pi]"}], ")"}]}], ",", "Cyan"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"QNFn", ",", "sigFn", ",", "ShFn"}], "}"}], "=", 
       RowBox[{"{", 
        RowBox[{"QNwRP", ",", "sigwRP", ",", "ASDShwRP"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"p1", "=", 
       RowBox[{"LogLinearPlot", "[", 
        RowBox[{
         RowBox[{"Evaluate", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"20", 
             RowBox[{"Log10", "[", 
              RowBox[{"QNFn", "@@", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"2", "\[Pi]", " ", "f"}], "}"}], ",", 
                 RowBox[{
                  RowBox[{"varsListList", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "//", "ReleaseHold"}]}], 
                "]"}]}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Length", "[", "varsListList", "]"}]}], "}"}]}], "]"}], 
          "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"f", ",", "fmin", ",", "fmax"}], "}"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"Automatic", ",", "imageHeight"}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ImagePadding", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"leftPad", ",", "rightPad"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "1"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"FrameTicksStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Directive", "[", "Black", "]"}], ","}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"FontOpacity", "\[Rule]", "0"}], ",", 
                RowBox[{"FontSize", "\[Rule]", "0"}]}], "]"}], ","}], "}"}]}],
            "}"}]}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"fmin", ",", "fmax"}], "}"}], ",", 
            RowBox[{"yRanges", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", "plotStyle"}], ",", 
         RowBox[{"Frame", "->", "True"}], ",", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{"\"\<noise response / dB\>\"", ",", 
                RowBox[{"FontSize", "\[Rule]", "16"}], ",", "Black"}], "]"}], 
              ","}], "}"}], ",", 
            RowBox[{"{", ",", "}"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"PerformanceGoal", "\[Rule]", "performanceGoal"}], ",", 
         RowBox[{"GridLines", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "gridLine", "}"}], ",", 
            RowBox[{"{", "0", "}"}]}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"p2", "=", 
       RowBox[{"LogLogPlot", "[", 
        RowBox[{
         RowBox[{"Evaluate", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"sigFn", "@@", 
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"2", "\[Pi]", " ", "f"}], "}"}], ",", 
               RowBox[{
                RowBox[{"varsListList", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "//", "ReleaseHold"}]}], 
              "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Length", "[", "varsListList", "]"}]}], "}"}]}], "]"}], 
          "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"f", ",", "fmin", ",", "fmax"}], "}"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"Automatic", ",", 
            RowBox[{"imageHeight", "+", "bottomPad"}]}], "}"}]}], ",", 
         RowBox[{"ImagePadding", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"leftPad", ",", "rightPad"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"bottomPad", ",", "1"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"FrameTicks", "->", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Block", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"ticks", "=", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"10", "^", "i"}], ",", 
                    RowBox[{"Superscript", "[", 
                    RowBox[{"10", ",", "i"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "20", ",", "30"}], "}"}]}], "]"}]}], 
                 "}"}], ",", "\[IndentingNewLine]", 
                RowBox[{"Join", "[", 
                 RowBox[{"ticks", ",", 
                  RowBox[{"Flatten", "[", 
                   RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"k", "*", "j"}], ",", "Null"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", "2", ",", "9"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", 
                    RowBox[{"ticks", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "}"}]}], "]"}],
                     ",", "1"}], "]"}]}], "]"}]}], "]"}], ",", "None"}], 
             "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"Automatic", ",", "None"}], "}"}]}], "}"}]}], 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"https", ":"}], "//", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"mathematica", ".", "stackexchange", ".", "com"}], "/",
                "questions"}], "/", "241982"}], "/", "use"}], "-", "custom", 
            "-", "ticks", "-", "on", "-", "frameticks", "-", "on", "-", 
            "loglogplot", "-", "but", "-", "preserving", "-", "the", "-", 
            "log", "-", "tick", "-", "marks"}]}], "*)"}], ",", 
         RowBox[{"FrameTicksStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Directive", "[", "Black", "]"}], ","}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Directive", "[", "Black", "]"}], ","}], "}"}]}], 
           "}"}]}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"fmin", ",", "fmax"}], "}"}], ",", 
            RowBox[{"yRanges", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", "plotStyle"}], ",", 
         RowBox[{"Frame", "->", "True"}], ",", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{"\"\<signal response\>\"", ",", "Black"}], "]"}], 
              ","}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{"\"\<frequency / Hz\>\"", ",", "Black"}], "]"}], ","}],
              "}"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"PerformanceGoal", "\[Rule]", "performanceGoal"}], ",", 
         RowBox[{"GridLines", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "gridLine", "}"}], ",", 
            RowBox[{"{", "}"}]}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"p3", "=", 
       RowBox[{"LogLogPlot", "[", 
        RowBox[{
         RowBox[{"Evaluate", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"ShFn", "@@", 
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"2", "\[Pi]", " ", "f"}], "}"}], ",", 
               RowBox[{
                RowBox[{"varsListList", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "//", "ReleaseHold"}]}], 
              "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Length", "[", "varsListList", "]"}]}], "}"}]}], "]"}], 
          "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"f", ",", "fmin", ",", "fmax"}], "}"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"Automatic", ",", 
            RowBox[{
             RowBox[{"2", "imageHeight"}], "+", "bottomPad"}]}], "}"}]}], ",", 
         RowBox[{"AspectRatio", "\[Rule]", 
          RowBox[{"1", "/", "1.3"}]}], ",", 
         RowBox[{"ImagePadding", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"leftPad", "+", "15"}], ",", "rightPad"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"bottomPad", ",", "1"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", "plotStyle"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"fmin", ",", "fmax"}], "}"}], ",", 
            RowBox[{"yRanges", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], ",", 
         RowBox[{"Frame", "\[Rule]", "True"}], ",", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{
               "\"\<sensitivity / \!\(\*SuperscriptBox[\(Hz\), \
\(\(-1\)/2\)]\)\>\"", ",", "Black"}], "]"}], ","}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{"\"\<frequency / Hz\>\"", ",", "Black"}], "]"}], ","}],
              "}"}]}], "}"}]}], ",", 
         RowBox[{"FrameTicks", "->", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Block", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"ticks", "=", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"10", "^", "i"}], ",", 
                    RowBox[{"Superscript", "[", 
                    RowBox[{"10", ",", "i"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"-", "25"}], ",", 
                    RowBox[{"-", "20"}]}], "}"}]}], "]"}]}], "}"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Join", "[", 
                 RowBox[{"ticks", ",", 
                  RowBox[{"Flatten", "[", 
                   RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"k", "*", "j"}], ",", "Null"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", "2", ",", "9"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", 
                    RowBox[{"ticks", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "}"}]}], "]"}],
                     ",", "1"}], "]"}]}], "]"}]}], "]"}], ",", "None"}], 
             "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"Automatic", ",", "None"}], "}"}]}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"PerformanceGoal", "\[Rule]", "performanceGoal"}], ",", 
         RowBox[{"GridLines", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "gridLine", "}"}], ",", 
            RowBox[{"{", "}"}]}], "}"}]}], ",", 
         RowBox[{"FrameTicksStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Directive", "[", "Black", "]"}], ","}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Directive", "[", "Black", "]"}], ","}], "}"}]}], 
           "}"}]}], ",", 
         RowBox[{"PlotLegends", "\[Rule]", 
          RowBox[{"Placed", "[", 
           RowBox[{
            RowBox[{"LineLegend", "[", 
             RowBox[{
              RowBox[{"Join", "[", 
               RowBox[{"plotStyle", ",", 
                RowBox[{"{", "Cyan", "}"}]}], "]"}], ",", 
              "\[IndentingNewLine]", "legendLabels", ",", 
              RowBox[{"LabelStyle", "\[Rule]", 
               RowBox[{"Directive", "[", 
                RowBox[{"FontSize", "\[Rule]", "18"}], "]"}]}], ",", 
              RowBox[{"LegendMarkerSize", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"{", 
                 RowBox[{"25", ",", "15"}], "}"}], "}"}]}], ",", 
              RowBox[{"Spacings", "\[Rule]", "0.15"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"0.5", ",", "0.7"}], "}"}]}], "]"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"p1", ",", 
            RowBox[{"Item", "[", 
             RowBox[{"p3", ",", 
              RowBox[{"Alignment", "\[Rule]", "Center"}]}], "]"}]}], "}"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"p2", ",", "SpanFromAbove"}], "}"}]}], "}"}], ",", 
        RowBox[{"Spacings", "\[Rule]", "0"}]}], 
       RowBox[{"(*", 
        RowBox[{",", 
         RowBox[{"Frame", "\[Rule]", "All"}]}], "*)"}], "]"}]}], ")"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"Clear", "[", "plotwRPSens", "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"plotwRPSens", "[", 
     RowBox[{"valsList_", ",", 
      RowBox[{"plotLabel_:", "None"}], ",", 
      RowBox[{"plotStyle_:", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"fmin_:", "1"}], 
      RowBox[{"(*", "Hz", "*)"}], ",", 
      RowBox[{"fmax_:", 
       SuperscriptBox["10", "5"]}], 
      RowBox[{"(*", "Hz", "*)"}], ",", 
      RowBox[{"performanceGoal_:", "\"\<Quality\>\""}], ",", 
      RowBox[{"legendLabels_:", "None"}], ",", 
      RowBox[{"imageSize_:", 
       RowBox[{"{", 
        RowBox[{"450", ",", "Automatic"}], "}"}]}], ",", 
      RowBox[{"aspectRatio_:", "Automatic"}], ",", 
      RowBox[{"legendTitle_:", "None"}]}], "]"}], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"yRanges", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"All", ",", "All"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"All", ",", "All"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"All", ",", "All"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"LogLogPlot", "[", 
       RowBox[{
        RowBox[{"Evaluate", "[", "\[IndentingNewLine]", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"ASDShwRP", "@@", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"2", "\[Pi]", " ", "f"}], "}"}], ",", 
              RowBox[{"valsList", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "valsList", "]"}]}], "}"}]}], "]"}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"f", ",", "fmin", ",", "fmax"}], "}"}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "imageSize"}], ",", 
        RowBox[{"AspectRatio", "\[Rule]", "aspectRatio"}], ",", 
        RowBox[{"ImagePadding", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"All", ",", "10"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"All", ",", "1"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", "plotStyle"}], ",", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"fmin", ",", "fmax"}], "}"}], ",", 
           RowBox[{"yRanges", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], ",", 
        RowBox[{"Frame", "\[Rule]", "True"}], ",", 
        RowBox[{"FrameLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{
              "\"\<sensitivity / \!\(\*SuperscriptBox[\(Hz\), \(\(-1\)/2\)]\)\
\>\"", ",", "14"}], "]"}], ","}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{"\"\<frequency / Hz\>\"", ",", "14"}], "]"}], ","}], 
            "}"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"PerformanceGoal", "\[Rule]", "performanceGoal"}], ",", 
        RowBox[{"FrameTicksStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"FontSize", "\[Rule]", "14"}], ","}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"FontSize", "\[Rule]", "14"}], ","}], "}"}]}], "}"}]}], 
        ",", 
        RowBox[{"PlotLegends", "\[Rule]", 
         RowBox[{"Placed", "[", 
          RowBox[{
           RowBox[{"LineLegend", "[", 
            RowBox[{"plotStyle", ",", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"legendLabels", "===", "None"}], ",", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"legendStylerNoPhaseNoSplit", "[", 
                  RowBox[{"valsList", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "1", ",", 
                   RowBox[{"Length", "[", "valsList", "]"}]}], "}"}]}], "]"}],
                ",", "legendLabels"}], "]"}], ",", 
             RowBox[{"LabelStyle", "\[Rule]", 
              RowBox[{"Directive", "[", "14", "]"}]}], ",", 
             RowBox[{"LegendMarkerSize", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"{", 
                RowBox[{"25", ",", "15"}], "}"}], "}"}]}], ",", 
             RowBox[{"LabelStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{"FontSize", "->", "14"}], "]"}]}], ",", 
             RowBox[{"Spacings", "\[Rule]", "0.15"}], ",", 
             RowBox[{"LegendLabel", "\[Rule]", "legendTitle"}]}], "]"}], ",", 
           
           RowBox[{"{", 
            RowBox[{"0.5", ",", "0.6"}], "}"}]}], "]"}]}], ",", 
        RowBox[{"FrameTicks", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Block", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"ticks", "=", 
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"10", "^", "i"}], ",", 
                    RowBox[{"Superscript", "[", 
                    RowBox[{"10", ",", "i"}], "]"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"-", "30"}], ",", 
                    RowBox[{"-", "20"}]}], "}"}]}], "]"}]}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Join", "[", 
                RowBox[{"ticks", ",", 
                 RowBox[{"Flatten", "[", 
                  RowBox[{
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"k", "*", "j"}], ",", "Null"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", "2", ",", "9"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", 
                    RowBox[{"ticks", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "}"}]}], "]"}],
                    ",", "1"}], "]"}]}], "]"}]}], "]"}], ",", "None"}], "}"}],
            ",", 
           RowBox[{"{", 
            RowBox[{"Automatic", ",", "None"}], "}"}]}], "}"}]}]}], "]"}]}], 
     ")"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"monoS", "[", "str_", "]"}], ":=", 
    RowBox[{"Style", "[", 
     RowBox[{"str", ",", 
      RowBox[{"FontFamily", "\[Rule]", "\"\<Monospace\>\""}]}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.836949056499524*^9, 3.8369491522453423`*^9}, {
   3.836949203158723*^9, 3.8369492572097607`*^9}, {3.836949350485856*^9, 
   3.836949537776169*^9}, {3.836949571488316*^9, 3.836949640355214*^9}, {
   3.8369496740355062`*^9, 3.8369499493011227`*^9}, {3.836949986994995*^9, 
   3.836950086313497*^9}, {3.8369502516034317`*^9, 3.836950264656722*^9}, {
   3.83695038436172*^9, 3.8369503910357323`*^9}, {3.83695060656115*^9, 
   3.836950622219602*^9}, {3.836950765997849*^9, 3.836950792404911*^9}, {
   3.836950834397187*^9, 3.836950936833548*^9}, 3.836951504688608*^9, {
   3.83695223414974*^9, 3.836952234242729*^9}, 3.8369532123824883`*^9, 
   3.8369538214320498`*^9, {3.836953962894046*^9, 3.836953989455701*^9}, {
   3.836954046506151*^9, 3.836954052119355*^9}, {3.8369541131106977`*^9, 
   3.836954136909297*^9}, {3.836954474855116*^9, 3.836954480510048*^9}, {
   3.836955531493619*^9, 3.836955531867754*^9}, {3.8369577311046057`*^9, 
   3.836957779022931*^9}, {3.8369582287810507`*^9, 3.8369582546845913`*^9}, {
   3.836958479146768*^9, 3.836958491701721*^9}, {3.836958675868391*^9, 
   3.836958723977314*^9}, {3.836958792924575*^9, 3.8369588409660673`*^9}, {
   3.837117677585268*^9, 3.837117725466024*^9}, {3.8371177585465193`*^9, 
   3.8371177973838587`*^9}, 3.837117955589119*^9, {3.837119845799757*^9, 
   3.8371198489155073`*^9}, 3.837125067000743*^9, 3.8371264590897017`*^9, {
   3.837816703884453*^9, 3.837816752021041*^9}, {3.8378168522037086`*^9, 
   3.837816868791451*^9}, 3.837816950321032*^9, {3.8378171633148527`*^9, 
   3.8378172031403418`*^9}, {3.8378173920872173`*^9, 3.837817411906961*^9}, {
   3.837818068253035*^9, 3.8378181323617783`*^9}, {3.8378181715569468`*^9, 
   3.8378181844328012`*^9}, {3.837818233474131*^9, 3.837818302614859*^9}, 
   3.837818506928953*^9, {3.8378185458692427`*^9, 3.837818557177533*^9}, {
   3.8378235445084677`*^9, 3.837823570568779*^9}, {3.837823602539312*^9, 
   3.837823617250292*^9}, {3.838324520908662*^9, 3.8383245627575493`*^9}, {
   3.839275203685545*^9, 3.839275212520473*^9}, {3.84298042268672*^9, 
   3.842980423895318*^9}, {3.8429808040035553`*^9, 3.8429808723288183`*^9}, {
   3.842980946868524*^9, 3.84298094764494*^9}, {3.842981019763444*^9, 
   3.842981147504157*^9}, {3.842981409320417*^9, 3.842981410159608*^9}, {
   3.842981693291903*^9, 3.8429816943805943`*^9}, {3.842982080695779*^9, 
   3.842982088048806*^9}, {3.842982160996917*^9, 3.84298216137449*^9}, {
   3.8429821985456047`*^9, 3.842982200268561*^9}, {3.842982257016494*^9, 
   3.8429823023718777`*^9}, {3.8429824008851433`*^9, 3.842982401155051*^9}, {
   3.842982537236916*^9, 3.842982538000177*^9}, {3.84298262268117*^9, 
   3.842982622745295*^9}, {3.8429826668193913`*^9, 3.842982669610105*^9}, {
   3.842982939956164*^9, 3.8429829552682877`*^9}, 3.842984107966342*^9, {
   3.842984323070198*^9, 3.842984338283469*^9}, {3.8429844574384537`*^9, 
   3.842984467038039*^9}, {3.8429845867648287`*^9, 3.842984604536558*^9}, {
   3.842995627564077*^9, 3.842995628367948*^9}, {3.843853510262988*^9, 
   3.8438535984362087`*^9}, {3.843853816494493*^9, 3.843853845312228*^9}, {
   3.843853975449874*^9, 3.843854045285285*^9}, {3.843854289544846*^9, 
   3.843854293163772*^9}, {3.8438543667536917`*^9, 3.843854455146559*^9}, {
   3.8441253992730427`*^9, 3.8441254319863253`*^9}, {3.8441254693683643`*^9, 
   3.844125573237166*^9}, 3.844125733354169*^9, {3.844125805235862*^9, 
   3.844125817415983*^9}, {3.844125914293293*^9, 3.844125930726829*^9}, {
   3.844125996823586*^9, 3.8441259975901814`*^9}, {3.844126744159329*^9, 
   3.844126820356638*^9}, {3.844126910798369*^9, 3.844127002801277*^9}, {
   3.844127048319662*^9, 3.8441270686601143`*^9}, {3.844646517807555*^9, 
   3.844646575657434*^9}, {3.8446466158937893`*^9, 3.844646618646077*^9}, {
   3.844646669627728*^9, 3.8446466842363777`*^9}, {3.8446467249405413`*^9, 
   3.844646742100039*^9}, {3.84464677449953*^9, 3.844646790262472*^9}, {
   3.84809859470471*^9, 
   3.848098595282634*^9}},ExpressionUUID->"24ec3452-d741-4903-8b5e-\
76bca56bbc49"],

Cell[BoxData[{
 RowBox[{"setConfigParamsCustom", "[", 
  RowBox[{
   FractionBox["2.`", 
    SuperscriptBox["10", "6"]], ",", 
   RowBox[{"4.`", " ", 
    SuperscriptBox["10", "3"]}], ",", "None", ",", 
   RowBox[{"3.`", " ", 
    SuperscriptBox["10", "6"]}], ",", "None", ",", "0.046`", ",", "200.`", 
   ",", "\"\<Li et al, 2020\>\"", ",", 
   RowBox[{"2", " ", "\[Pi]", " ", "5000.`"}], ",", 
   RowBox[{"2", " ", "\[Pi]", " ", "5000.`"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Chi]Ratio0", "=", "0.95"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pumpPhase0", "=", 
    FractionBox["\[Pi]", "2"]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"valsList1", "=", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "0", ",", "pumpPhase0", ",", "Tla0", ",", "Tlb0", ",", "Rpd0"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
        "0", ",", "pumpPhase0", ",", "Tla0", ",", "Tlb0", ",", "Rpd0", ",", 
         "False"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Chi]Ratio0", " ", 
          RowBox[{"singularityThr", "[", 
           RowBox[{"Tla0", ",", "Tlb0"}], "]"}]}], ",", "pumpPhase0", ",", 
         "Tla0", ",", "Tlb0", ",", "Rpd0"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Chi]Ratio0", " ", 
          RowBox[{"singularityThr", "[", 
           RowBox[{"Tla0", ",", "Tlb0"}], "]"}]}], ",", "pumpPhase0", ",", 
         "Tla0", ",", "Tlb0", ",", "Rpd0", ",", "False"}], "}"}]}], "}"}]}], 
    ";"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"valsList1", "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "0", ",", "pumpPhase0", ",", "0", ",", "0", ",", "0", ",", "True"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
       "0", ",", "pumpPhase0", ",", "0", ",", "0", ",", "0", ",", "False"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Chi]Ratio0", " ", 
         RowBox[{"singularityThr", "[", 
          RowBox[{"0", ",", "0"}], "]"}]}], ",", "pumpPhase0", ",", "0", ",", 
        "0", ",", "0", ",", "True"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Chi]Ratio0", " ", 
         RowBox[{"singularityThr", "[", 
          RowBox[{"0", ",", "0"}], "]"}]}], ",", "pumpPhase0", ",", "0", ",", 
        "0", ",", "0", ",", "False"}], "}"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"LogLinearPlot", ",", 
    RowBox[{"BaseStyle", "\[Rule]", 
     RowBox[{"FontSize", "\[Rule]", "18"}]}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetOptions", "[", 
    RowBox[{"LogLogPlot", ",", 
     RowBox[{"BaseStyle", "\[Rule]", 
      RowBox[{"FontSize", "\[Rule]", "18"}]}]}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"plotwRPCompact", "[", 
    RowBox[{"valsList1", ",", "None", ",", 
     RowBox[{"{", 
      RowBox[{"Blue", ",", 
       RowBox[{"{", 
        RowBox[{"Blue", ",", "Dashed"}], "}"}], ",", "Red", ",", 
       RowBox[{"{", 
        RowBox[{"Red", ",", "Dashed"}], "}"}]}], "}"}], ",", "2", ",", 
     RowBox[{"5", " ", 
      SuperscriptBox["10", "4"]}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
       "\"\<\[Chi]/\!\(\*SubscriptBox[\(\[Chi]\), \(thr\)]\)=0, \[Rho]\
\[NotEqual]0\>\"", "//", "monoS"}], ",", 
       RowBox[{
       "\"\<\[Chi]/\!\(\*SubscriptBox[\(\[Chi]\), \(thr\)]\)=0, \[Rho]=0\>\"",
         "//", "monoS"}], ",", 
       RowBox[{
       "\"\<\[Chi]/\!\(\*SubscriptBox[\(\[Chi]\), \(thr\)]\)=0.95, \[Rho]\
\[NotEqual]0\>\"", "//", "monoS"}], ",", 
       RowBox[{
       "\"\<\[Chi]/\!\(\*SubscriptBox[\(\[Chi]\), \(thr\)]\)=0.95, \[Rho]=0\>\
\"", "//", "monoS"}], ",", 
       "\"\<\!\(\*SubscriptBox[\(\[Omega]\), \(s\)]\), sloshing \
frequency\>\""}], "}"}], ",", "\"\<Quality\>\""}], "]"}], "//", "Print"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{"\"\<dIS_lossless_N_S_NSR.pdf\>\"", ",", "%%"}], "]"}], ";"}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.8429809230573597`*^9, 3.8429809768338737`*^9}, {
   3.842981284669057*^9, 3.842981288097259*^9}, 3.842981720720331*^9, {
   3.842982117129446*^9, 3.84298211733652*^9}, 3.84298223448955*^9, {
   3.842982340330308*^9, 3.842982361871566*^9}, {3.84298246913335*^9, 
   3.842982514687402*^9}, 3.8429826969604588`*^9, {3.842982933874411*^9, 
   3.842982934379189*^9}, {3.8429829932128143`*^9, 3.842983014354909*^9}, {
   3.8429955777292213`*^9, 3.842995583057917*^9}, {3.843853603958902*^9, 
   3.843853658837399*^9}, {3.844125737414775*^9, 3.844125760406039*^9}, {
   3.844125975779812*^9, 3.844125986420867*^9}, {3.844126717540584*^9, 
   3.844126726087564*^9}, {3.844126834640212*^9, 3.844126837774851*^9}, {
   3.844126871493767*^9, 3.844126872520132*^9}, {3.84412712145216*^9, 
   3.84412712219746*^9}},
 CellLabel->"In[50]:=",ExpressionUUID->"97dc3119-6eb9-42ff-9ea4-9a1596ad24ab"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"valsList1", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "pumpPhase0", ",", "Tla0", ",", "Tlb0", ",", "Rpd0"}],
       "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Chi]Ratio0", " ", 
        RowBox[{"singularityThr", "[", 
         RowBox[{"Tla0", ",", "Tlb0"}], "]"}]}], ",", "pumpPhase0", ",", 
       "Tla0", ",", "Tlb0", ",", "Rpd0"}], "}"}], ",", "\[IndentingNewLine]", 
     
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Chi]Ratio0", " ", 
        RowBox[{"singularityThr", "[", 
         RowBox[{
          RowBox[{"10", "Tla0"}], ",", "Tlb0"}], "]"}]}], ",", "pumpPhase0", 
       ",", 
       RowBox[{"10", "Tla0"}], ",", "Tlb0", ",", "Rpd0"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Chi]Ratio0", " ", 
        RowBox[{"singularityThr", "[", 
         RowBox[{"Tla0", ",", 
          RowBox[{"10", "Tlb0"}]}], "]"}]}], ",", "pumpPhase0", ",", "Tla0", 
       ",", 
       RowBox[{"10", "Tlb0"}], ",", "Rpd0"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Chi]Ratio0", " ", 
        RowBox[{"singularityThr", "[", 
         RowBox[{"Tla0", ",", "Tlb0"}], "]"}]}], ",", "pumpPhase0", ",", 
       "Tla0", ",", "Tlb0", ",", 
       RowBox[{"5", "Rpd0"}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"plotwRPSens", "[", 
  RowBox[{"valsList1", ",", "None", ",", 
   RowBox[{"{", 
    RowBox[{"Blue", ",", "Red", ",", 
     RowBox[{"{", 
      RowBox[{"Cyan", ",", "Dashed"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Dashed", ",", "Magenta"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Orange", ",", "Dashed"}], "}"}]}], "}"}], ",", "2", ",", 
   RowBox[{"5", " ", 
    SuperscriptBox["10", "4"]}], ",", "\"\<Speed\>\"", ",", 
   RowBox[{"{", 
    RowBox[{"\"\<without squeezing\>\"", ",", "\"\<with squeezing\>\"", ",", 
     RowBox[{
     "\"\<\!\(\*SubscriptBox[\(T\), \(l, a\)]\)=1000ppm\>\"", "//", "monoS"}],
      ",", 
     RowBox[{
     "\"\<\!\(\*SubscriptBox[\(T\), \(l, b\)]\)=10000ppm\>\"", "//", 
      "monoS"}], ",", 
     RowBox[{
     "\"\<\!\(\*SubscriptBox[\(R\), \(PD\)]\)=0.5%\>\"", "//", "monoS"}]}], 
    "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<dIS_loss_tolerance.pdf\>\""}], ",", "%"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.842984386073195*^9, 3.8429844187038727`*^9}, {
  3.842984537166052*^9, 3.842984576722171*^9}, {3.84298461280274*^9, 
  3.842984686519802*^9}, {3.8429847213473263`*^9, 3.842984734105216*^9}, {
  3.842984813999671*^9, 3.842984823685875*^9}, {3.843854052155678*^9, 
  3.843854058073393*^9}, {3.843854109258792*^9, 3.843854185513362*^9}},
 CellLabel->
  "In[215]:=",ExpressionUUID->"7bfe8f5d-81f6-44e7-8f03-898870ed5173"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "TALKplotwRPSens", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TALKplotwRPSens", "[", 
   RowBox[{"valsList_", ",", 
    RowBox[{"plotLabel_:", "None"}], ",", 
    RowBox[{"plotStyle_:", 
     RowBox[{"{", "}"}]}], ",", 
    RowBox[{"fmin_:", "1"}], 
    RowBox[{"(*", "Hz", "*)"}], ",", 
    RowBox[{"fmax_:", 
     SuperscriptBox["10", "5"]}], 
    RowBox[{"(*", "Hz", "*)"}], ",", 
    RowBox[{"performanceGoal_:", "\"\<Quality\>\""}], ",", 
    RowBox[{"legendLabels_:", "None"}], ",", 
    RowBox[{"imageSize_:", 
     RowBox[{"{", 
      RowBox[{"450", ",", "Automatic"}], "}"}]}], ",", 
    RowBox[{"aspectRatio_:", "Automatic"}], ",", 
    RowBox[{"legendTitle_:", "None"}]}], "]"}], ":=", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"yRanges", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"All", ",", "All"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"All", ",", "All"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"All", ",", 
         RowBox[{"3.3", " ", 
          SuperscriptBox["10", 
           RowBox[{"-", "21"}]]}]}], "}"}]}], "}"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"LogLogPlot", "[", 
     RowBox[{
      RowBox[{"Evaluate", "[", "\[IndentingNewLine]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"ASDShwRP", "@@", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"2", "\[Pi]", " ", "f"}], "}"}], ",", 
            RowBox[{"valsList", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "valsList", "]"}]}], "}"}]}], "]"}], "]"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"f", ",", "fmin", ",", "fmax"}], "}"}], ",", 
      RowBox[{"ImageSize", "\[Rule]", "imageSize"}], ",", 
      RowBox[{"AspectRatio", "\[Rule]", "aspectRatio"}], ",", 
      RowBox[{"PlotStyle", "\[Rule]", "plotStyle"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"fmin", ",", "fmax"}], "}"}], ",", 
         RowBox[{"yRanges", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], ",", 
      RowBox[{"Frame", "\[Rule]", "True"}], ",", 
      RowBox[{"FrameLabel", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Style", "[", 
            RowBox[{
            "\"\<sensitivity / \!\(\*SuperscriptBox[\(Hz\), \(\(-1\)/2\)]\)\>\
\"", ",", "14"}], "]"}], ","}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Style", "[", 
            RowBox[{"\"\<frequency / Hz\>\"", ",", "14"}], "]"}], ","}], 
          "}"}]}], "}"}]}], ",", 
      RowBox[{"ImagePadding", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Automatic", ",", "Automatic"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"Automatic", ",", "5"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"PlotLabel", "\[Rule]", 
       RowBox[{"Style", "[", 
        RowBox[{"\"\<degenerate internal squeezing\>\"", ",", "14"}], "]"}]}],
       ",", "\[IndentingNewLine]", 
      RowBox[{"PerformanceGoal", "\[Rule]", "performanceGoal"}], ",", 
      RowBox[{"FrameTicksStyle", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"FontSize", "\[Rule]", "14"}], ","}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"FontSize", "\[Rule]", "14"}], ","}], "}"}]}], "}"}]}], 
      ",", 
      RowBox[{"PlotLegends", "\[Rule]", 
       RowBox[{"Placed", "[", 
        RowBox[{
         RowBox[{"LineLegend", "[", 
          RowBox[{
           RowBox[{"plotStyle", "[", 
            RowBox[{"[", 
             RowBox[{"5", ";;"}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"legendLabels", "===", "None"}], ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"legendStylerNoPhaseNoSplit", "[", 
                RowBox[{"valsList", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", 
                 RowBox[{"Length", "[", "valsList", "]"}]}], "}"}]}], "]"}], 
             ",", "legendLabels"}], "]"}], ",", 
           RowBox[{"LabelStyle", "\[Rule]", 
            RowBox[{"Directive", "[", "14", "]"}]}], ",", 
           RowBox[{"LegendMarkerSize", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"25", ",", "15"}], "}"}], "}"}]}], ",", 
           RowBox[{"LabelStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{"FontSize", "->", "14"}], "]"}]}], ",", 
           RowBox[{"Spacings", "\[Rule]", "0.15"}], ",", 
           RowBox[{"LegendLabel", "\[Rule]", "legendTitle"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"0.5", ",", "0.6"}], "}"}]}], "]"}]}], ",", 
      RowBox[{"FrameTicks", "->", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Block", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"ticks", "=", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"10", "^", "i"}], ",", 
                   RowBox[{"Superscript", "[", 
                    RowBox[{"10", ",", "i"}], "]"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", 
                   RowBox[{"-", "30"}], ",", 
                   RowBox[{"-", "20"}]}], "}"}]}], "]"}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Join", "[", 
              RowBox[{"ticks", ",", 
               RowBox[{"Flatten", "[", 
                RowBox[{
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"k", "*", "j"}], ",", "Null"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"k", ",", "2", ",", "9"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"j", ",", 
                    RowBox[{"ticks", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "}"}]}], "]"}],
                  ",", "1"}], "]"}]}], "]"}]}], "]"}], ",", "None"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"Automatic", ",", "None"}], "}"}]}], "}"}]}]}], "]"}]}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{"setConfigParamsCustom", "[", 
  RowBox[{
   FractionBox["2.`", 
    SuperscriptBox["10", "6"]], ",", 
   RowBox[{"4.`", " ", 
    SuperscriptBox["10", "3"]}], ",", "None", ",", 
   RowBox[{"3.`", " ", 
    SuperscriptBox["10", "6"]}], ",", "None", ",", "0.046`", ",", "200.`", 
   ",", "\"\<Li et al, 2020\>\"", ",", 
   RowBox[{"2", " ", "\[Pi]", " ", "5000.`"}], ",", 
   RowBox[{"2", " ", "\[Pi]", " ", "5000.`"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"LogLogPlot", ",", 
    RowBox[{"BaseStyle", "\[Rule]", 
     RowBox[{"FontSize", "\[Rule]", "18"}]}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"valsList1", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "pumpPhase0", ",", "0", ",", "0", ",", "0"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "pumpPhase0", ",", "0", ",", "0", ",", "Rpd0"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "pumpPhase0", ",", "0", ",", "0", ",", 
       RowBox[{"2", "Rpd0"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "pumpPhase0", ",", "0", ",", "0", ",", 
       RowBox[{"3", "Rpd0"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Chi]Ratio0", " ", 
        RowBox[{"singularityThr", "[", 
         RowBox[{"0", ",", "0"}], "]"}]}], ",", "pumpPhase0", ",", "0", ",", 
       "0", ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Chi]Ratio0", " ", 
        RowBox[{"singularityThr", "[", 
         RowBox[{"0", ",", "0"}], "]"}]}], ",", "pumpPhase0", ",", "0", ",", 
       "0", ",", "Rpd0"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Chi]Ratio0", " ", 
        RowBox[{"singularityThr", "[", 
         RowBox[{"0", ",", "0"}], "]"}]}], ",", "pumpPhase0", ",", "0", ",", 
       "0", ",", 
       RowBox[{"2", "Rpd0"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Chi]Ratio0", " ", 
        RowBox[{"singularityThr", "[", 
         RowBox[{"0", ",", "0"}], "]"}]}], ",", "pumpPhase0", ",", "0", ",", 
       "0", ",", 
       RowBox[{"3", "Rpd0"}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"TALKplotwRPSens", "[", 
  RowBox[{"valsList1", ",", "None", ",", 
   RowBox[{"{", 
    RowBox[{"Blue", ",", 
     RowBox[{"{", 
      RowBox[{"Dashed", ",", 
       RowBox[{"Blend", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Blue", ",", "White"}], "}"}], ",", "0.1"}], "]"}]}], "}"}],
      ",", 
     RowBox[{"{", 
      RowBox[{"Dashed", ",", 
       RowBox[{"Blend", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Blue", ",", "White"}], "}"}], ",", "0.4"}], "]"}]}], "}"}],
      ",", 
     RowBox[{"{", 
      RowBox[{"Dashed", ",", 
       RowBox[{"Blend", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Blue", ",", "White"}], "}"}], ",", "0.7"}], "]"}]}], "}"}],
      ",", "Red", ",", 
     RowBox[{"{", 
      RowBox[{"Dashed", ",", 
       RowBox[{"Blend", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Red", ",", "White"}], "}"}], ",", "0.1"}], "]"}]}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"Dashed", ",", 
       RowBox[{"Blend", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Red", ",", "White"}], "}"}], ",", "0.4"}], "]"}]}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"Dashed", ",", 
       RowBox[{"Blend", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Red", ",", "White"}], "}"}], ",", "0.7"}], "]"}]}], 
      "}"}]}], "}"}], ",", "2", ",", 
   RowBox[{"5", " ", 
    SuperscriptBox["10", "4"]}], ",", "\"\<Quality\>\"", ",", 
   RowBox[{"{", 
    RowBox[{
    "\"\<0%\>\"", ",", "\"\<10%\>\"", ",", "\"\<20%\>\"", ",", 
     "\"\<30%\>\""}], "}"}], ",", "400", ",", "1", ",", 
   "\"\<detection loss\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<talk_dIS_tolerance.pdf\>\""}], ",", "%"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.844646266911541*^9, 3.84464638330867*^9}, {
  3.844646414992693*^9, 3.844646446016873*^9}, {3.844646584219686*^9, 
  3.844646589024077*^9}, {3.8446466372664022`*^9, 3.84464666541162*^9}, {
  3.844646749551826*^9, 3.844646760329609*^9}, {3.8446476530331287`*^9, 
  3.8446476902058573`*^9}, {3.844647777003059*^9, 3.8446477773321123`*^9}, {
  3.844647866606925*^9, 3.844647866853704*^9}, {3.844994589523267*^9, 
  3.844994662409791*^9}, {3.8449949017942753`*^9, 3.844994962618252*^9}, {
  3.844995086363283*^9, 3.8449950871651278`*^9}},
 CellLabel->"In[93]:=",ExpressionUUID->"834a7529-b9e8-4cc9-a3e5-7ff553ab9071"],

Cell[BoxData[{
 RowBox[{"setConfigParamsKorobko2019", "[", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Chi]Ratio0", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"loss0", "=", "0.01"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pumpPhase0", "=", 
   FractionBox["\[Pi]", "2"]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"valsList1", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "0", ",", "pumpPhase0", ",", "loss0", ",", "loss0", ",", "loss0"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "pumpPhase0", ",", "loss0", ",", "loss0", ",", "loss0", ",", 
       "False"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Chi]Ratio0", " ", "\[Gamma]R"}], ",", "pumpPhase0", ",", 
       "loss0", ",", "loss0", ",", "loss0"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Chi]Ratio0", " ", "\[Gamma]R"}], ",", "pumpPhase0", ",", 
       "loss0", ",", "loss0", ",", "loss0", ",", "False"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"plotwRP", "[", 
  RowBox[{"valsList1", ",", "None", ",", 
   RowBox[{"{", 
    RowBox[{",", "Dashed"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"NB", ":", " ", 
    RowBox[{"we", " ", 
     RowBox[{"don", "'"}], "t", " ", "see", " ", "change", " ", "at", " ", 
     RowBox[{"LF", " ", "--"}], " ", "like", " ", "Korobko", " ", 
     "suggests"}]}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.836952322637493*^9, 3.8369523357651978`*^9}, {
   3.836952605081574*^9, 3.836952623614855*^9}, {3.836955203009543*^9, 
   3.836955218703279*^9}, {3.83695790288929*^9, 3.836957914544649*^9}, {
   3.83695983374498*^9, 3.836959842779305*^9}, {3.8371178012078657`*^9, 
   3.837117825474935*^9}, 3.837119442500066*^9, {3.8371194995038767`*^9, 
   3.837119519935128*^9}, {3.837119568149871*^9, 3.837119583780303*^9}, {
   3.837119640909666*^9, 3.837119655714685*^9}, {3.8371199817216797`*^9, 
   3.837120014713468*^9}, 3.8371250949899054`*^9, 3.837126220204834*^9, {
   3.837126503516807*^9, 3.8371265073336782`*^9}, {3.837126623930417*^9, 
   3.837126648522986*^9}, {3.8378167880292892`*^9, 3.837816802877205*^9}, {
   3.837817006116891*^9, 3.837817020116475*^9}, 3.8378172174585238`*^9, {
   3.83781852002673*^9, 3.837818527043618*^9}, {3.837818580299985*^9, 
   3.8378186250822067`*^9}, {3.837823638603163*^9, 3.8378236501118183`*^9}, {
   3.839274999575688*^9, 3.8392749997312927`*^9}, {3.839275088185761*^9, 
   3.8392750934006987`*^9}, {3.84084877369098*^9, 3.840848775652968*^9}, {
   3.840848819111353*^9, 3.840848850524392*^9}, {3.842980927696933*^9, 
   3.8429809298535137`*^9}},
 CellLabel->
  "In[105]:=",ExpressionUUID->"a9a989a0-b460-4b7c-96e2-01a888d8e486"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"valsList1", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "pumpPhase0", ",", "Tla0", ",", "Tlb0", ",", "Rpd0"}],
       "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"0.95", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Gamma]btotFn", "[", "Tlb0", "]"}], "+", 
          RowBox[{"\[Gamma]aFn", "[", "Tla0", "]"}]}], ")"}]}], ",", 
       "pumpPhase0", ",", "Tla0", ",", "Tlb0", ",", "Rpd0"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"0.95", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Gamma]btotFn", "[", "Tlb0", "]"}], "+", 
          RowBox[{"\[Gamma]aFn", "[", "Tla0", "]"}]}], ")"}]}], ",", 
       "pumpPhase0", ",", 
       RowBox[{"1000", "Tla0"}], ",", "Tlb0", ",", "Rpd0"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"0.95", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Gamma]btotFn", "[", "Tlb0", "]"}], "+", 
          RowBox[{"\[Gamma]aFn", "[", "Tla0", "]"}]}], ")"}]}], ",", 
       "pumpPhase0", ",", "Tla0", ",", 
       RowBox[{"500", "Tlb0"}], ",", "Rpd0"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"0.95", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Gamma]btotFn", "[", "Tlb0", "]"}], "+", 
          RowBox[{"\[Gamma]aFn", "[", "Tla0", "]"}]}], ")"}]}], ",", 
       "pumpPhase0", ",", "Tla0", ",", "Tlb0", ",", 
       RowBox[{"5", "Rpd0"}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"plotwRP", "[", 
  RowBox[{"valsList1", ",", "None", ",", 
   RowBox[{"{", 
    RowBox[{"Blue", ",", "Red", ",", "Magenta", ",", "Orange", ",", "Cyan"}], 
    "}"}], ",", "1", ",", " ", 
   RowBox[{"10", "^", "3"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8392751101448936`*^9, 3.839275123637747*^9}, {
  3.839275425670042*^9, 3.8392754632252083`*^9}, {3.839276157328444*^9, 
  3.8392761580085297`*^9}, {3.839276309896867*^9, 3.8392763117628813`*^9}, {
  3.8392792382777452`*^9, 3.83927925050628*^9}, {3.839376559419999*^9, 
  3.839376602928728*^9}, {3.840846922492383*^9, 3.840846965936179*^9}, {
  3.84084699673162*^9, 3.8408470113322163`*^9}, {3.840847142530785*^9, 
  3.840847142661088*^9}, {3.84084743420706*^9, 3.840847475195154*^9}, {
  3.840847822113824*^9, 3.8408478222658453`*^9}, {3.840847983092136*^9, 
  3.840848005729501*^9}, {3.8429809427679358`*^9, 
  3.8429809431965227`*^9}},ExpressionUUID->"0d0f05aa-61c9-4bc1-ba55-\
9fac0938c741"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Chi]Ratio1", "=", "0.95"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"valsList1", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "pumpPhase0", ",", "0", ",", "0", ",", "0"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Chi]Ratio1", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Gamma]btotFn", "[", "0", "]"}], "+", 
          RowBox[{"\[Gamma]aFn", "[", "0", "]"}]}], ")"}]}], ",", 
       "pumpPhase0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "pumpPhase0", ",", "Tla0", ",", "Tlb0", ",", "Rpd0"}],
       "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Chi]Ratio1", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Gamma]btotFn", "[", "Tlb0", "]"}], "+", 
          RowBox[{"\[Gamma]aFn", "[", "Tla0", "]"}]}], ")"}]}], ",", 
       "pumpPhase0", ",", "Tla0", ",", "Tlb0", ",", "Rpd0"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Chi]Ratio1", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Gamma]btotFn", "[", "Tlb0", "]"}], "+", 
          RowBox[{"\[Gamma]aFn", "[", "Tla0", "]"}]}], ")"}]}], ",", 
       "pumpPhase0", ",", "Tla0", ",", "Tlb0", ",", "0"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"plotwRP", "[", 
  RowBox[{"valsList1", ",", "None", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Blue", ",", "Dashed"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Red", ",", "Dashed"}], "}"}], ",", "Blue", ",", "Red", ",", 
     "Magenta"}], "}"}], ",", "10", ",", " ", 
   RowBox[{"10", "^", "5"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.840848899127223*^9, 3.840849029739657*^9}},
 CellLabel->
  "In[208]:=",ExpressionUUID->"9d112f36-fbdd-43f7-917c-4a18d8cae72f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "verifying", " ", "that", " ", "signal", " ", "is", " ", "amplified", " ", 
    "if", " ", "pump", " ", "phase", " ", "is", " ", "flipped"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Chi]Ratio0", "=", "5"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"loss0", "=", "0.01"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pumpPhase0", "=", 
     FractionBox[
      RowBox[{"-", "\[Pi]"}], "2"]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"valsList1", "=", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "0", ",", "pumpPhase0", ",", "0", ",", "loss0", ",", "loss0"}], "}"}],
        ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Chi]Ratio0", " ", "\[Gamma]R"}], ",", "pumpPhase0", ",", 
         "0", ",", "loss0", ",", "loss0"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
        "0", ",", "pumpPhase0", ",", "0.5", ",", "loss0", ",", "loss0"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Chi]Ratio0", " ", "\[Gamma]R"}], ",", "pumpPhase0", ",", 
         "0.5", ",", "loss0", ",", "loss0"}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"plotwRP", "[", 
    RowBox[{"valsList1", ",", "None", ",", 
     RowBox[{"{", "}"}], ",", "100", ",", 
     SuperscriptBox["10", "4"]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "limit", " ", "of", " ", "large", " ", "arm", " ", "loss", " ", "not", 
     " ", "as", " ", "useful", " ", "because", " ", "radiation", " ", 
     "pressure", " ", "is", " ", "not", " ", "in", " ", "DOPO", " ", 
     "model"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "here", " ", "we", " ", "can", " ", "see", " ", "that", " ", "whether", 
      " ", "or", " ", "not", " ", "dIS", " ", "improves", " ", "sensitivity", 
      " ", "depends", " ", "on", " ", "the", " ", "loss", " ", "present", " ",
       "and", " ", "whether", " ", "the", " ", "decrease", " ", "in", " ", 
      "noise", " ", "outpaces", " ", "the", " ", "de"}], "-", 
     RowBox[{"amplification", " ", "of", " ", "signal"}]}], 
    "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.8371251305935087`*^9, 3.837125189957116*^9}, {
   3.8371264854247837`*^9, 3.8371264898882236`*^9}, {3.837126707097081*^9, 
   3.837126740620942*^9}, {3.837126776484713*^9, 3.837126792088982*^9}, {
   3.837817244819994*^9, 3.8378172644276743`*^9}, {3.8378173066699553`*^9, 
   3.837817364858632*^9}, {3.8378174269664097`*^9, 3.837817461011578*^9}, {
   3.8378175140250072`*^9, 3.8378175250038347`*^9}, {3.837817594841498*^9, 
   3.837817642938072*^9}, 3.837817687610043*^9, {3.837817720267992*^9, 
   3.8378177666076*^9}, {3.8381635867427597`*^9, 3.8381636053057327`*^9}, {
   3.838234280911879*^9, 3.838234321080545*^9}, {3.838234366216605*^9, 
   3.838234381790291*^9}, {3.8382344900905113`*^9, 3.838234491253993*^9}, 
   3.8382345335819683`*^9},
 CellLabel->"In[68]:=",ExpressionUUID->"9dbb8255-bdd3-4fa8-bca6-029e1564df3f"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"NB", ":", " ", 
    RowBox[{
    "radiation", " ", "pressure", " ", "worsened", " ", "because", " ", 
     "squeezing", " ", "is", " ", "in", " ", "phase", " ", "quadrature"}]}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"to", "-", 
    RowBox[{"do", ":", " ", 
     RowBox[{"frequency", " ", "dependent", " ", "internal", " ", 
      RowBox[{"squeezing", "?"}]}]}]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.836955461403363*^9, 3.8369554743103323`*^9}, {
  3.8369565731215057`*^9, 3.836956590790863*^9}},
 CellLabel->"In[70]:=",ExpressionUUID->"08cf331e-0caa-4217-95af-ee723b93c1b8"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"to", "-", 
    RowBox[{"do", ":", " ", 
     RowBox[{
     "copy", " ", "other", " ", "plotting", " ", "functions", " ", "from", 
      " ", "degIntSqz"}], ":", "\[IndentingNewLine]", "NB", ":", " ", 
     RowBox[{
     "need", " ", "to", " ", "change", " ", "parameters", " ", "back", " ", 
      "to", " ", "directly", " ", "compare"}]}]}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"-", " ", 
     RowBox[{"stability", " ", "--"}]}], ">", " ", "changes"}], ",", " ", 
   RowBox[{"now", " ", "becomes", " ", "unstable", " ", "on", " ", 
    RowBox[{"threshold", " ", "--"}], " ", 
    RowBox[{"why", "?"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"-", " ", "noise"}], " ", 
     RowBox[{"budget", " ", "--"}]}], ">", " ", 
    RowBox[{
    "appears", " ", "more", " ", "vulnerable", " ", "than", " ", 
     "nondegenerate", " ", "case"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"-", " ", "optimum"}], " ", "sensitivity", " ", "at", " ", 
     "probe", " ", 
     RowBox[{"frequency", " ", "--"}]}], ">", " ", 
    RowBox[{
    "linewidth", " ", "is", " ", "short", " ", "so", " ", "need", " ", "to", 
     " ", "be", " ", "close", " ", "to", " ", "\[Omega]s", " ", "to", " ", 
     "see", " ", "a", " ", "difference"}]}], ","}], "\[IndentingNewLine]", 
  "*)"}]], "Input",
 CellChangeTimes->{{3.8368751342346277`*^9, 3.8368751392758913`*^9}, {
   3.836875313220752*^9, 3.8368753282435913`*^9}, {3.836875977303494*^9, 
   3.836875978936841*^9}, 3.836876583004655*^9, {3.8368766339398327`*^9, 
   3.83687672864815*^9}, {3.8368767684068727`*^9, 3.836876770252152*^9}, {
   3.836876803846798*^9, 3.836876832232662*^9}, 3.836950132255934*^9, {
   3.83695023024631*^9, 3.836950232246825*^9}, {3.8369511012275248`*^9, 
   3.836951103033512*^9}, {3.836955749778467*^9, 3.8369558130241423`*^9}, {
   3.836956548649796*^9, 3.836956561985619*^9}, {3.836959910502049*^9, 
   3.8369599312315617`*^9}, {3.836961215578101*^9, 3.836961223432321*^9}, {
   3.837117837944405*^9, 3.83711784927324*^9}, {3.83712117100072*^9, 
   3.837121177415443*^9}, {3.837125823293365*^9, 3.83712585693119*^9}, {
   3.8371265263037367`*^9, 3.837126559164114*^9}},
 CellLabel->"In[71]:=",ExpressionUUID->"6f89864b-cc61-4a72-b3fa-48050eeeb5a7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"noise", " ", "budget"}], ",", "\[IndentingNewLine]", 
    RowBox[{"to", "-", 
     RowBox[{"do", ":", " ", 
      RowBox[{
      "turn", " ", "shot", " ", "noise", " ", "off", " ", "to", " ", "plot", 
       " ", "radiation", " ", "pressure", " ", "separately"}]}]}], ",", " ", 
    RowBox[{"how", "?"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"RpdwRP", "[", 
     RowBox[{
     "\[CapitalOmega]0_", ",", "\[Chi]0_", ",", "\[Phi]0_", ",", "Tla_", ",", 
      "Tlb_", ",", "Rpd0_", ",", 
      RowBox[{"\[Rho]RPTrue_:", "True"}]}], "]"}], ":=", 
    RowBox[{
     RowBox[{"Re", "[", 
      RowBox[{"Sqrt", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Rpd", " ", "Id"}], ")"}], "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "2"}], "]"}], "]"}], "]"}], "]"}], "/.", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[CapitalOmega]", "\[Rule]", "\[CapitalOmega]0"}], ",", 
       RowBox[{"\[Chi]", "\[Rule]", "\[Chi]0"}], ",", 
       RowBox[{"\[Phi]", "\[Rule]", "\[Phi]0"}], ",", 
       RowBox[{"\[Gamma]a", "\[Rule]", 
        RowBox[{"\[Gamma]aFn", "[", "Tla", "]"}]}], ",", 
       RowBox[{"\[Gamma]btot", "\[Rule]", 
        RowBox[{"\[Gamma]btotFn", "[", "Tlb", "]"}]}], ",", 
       RowBox[{"Rpd", "\[Rule]", "Rpd0"}], ",", 
       RowBox[{"\[Rho]RP", "\[Rule]", 
        RowBox[{"If", "[", 
         RowBox[{"\[Rho]RPTrue", ",", "\[Rho]", ",", "0"}], "]"}]}]}], 
      "}"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RinwRP", "[", 
     RowBox[{
     "\[CapitalOmega]0_", ",", "\[Chi]0_", ",", "\[Phi]0_", ",", "Tla_", ",", 
      "Tlb_", ",", "Rpd0_", ",", 
      RowBox[{"\[Rho]RPTrue_:", "True"}]}], "]"}], ":=", 
    RowBox[{
     RowBox[{"Re", "[", 
      RowBox[{"Sqrt", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Rin", ".", 
          RowBox[{"ConjugateTranspose", "[", "Rin", "]"}]}], ")"}], "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "2"}], "]"}], "]"}], "]"}], "]"}], "/.", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[CapitalOmega]", "\[Rule]", "\[CapitalOmega]0"}], ",", 
       RowBox[{"\[Chi]", "\[Rule]", "\[Chi]0"}], ",", 
       RowBox[{"\[Phi]", "\[Rule]", "\[Phi]0"}], ",", 
       RowBox[{"\[Gamma]a", "\[Rule]", 
        RowBox[{"\[Gamma]aFn", "[", "Tla", "]"}]}], ",", 
       RowBox[{"\[Gamma]btot", "\[Rule]", 
        RowBox[{"\[Gamma]btotFn", "[", "Tlb", "]"}]}], ",", 
       RowBox[{"Rpd", "\[Rule]", "Rpd0"}], ",", 
       RowBox[{"\[Rho]RP", "\[Rule]", 
        RowBox[{"If", "[", 
         RowBox[{"\[Rho]RPTrue", ",", "\[Rho]", ",", "0"}], "]"}]}]}], 
      "}"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RawRP", "[", 
     RowBox[{
     "\[CapitalOmega]0_", ",", "\[Chi]0_", ",", "\[Phi]0_", ",", "Tla_", ",", 
      "Tlb_", ",", "Rpd0_", ",", 
      RowBox[{"\[Rho]RPTrue_:", "True"}]}], "]"}], ":=", 
    RowBox[{
     RowBox[{"Re", "[", 
      RowBox[{"Sqrt", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Ra", ".", 
          RowBox[{"ConjugateTranspose", "[", "Ra", "]"}]}], ")"}], "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "2"}], "]"}], "]"}], "]"}], "]"}], "/.", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[CapitalOmega]", "\[Rule]", "\[CapitalOmega]0"}], ",", 
       RowBox[{"\[Chi]", "\[Rule]", "\[Chi]0"}], ",", 
       RowBox[{"\[Phi]", "\[Rule]", "\[Phi]0"}], ",", 
       RowBox[{"\[Gamma]a", "\[Rule]", 
        RowBox[{"\[Gamma]aFn", "[", "Tla", "]"}]}], ",", 
       RowBox[{"\[Gamma]btot", "\[Rule]", 
        RowBox[{"\[Gamma]btotFn", "[", "Tlb", "]"}]}], ",", 
       RowBox[{"Rpd", "\[Rule]", "Rpd0"}], ",", 
       RowBox[{"\[Rho]RP", "\[Rule]", 
        RowBox[{"If", "[", 
         RowBox[{"\[Rho]RPTrue", ",", "\[Rho]", ",", "0"}], "]"}]}]}], 
      "}"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RbwRP", "[", 
     RowBox[{
     "\[CapitalOmega]0_", ",", "\[Chi]0_", ",", "\[Phi]0_", ",", "Tla_", ",", 
      "Tlb_", ",", "Rpd0_", ",", 
      RowBox[{"\[Rho]RPTrue_:", "True"}]}], "]"}], ":=", 
    RowBox[{
     RowBox[{"Re", "[", 
      RowBox[{"Sqrt", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Rb", ".", 
          RowBox[{"ConjugateTranspose", "[", "Rb", "]"}]}], ")"}], "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "2"}], "]"}], "]"}], "]"}], "]"}], "/.", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[CapitalOmega]", "\[Rule]", "\[CapitalOmega]0"}], ",", 
       RowBox[{"\[Chi]", "\[Rule]", "\[Chi]0"}], ",", 
       RowBox[{"\[Phi]", "\[Rule]", "\[Phi]0"}], ",", 
       RowBox[{"\[Gamma]a", "\[Rule]", 
        RowBox[{"\[Gamma]aFn", "[", "Tla", "]"}]}], ",", 
       RowBox[{"\[Gamma]btot", "\[Rule]", 
        RowBox[{"\[Gamma]btotFn", "[", "Tlb", "]"}]}], ",", 
       RowBox[{"Rpd", "\[Rule]", "Rpd0"}], ",", 
       RowBox[{"\[Rho]RP", "\[Rule]", 
        RowBox[{"If", "[", 
         RowBox[{"\[Rho]RPTrue", ",", "\[Rho]", ",", "0"}], "]"}]}]}], 
      "}"}]}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"plotNoiseBudgetwRP", "[", 
     RowBox[{"params_", ",", 
      RowBox[{"fRange_:", 
       RowBox[{"{", 
        RowBox[{"1", ",", 
         SuperscriptBox["10", "5"]}], "}"}]}]}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"LogLinearPlot", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"20", 
         RowBox[{"Log10", "[", "1", "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"20", 
         RowBox[{"Log10", "[", 
          RowBox[{"RinwRP", "@@", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"2", "\[Pi]", " ", "f"}], "}"}], ",", "params"}], 
            "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"20", 
         RowBox[{"Log10", "[", 
          RowBox[{"RawRP", "@@", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"2", "\[Pi]", " ", "f"}], "}"}], ",", "params"}], 
            "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"20", 
         RowBox[{"Log10", "[", 
          RowBox[{"RbwRP", "@@", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"2", "\[Pi]", " ", "f"}], "}"}], ",", "params"}], 
            "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"20", 
         RowBox[{"Log10", "[", 
          RowBox[{"RpdwRP", "@@", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"2", "\[Pi]", " ", "f"}], "}"}], ",", "params"}], 
            "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"20", 
         RowBox[{"Log10", "[", 
          RowBox[{"QNwRP", "@@", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"2", "\[Pi]", " ", "f"}], "}"}], ",", "params"}], 
            "]"}]}], "]"}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"f", ",", 
        RowBox[{"fRange", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"fRange", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
      RowBox[{"PlotLegends", "\[Rule]", 
       RowBox[{"LineLegend", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "\"\<vacuum\>\"", ",", 
           "\"\<\!\(\*SubscriptBox[\(R\), \(in\)]\), behind SRM\>\"", ",", 
           "\"\<\!\(\*SubscriptBox[SuperscriptBox[\(R\), \((L)\)], \(a\)]\), \
arm intra-cav.\>\"", ",", 
           
           "\"\<\!\(\*SubscriptBox[SuperscriptBox[\(R\), \((L)\)], \(b\)]\), \
SRC signal intra-cav.\>\"", ",", 
           "\"\<\!\(\*SubscriptBox[SuperscriptBox[\(R\), \((L)\)], \(PD\)]\), \
PD loss\>\"", ",", "\"\<total quantum noise\>\""}], "}"}], ",", 
         RowBox[{"LabelStyle", "\[Rule]", 
          RowBox[{"Directive", "[", "10", "]"}]}], ",", 
         RowBox[{"LegendLabel", "\[Rule]", 
          RowBox[{"legendStyler", "[", "params", "]"}]}]}], "]"}]}], ",", 
      RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
      RowBox[{"PlotStyle", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Directive", "[", 
          RowBox[{"Gray", ",", "Dashed"}], "]"}], ",", ",", ",", ",", ",", 
         RowBox[{"Directive", "[", 
          RowBox[{"Black", ",", "Dashed"}], "]"}]}], "}"}]}], ",", 
      RowBox[{"Frame", "->", "True"}], ",", 
      RowBox[{"FrameLabel", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "\"\<quantum noise transfer function,\\n|R| / dB (20log10)\>\"", 
           ","}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
          "\"\<frequency, f=\[CapitalOmega]/(2\[Pi]) / Hz\>\"", ",", 
           "\"\<degenerate internal squeezing\\nparameters of LIGO \
Voyager\>\""}], "}"}]}], "}"}]}], ",", 
      RowBox[{"PerformanceGoal", "\[Rule]", "\"\<Speed\>\""}]}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"Clear", "[", "plotNoiseBudgetwRPPretty", "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"plotNoiseBudgetwRPPretty", "[", 
     RowBox[{"params_", ",", 
      RowBox[{"plotStyle_:", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"fRange_:", 
       RowBox[{"{", 
        RowBox[{"1", ",", 
         SuperscriptBox["10", "5"]}], "}"}]}], ",", 
      RowBox[{"performanceGoal_:", "\"\<Speed\>\""}]}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"LogLinearPlot", "[", 
     RowBox[{
      RowBox[{"Evaluate", "[", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"20", 
          RowBox[{"Log10", "[", 
           RowBox[{"RinwRP", "@@", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"2", "\[Pi]", " ", "f"}], "}"}], ",", "params"}], 
             "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"20", 
          RowBox[{"Log10", "[", 
           RowBox[{"RawRP", "@@", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"2", "\[Pi]", " ", "f"}], "}"}], ",", "params"}], 
             "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"20", 
          RowBox[{"Log10", "[", 
           RowBox[{"RbwRP", "@@", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"2", "\[Pi]", " ", "f"}], "}"}], ",", "params"}], 
             "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"20", 
          RowBox[{"Log10", "[", 
           RowBox[{"RpdwRP", "@@", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"2", "\[Pi]", " ", "f"}], "}"}], ",", "params"}], 
             "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"20", 
          RowBox[{"Log10", "[", 
           RowBox[{"QNwRP", "@@", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"2", "\[Pi]", " ", "f"}], "}"}], ",", "params"}], 
             "]"}]}], "]"}]}]}], "}"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"f", ",", 
        RowBox[{"fRange", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"fRange", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
      RowBox[{"PlotLegends", "\[Rule]", 
       RowBox[{"LineLegend", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "\"\<readout port vacuum\>\"", ",", "\"\<arm intra-cavity loss\>\"",
            ",", "\"\<signal intra-cavity loss\>\"", ",", 
           "\"\<detection loss\>\"", ",", "\"\<total quantum noise\>\""}], 
          "}"}], ",", 
         RowBox[{"LabelStyle", "\[Rule]", 
          RowBox[{"Directive", "[", "14", "]"}]}], ",", 
         RowBox[{"LegendLabel", "\[Rule]", 
          RowBox[{"legendStylerNoPhase", "[", "params", "]"}]}]}], "]"}]}], 
      ",", 
      RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
      RowBox[{"PlotStyle", "\[Rule]", 
       RowBox[{"Join", "[", 
        RowBox[{"plotStyle", ",", 
         RowBox[{"{", 
          RowBox[{"Directive", "[", 
           RowBox[{"Black", ",", "Dashed"}], "]"}], "}"}]}], "]"}]}], ",", 
      RowBox[{"Frame", "->", "True"}], ",", 
      RowBox[{"FrameTicksStyle", "\[Rule]", 
       RowBox[{"Directive", "[", 
        RowBox[{"FontSize", "\[Rule]", "14"}], "]"}]}], ",", 
      RowBox[{"FrameLabel", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Style", "[", 
            RowBox[{
            "\"\<noise response\\n/ dB (20\!\(\*SubscriptBox[\(log\), \(10\)]\
\))\>\"", ",", "14"}], "]"}], ","}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Style", "[", 
            RowBox[{
            "\"\<frequency, f=\!\(\*FractionBox[\(\[CapitalOmega]\), \(2  \
\[Pi]\)]\) / Hz (log scale)\>\"", ",", "14"}], "]"}], ","}], "}"}]}], "}"}]}],
       ",", 
      RowBox[{"PerformanceGoal", "\[Rule]", "performanceGoal"}]}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.8369590983792353`*^9, 3.8369591985394707`*^9}, {
   3.8369592494458237`*^9, 3.836959267243211*^9}, {3.836959325737783*^9, 
   3.836959397486257*^9}, {3.8369594329848022`*^9, 3.836959687217719*^9}, {
   3.836959719555378*^9, 3.836959721379772*^9}, {3.836959759961191*^9, 
   3.836959760706551*^9}, {3.8369598650861893`*^9, 3.836959915688439*^9}, {
   3.836959957720145*^9, 3.836959958534608*^9}, {3.837117858089142*^9, 
   3.837117944796706*^9}, 3.837119693672862*^9, {3.8378178017407293`*^9, 
   3.837817824760623*^9}, {3.8429832956553917`*^9, 3.842983365287458*^9}, {
   3.842983411744171*^9, 3.842983422904476*^9}, 3.84298345322416*^9, {
   3.842983496302642*^9, 3.842983497554391*^9}},
 CellLabel->"In[56]:=",ExpressionUUID->"74395ae9-21ab-4be4-95b6-12d3b7df7666"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Chi]Ratio0", "=", "0.95"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"plotNoiseBudgetwRPPretty", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Chi]Ratio0", " ", 
      RowBox[{"singularityThr", "[", 
       RowBox[{"Tla0", ",", "Tlb0"}], "]"}]}], ",", 
     FractionBox["\[Pi]", "2"], ",", "Tla0", ",", "Tlb0", ",", "Rpd0"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"Blue", ",", "Red", ",", "Cyan", ",", "Orange"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"5", " ", 
      SuperscriptBox["10", "4"]}]}], "}"}], ",", "\"\<Quality\>\""}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<dIS_noise_budget.pdf\>\""}], ",", "%"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.836959705591845*^9, 3.836959751571341*^9}, {
   3.836959788576008*^9, 3.836959820529869*^9}, {3.836960116813314*^9, 
   3.83696012265786*^9}, {3.837117969817863*^9, 3.8371179871678543`*^9}, {
   3.837119706824629*^9, 3.837119709410697*^9}, {3.837121258566512*^9, 
   3.837121318620158*^9}, 3.837125726269312*^9, {3.837817844780265*^9, 
   3.837817886563188*^9}, 3.842983268777041*^9, {3.84298338102372*^9, 
   3.842983482989316*^9}, {3.8429835486328*^9, 3.842983611508782*^9}, 
   3.842983725183423*^9, 3.8429968460811872`*^9},
 CellLabel->"In[73]:=",ExpressionUUID->"24d54f1a-861b-467f-b5a7-0ab8f2298c59"],

Cell[BoxData[
 RowBox[{"plotNoiseBudgetwRPPretty", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"0", " ", 
      RowBox[{"singularityThr", "[", 
       RowBox[{"Tla0", ",", "Tlb0"}], "]"}]}], ",", 
     FractionBox["\[Pi]", "2"], ",", "Tla0", ",", "Tlb0", ",", "Rpd0"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"Blue", ",", "Red", ",", "Cyan", ",", "Orange"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", 
     RowBox[{"5", " ", 
      SuperscriptBox["10", "4"]}]}], "}"}], ",", "\"\<Speed\>\""}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.842996712134973*^9, 3.842996763033671*^9}},
 CellLabel->"In[72]:=",ExpressionUUID->"9079f3e8-8099-4cd2-b41c-59589d10a5c2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "optimum", " ", "sensitivity", " ", "at", " ", "probe", " ", 
     "frequency"}], ",", " ", 
    RowBox[{"\[Phi]", "=", 
     RowBox[{
      FractionBox["\[Pi]", "2"], " ", "is", " ", "fixed"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"to", "-", 
     RowBox[{"do", ":", " ", 
      RowBox[{"allow", " ", "\[Phi]", " ", "freedom"}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"plotThresholdFinder", "[", 
    RowBox[{"fProbe_", ",", 
     RowBox[{"pastThreshold_:", "False"}], ",", 
     RowBox[{"\[Rho]RPTrue_:", "True"}]}], "]"}], ":=", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"probeNoiseRef", "=", 
      RowBox[{"QNwRP", "[", 
       RowBox[{
        RowBox[{"2", "\[Pi]", " ", "fProbe"}], ",", "0", ",", 
        RowBox[{"\[Pi]", "/", "2"}], ",", "0", ",", "0", ",", "0", ",", 
        "\[Rho]RPTrue"}], "]"}]}], ";", 
     RowBox[{"(*", 
      RowBox[{
      "reference", " ", "has", " ", "no", " ", "\[Gamma]c", " ", "loss"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"probeSigRef", "=", 
      RowBox[{"sigwRP", "[", 
       RowBox[{
        RowBox[{"2", "\[Pi]", " ", "fProbe"}], ",", "0", ",", 
        RowBox[{"\[Pi]", "/", "2"}], ",", "0", ",", "0", ",", "0", ",", 
        "\[Rho]RPTrue"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"probeSensRef", "=", 
      RowBox[{"ASDShwRP", "[", 
       RowBox[{
        RowBox[{"2", "\[Pi]", " ", "fProbe"}], ",", "0", ",", 
        RowBox[{"\[Pi]", "/", "2"}], ",", "0", ",", "0", ",", "0", ",", 
        "\[Rho]RPTrue"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"rpdList", "=", 
      RowBox[{"Subdivide", "[", 
       RowBox[{"0", ",", "0.5", ",", "5"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"p1", "=", 
      RowBox[{"ParametricPlot", "[", 
       RowBox[{
        RowBox[{"Evaluate", "[", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "20"}], 
                 RowBox[{"Log10", "[", 
                  RowBox[{
                   RowBox[{"QNwRP", "[", 
                    RowBox[{
                    RowBox[{"2", "\[Pi]", " ", "fProbe"}], ",", 
                    RowBox[{"\[Chi]Ratio", " ", "\[Gamma]R"}], ",", 
                    RowBox[{"\[Pi]", "/", "2"}], ",", "0", ",", "0", ",", 
                    RowBox[{"rpdList", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "\[Rho]RPTrue"}], 
                    "]"}], "/", "probeNoiseRef"}], "]"}]}], ",", 
                RowBox[{
                 RowBox[{"-", "20"}], 
                 RowBox[{"Log10", "[", 
                  RowBox[{
                   RowBox[{"ASDShwRP", "[", 
                    RowBox[{
                    RowBox[{"2", "\[Pi]", " ", "fProbe"}], ",", 
                    RowBox[{"\[Chi]Ratio", " ", "\[Gamma]R"}], ",", 
                    RowBox[{"\[Pi]", "/", "2"}], ",", "0", ",", "0", ",", 
                    RowBox[{"rpdList", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "\[Rho]RPTrue"}], 
                    "]"}], "/", "probeSensRef"}], "]"}]}]}], "}"}], "}"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "[", "rpdList", "]"}]}], "}"}]}], "]"}], ",",
            "1"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Chi]Ratio", ",", "0", ",", "1"}], "}"}], ",", 
        RowBox[{"Frame", "\[Rule]", "True"}], ",", 
        RowBox[{"FrameLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"StringForm", "[", 
              RowBox[{
              "\"\<SNR (\!\(\*SuperscriptBox[\(Hz\), \(1/2\)]\)) gain at `` \
kHz\\nrelative to no loss/sqz. / dB (20 \!\(\*SubscriptBox[\(log\), \
\(10\)]\)(1/\!\(\*SubscriptBox[\(S\), \(h\)]\)))\>\"", ",", 
               RowBox[{"N", "[", 
                FractionBox["fProbe", 
                 SuperscriptBox["10", "3"]], "]"}]}], "]"}], ","}], "}"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{
            ",", "\"\<degenerate internal squeezing\\nparameters of LIGO \
Voyager\>\""}], "}"}]}], "}"}]}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Blend", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Blue", ",", "Green"}], "}"}], ",", 
             FractionBox[
              RowBox[{"i", "-", "1"}], 
              RowBox[{"Length", "[", "rpdList", "]"}]]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "rpdList", "]"}]}], "}"}]}], "]"}]}], ",", 
        RowBox[{"PlotLegends", "\[Rule]", 
         RowBox[{"LineLegend", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"StringForm", "[", 
               RowBox[{
               "\"\<\[Chi]/\[Gamma]R\[Element](0,1), \
\!\(\*SubscriptBox[\(R\), \(PD\)]\)=``\>\"", ",", 
                RowBox[{"NumberForm", "[", 
                 RowBox[{"N", "[", 
                  RowBox[{"rpdList", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", 
                RowBox[{"Length", "[", "rpdList", "]"}]}], "}"}]}], "]"}], 
            "}"}], ",", 
           RowBox[{"LabelStyle", "\[Rule]", 
            RowBox[{"Directive", "[", "10", "]"}]}], ",", 
           RowBox[{"LegendLabel", "\[Rule]", 
            RowBox[{"StringForm", "[", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"Not", "[", "\[Rho]RPTrue", "]"}], ",", 
                "\"\<no RP\>\"", ",", "\"\<with RP\>\""}], "]"}], ",", 
              RowBox[{"NumberForm", "[", 
               RowBox[{"N", "[", "Tlc", "]"}], "]"}]}], "]"}]}]}], "]"}]}], 
        ",", 
        RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
        RowBox[{"ImagePadding", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"80", ",", "10"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "All"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "350"}], ",", 
        RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", 
        RowBox[{"PerformanceGoal", "\[Rule]", "\"\<Speed\>\""}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"p2", "=", 
      RowBox[{"ParametricPlot", "[", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "20"}], 
            RowBox[{"Log10", "[", 
             RowBox[{
              RowBox[{"QNwRP", "[", 
               RowBox[{
                RowBox[{"2", "\[Pi]", " ", "fProbe"}], ",", 
                RowBox[{"1", "  ", "\[Gamma]R"}], ",", 
                RowBox[{"\[Pi]", "/", "2"}], ",", "0", ",", "0", ",", "Rpd", 
                ",", "\[Rho]RPTrue"}], "]"}], "/", "probeNoiseRef"}], "]"}]}],
            ",", 
           RowBox[{
            RowBox[{"-", "20"}], 
            RowBox[{"Log10", "[", 
             RowBox[{
              RowBox[{"ASDShwRP", "[", 
               RowBox[{
                RowBox[{"2", "\[Pi]", " ", "fProbe"}], ",", 
                RowBox[{"1", "  ", "\[Gamma]R"}], ",", 
                RowBox[{"\[Pi]", "/", "2"}], ",", "0", ",", "0", ",", "Rpd", 
                ",", "\[Rho]RPTrue"}], "]"}], "/", "probeSensRef"}], 
             "]"}]}]}], "}"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Rpd", ",", 
          RowBox[{"rpdList", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"rpdList", "[", 
           RowBox[{"[", 
            RowBox[{"-", "1"}], "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"Frame", "\[Rule]", "True"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"Black", ",", "Dashed"}], "]"}]}], ",", 
        RowBox[{"PlotLegends", "\[Rule]", 
         RowBox[{"LineLegend", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"StringForm", "[", 
             RowBox[{
             "\"\<\[Chi]/\[Gamma]R=1, varying \!\(\*SubscriptBox[\(R\), \
\(PD\)]\)\[Element](``,``)\>\"", ",", 
              RowBox[{"NumberForm", "[", 
               RowBox[{"N", "[", 
                RowBox[{"rpdList", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ",", 
              RowBox[{"NumberForm", "[", 
               RowBox[{"N", "[", 
                RowBox[{"rpdList", "[", 
                 RowBox[{"[", 
                  RowBox[{"-", "1"}], "]"}], "]"}], "]"}], "]"}]}], "]"}], 
            "}"}], ",", 
           RowBox[{"LabelStyle", "\[Rule]", 
            RowBox[{"Directive", "[", "10", "]"}]}]}], "]"}]}], ",", 
        RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
        RowBox[{"ImagePadding", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"80", ",", "10"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "All"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "350"}], ",", 
        RowBox[{"PerformanceGoal", "\[Rule]", "\"\<Speed\>\""}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"pastThreshold", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"p1b", "=", 
         RowBox[{"ParametricPlot", "[", 
          RowBox[{
           RowBox[{"Evaluate", "[", 
            RowBox[{"Flatten", "[", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"{", "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", "20"}], 
                    RowBox[{"Log10", "[", 
                    RowBox[{
                    RowBox[{"QNwRP", "[", 
                    RowBox[{
                    RowBox[{"2", "\[Pi]", " ", "fProbe"}], ",", 
                    RowBox[{"\[Chi]Ratio", "  ", "\[Gamma]R"}], ",", 
                    RowBox[{"\[Pi]", "/", "2"}], ",", "0", ",", "0", ",", 
                    RowBox[{"rpdList", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "\[Rho]RPTrue"}], 
                    "]"}], "/", "probeNoiseRef"}], "]"}]}], ",", 
                   RowBox[{
                    RowBox[{"-", "20"}], 
                    RowBox[{"Log10", "[", 
                    RowBox[{
                    RowBox[{"ASDShwRP", "[", 
                    RowBox[{
                    RowBox[{"2", "\[Pi]", " ", "fProbe"}], ",", 
                    RowBox[{"\[Chi]Ratio", "  ", "\[Gamma]R"}], ",", 
                    RowBox[{"\[Pi]", "/", "2"}], ",", "0", ",", "0", ",", 
                    RowBox[{"rpdList", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "\[Rho]RPTrue"}], 
                    "]"}], "/", "probeSensRef"}], "]"}]}]}], "}"}], "}"}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "1", ",", 
                  RowBox[{"Length", "[", "rpdList", "]"}]}], "}"}]}], "]"}], 
              ",", "1"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Chi]Ratio", ",", "1", ",", "2"}], "}"}], ",", 
           RowBox[{"Frame", "\[Rule]", "True"}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"Blend", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"Red", ",", "Yellow"}], "}"}], ",", 
                FractionBox[
                 RowBox[{"i", "-", "1"}], 
                 RowBox[{"Length", "[", "rpdList", "]"}]]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", 
                RowBox[{"Length", "[", "rpdList", "]"}]}], "}"}]}], "]"}]}], 
           ",", 
           RowBox[{"PlotLegends", "\[Rule]", 
            RowBox[{"LineLegend", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"StringForm", "[", 
                  RowBox[{
                  "\"\<\[Chi]/\[Gamma]R\[Element](1,2), \
\!\(\*SubscriptBox[\(R\), \(PD\)]\)=``\>\"", ",", 
                   RowBox[{"NumberForm", "[", 
                    RowBox[{"N", "[", 
                    RowBox[{"rpdList", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}]}], "]"}], 
                 ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "1", ",", 
                   RowBox[{"Length", "[", "rpdList", "]"}]}], "}"}]}], "]"}], 
               "}"}], ",", 
              RowBox[{"LabelStyle", "\[Rule]", 
               RowBox[{"Directive", "[", "10", "]"}]}]}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
           RowBox[{"ImagePadding", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"80", ",", "10"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", "All"}], "}"}]}], "}"}]}], ",", 
           RowBox[{"ImageSize", "\[Rule]", "350"}], ",", 
           RowBox[{"PerformanceGoal", "\[Rule]", "\"\<Speed\>\""}]}], "]"}]}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"p1and2", "=", 
         RowBox[{"Show", "[", 
          RowBox[{"p1", ",", "p1b", ",", "p2"}], "]"}]}], ";"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"p1and2", "=", 
         RowBox[{"Show", "[", 
          RowBox[{"p1", ",", "p2"}], "]"}]}], ";"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"p3", "=", 
      RowBox[{"ParametricPlot", "[", 
       RowBox[{
        RowBox[{"Evaluate", "[", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "20"}], 
                 RowBox[{"Log10", "[", 
                  RowBox[{
                   RowBox[{"QNwRP", "[", 
                    RowBox[{
                    RowBox[{"2", "\[Pi]", " ", "fProbe"}], ",", 
                    RowBox[{"\[Chi]Ratio", "  ", "\[Gamma]R"}], ",", 
                    RowBox[{"\[Pi]", "/", "2"}], ",", "0", ",", "0", ",", 
                    RowBox[{"rpdList", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "\[Rho]RPTrue"}], 
                    "]"}], "/", "probeNoiseRef"}], "]"}]}], ",", 
                RowBox[{"20", 
                 RowBox[{"Log10", "[", 
                  RowBox[{
                   RowBox[{"sigwRP", "[", 
                    RowBox[{
                    RowBox[{"2", "\[Pi]", " ", "fProbe"}], ",", 
                    RowBox[{"\[Chi]Ratio", "  ", "\[Gamma]R"}], ",", 
                    RowBox[{"\[Pi]", "/", "2"}], ",", "0", ",", "0", ",", 
                    RowBox[{"rpdList", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "\[Rho]RPTrue"}], 
                    "]"}], "/", "probeSigRef"}], "]"}]}]}], "}"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "[", "rpdList", "]"}]}], "}"}]}], "]"}], ",",
            "1"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Chi]Ratio", ",", "0", ",", "1"}], "}"}], ",", 
        RowBox[{"Frame", "\[Rule]", "True"}], ",", 
        RowBox[{"FrameLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"StringForm", "[", 
              RowBox[{
              "\"\<signal transfer function |T| at `` kHz\\nrelative to no \
loss/sqz. / dB (20 \!\(\*SubscriptBox[\(log\), \(10\)]\))\>\"", ",", 
               RowBox[{"N", "[", 
                FractionBox["fProbe", 
                 SuperscriptBox["10", "3"]], "]"}]}], "]"}], ","}], "}"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"StringForm", "[", 
              RowBox[{
              "\"\<quantum noise transfer function |R| at `` kHz\\nrelative \
to no loss/sqz. / dB (-20 \!\(\*SubscriptBox[\(log\), \(10\)]\))\>\"", ",", 
               RowBox[{"N", "[", 
                FractionBox["fProbe", 
                 SuperscriptBox["10", "3"]], "]"}]}], "]"}], ","}], "}"}]}], 
          "}"}]}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Blend", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Blue", ",", "Green"}], "}"}], ",", 
             FractionBox[
              RowBox[{"i", "-", "1"}], 
              RowBox[{"Length", "[", "rpdList", "]"}]]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "rpdList", "]"}]}], "}"}]}], "]"}]}], ",", 
        RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
        RowBox[{"ImagePadding", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"80", ",", "10"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"All", ",", "1"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "350"}], ",", 
        RowBox[{"AspectRatio", "\[Rule]", 
         FractionBox["3", "4"]}], ",", 
        RowBox[{"PerformanceGoal", "\[Rule]", "\"\<Speed\>\""}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"p4", "=", 
      RowBox[{"ParametricPlot", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "20"}], 
           RowBox[{"Log10", "[", 
            RowBox[{
             RowBox[{"QNwRP", "[", 
              RowBox[{
               RowBox[{"2", "\[Pi]", " ", "fProbe"}], ",", 
               RowBox[{"1", "  ", "\[Gamma]R"}], ",", 
               RowBox[{"\[Pi]", "/", "2"}], ",", "0", ",", "0", ",", "Rpd", 
               ",", "\[Rho]RPTrue"}], "]"}], "/", "probeNoiseRef"}], "]"}]}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"20", 
           RowBox[{"Log10", "[", 
            RowBox[{
             RowBox[{"sigwRP", "[", 
              RowBox[{
               RowBox[{"2", "\[Pi]", " ", "fProbe"}], ",", 
               RowBox[{"1", "  ", "\[Gamma]R"}], ",", 
               RowBox[{"\[Pi]", "/", "2"}], ",", "0", ",", "0", ",", "Rpd", 
               ",", "\[Rho]RPTrue"}], "]"}], "/", "probeSigRef"}], "]"}]}]}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Rpd", ",", 
          RowBox[{"rpdList", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"rpdList", "[", 
           RowBox[{"[", 
            RowBox[{"-", "1"}], "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"Frame", "\[Rule]", "True"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"Black", ",", "Dashed"}], "]"}]}], ",", 
        RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
        RowBox[{"ImagePadding", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"80", ",", "10"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"All", ",", "1"}], "}"}]}], "}"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"pastThreshold", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"p3b", "=", 
         RowBox[{"ParametricPlot", "[", 
          RowBox[{
           RowBox[{"Evaluate", "[", 
            RowBox[{"Flatten", "[", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"{", "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", "20"}], 
                    RowBox[{"Log10", "[", 
                    RowBox[{
                    RowBox[{"QNwRP", "[", 
                    RowBox[{
                    RowBox[{"2", "\[Pi]", " ", "fProbe"}], ",", 
                    RowBox[{"\[Chi]Ratio", "  ", "\[Gamma]R"}], ",", 
                    RowBox[{"\[Pi]", "/", "2"}], ",", "0", ",", "0", ",", 
                    RowBox[{"rpdList", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "\[Rho]RPTrue"}], 
                    "]"}], "/", "probeNoiseRef"}], "]"}]}], ",", 
                   RowBox[{"20", 
                    RowBox[{"Log10", "[", 
                    RowBox[{
                    RowBox[{"sigwRP", "[", 
                    RowBox[{
                    RowBox[{"2", "\[Pi]", " ", "fProbe"}], ",", 
                    RowBox[{"\[Chi]Ratio", "  ", "\[Gamma]R"}], ",", 
                    RowBox[{"\[Pi]", "/", "2"}], ",", "0", ",", "0", ",", 
                    RowBox[{"rpdList", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "\[Rho]RPTrue"}], 
                    "]"}], "/", "probeSigRef"}], "]"}]}]}], "}"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "1", ",", 
                  RowBox[{"Length", "[", "rpdList", "]"}]}], "}"}]}], "]"}], 
              ",", "1"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Chi]Ratio", ",", "1", ",", "2"}], "}"}], ",", 
           RowBox[{"Frame", "\[Rule]", "True"}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"Blend", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"Red", ",", "Yellow"}], "}"}], ",", 
                FractionBox[
                 RowBox[{"i", "-", "1"}], 
                 RowBox[{"Length", "[", "rpdList", "]"}]]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", 
                RowBox[{"Length", "[", "rpdList", "]"}]}], "}"}]}], "]"}]}], 
           ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
           RowBox[{"ImagePadding", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"80", ",", "10"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", "All"}], "}"}]}], "}"}]}], ",", 
           RowBox[{"ImageSize", "\[Rule]", "350"}], ",", 
           RowBox[{"PerformanceGoal", "\[Rule]", "\"\<Speed\>\""}]}], "]"}]}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"p3and4", "=", 
         RowBox[{"Show", "[", 
          RowBox[{"p3", ",", "p3b", ",", "p4"}], "]"}]}], ";"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"p3and4", "=", 
         RowBox[{"Show", "[", 
          RowBox[{"p3", ",", "p4"}], "]"}]}], ";"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Column", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"p1and2", ",", "p3and4"}], "}"}], ",", 
       RowBox[{"Spacings", "\[Rule]", "0"}]}], "]"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.8369602460387917`*^9, 3.836960570434452*^9}, {
  3.836960627210816*^9, 3.8369607279513474`*^9}, {3.8369608765618668`*^9, 
  3.836960897357997*^9}, {3.837117996788068*^9, 3.837118021935101*^9}, {
  3.8371180556520433`*^9, 3.837118264685523*^9}, {3.837120144994008*^9, 
  3.837120164320825*^9}, {3.837817901319578*^9, 3.837817971920987*^9}, {
  3.838083914565332*^9, 3.838083933033103*^9}},
 CellLabel->"In[81]:=",ExpressionUUID->"0965fdd5-b70c-4675-b9cb-c0cff4c32991"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"fProbe_", ",", 
    RowBox[{"pastThreshold_:", "False"}], ",", 
    RowBox[{"\[Rho]RPTrue_:", "True"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"plotThresholdFinder", "[", 
    RowBox[{"0.99", 
     FractionBox["\[Omega]s", 
      RowBox[{"2", "\[Pi]"}]]}], 
    RowBox[{"(*", "Hz", "*)"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"plotThresholdFinder", "[", "2500", 
    RowBox[{"(*", "Hz", "*)"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "LIGO", " ", "Voyager", " ", "parameters", " ", "have", " ", "short", " ",
      "linewidth", " ", 
     RowBox[{"(", "\[Gamma]R", ")"}], " ", "around", " ", "\[Omega]s"}], 
    "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.836960521732526*^9, 3.8369605234221077`*^9}, {
   3.8369605786634817`*^9, 3.8369606036319647`*^9}, {3.836960635300511*^9, 
   3.836960635870899*^9}, {3.836960758560364*^9, 3.8369607948195887`*^9}, {
   3.836960827930688*^9, 3.83696082922406*^9}, {3.836960913475202*^9, 
   3.836960916558174*^9}, {3.836960952236651*^9, 3.83696095307016*^9}, {
   3.8369609917345867`*^9, 3.836961053659857*^9}, {3.836961193024351*^9, 
   3.8369611939304953`*^9}, {3.8371182751560917`*^9, 3.837118284361671*^9}, {
   3.837120393900579*^9, 3.837120402334827*^9}, {3.83712413427874*^9, 
   3.837124135888982*^9}, 3.8371248381535053`*^9, {3.837125999727366*^9, 
   3.8371260525855627`*^9}, {3.837126132762396*^9, 3.837126171606669*^9}, {
   3.83712627754745*^9, 3.837126303255682*^9}},
 CellLabel->"In[82]:=",ExpressionUUID->"81e9c8c9-35c9-4f6d-ab57-d6b989687d0f"],

Cell[BoxData[
 RowBox[{"plotwRP", "[", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"\[Pi]", "/", "2"}], ",", "0", ",", "0", ",", "0"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"0.85", "\[Gamma]R"}], ",", 
       RowBox[{"\[Pi]", "/", "2"}], ",", "0", ",", "0", ",", "0"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"0.95", "\[Gamma]R"}], ",", 
       RowBox[{"\[Pi]", "/", "2"}], ",", "0", ",", "0", ",", "0"}], "}"}]}], 
    "}"}], ",", "None", ",", 
   RowBox[{"{", "}"}], ",", "10", ",", 
   SuperscriptBox["10", "5"]}], "]"}]], "Input",
 CellChangeTimes->{{3.837125920869711*^9, 3.8371259385694513`*^9}, {
  3.8371259727202063`*^9, 3.837125984394442*^9}, {3.8371260761933393`*^9, 
  3.8371261149431953`*^9}, {3.83781799549903*^9, 3.837818030128158*^9}},
 CellLabel->"In[63]:=",ExpressionUUID->"1b2560e4-7c18-44c9-afcd-9de170fd4c2a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"plotting", " ", "stability"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"denom1", "[", 
      RowBox[{"Tla_", ",", "Tlb_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"\[Gamma]btotFn", "[", "Tlb", "]"}], "+", "\[Chi]", "-", 
      RowBox[{"I", " ", "\[CapitalOmega]"}], "+", 
      FractionBox[
       SuperscriptBox["\[Omega]s", "2"], 
       RowBox[{
        RowBox[{"\[Gamma]aFn", "[", "Tla", "]"}], "-", 
        RowBox[{"\[ImaginaryI]", " ", "\[CapitalOmega]"}]}]]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"denom2", "[", 
      RowBox[{"Tla_", ",", "Tlb_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Gamma]btotFn", "[", "Tlb", "]"}], "+", "\[Chi]", "-", 
        RowBox[{"I", " ", "\[CapitalOmega]"}], "+", 
        FractionBox[
         SuperscriptBox["\[Omega]s", "2"], 
         RowBox[{
          RowBox[{"\[Gamma]aFn", "[", "Tla", "]"}], "-", 
          RowBox[{"\[ImaginaryI]", " ", "\[CapitalOmega]"}]}]]}], ")"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Gamma]btotFn", "[", "Tlb", "]"}], "+", "\[Chi]", "-", 
          RowBox[{"I", " ", "\[CapitalOmega]"}], "+", 
          FractionBox[
           SuperscriptBox["\[Omega]s", "2"], 
           RowBox[{
            RowBox[{"\[Gamma]aFn", "[", "Tla", "]"}], "-", 
            RowBox[{"\[ImaginaryI]", " ", "\[CapitalOmega]"}]}]]}], ")"}], "/.", 
        RowBox[{"\[Chi]", "\[Rule]", 
         RowBox[{"-", "\[Chi]"}]}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Clear", "[", "stabilitydISwRP", "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"stabilitydISwRP", "[", 
     RowBox[{"Tla_", ",", "Tlb_"}], "]"}], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{"(*", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"sol", "=", 
        RowBox[{"NSolve", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"denom1", "[", 
            RowBox[{"Tla", ",", "Tlb"}], "]"}], "\[Equal]", "0"}], ",", 
          "\[CapitalOmega]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"p1", "=", 
        RowBox[{"Plot", "[", 
         RowBox[{
          RowBox[{"Evaluate", "[", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Im", "[", 
                 RowBox[{"\[CapitalOmega]", "/.", 
                  RowBox[{"sol", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "/.", 
                RowBox[{"{", 
                 RowBox[{"\[Chi]", "\[Rule]", 
                  RowBox[{"ratio", " ", "\[Gamma]R"}]}], "}"}]}], ")"}], "/", 
              "\[Gamma]R"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "[", "sol", "]"}]}], "}"}]}], "]"}], "]"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"ratio", ",", "0", ",", "2"}], "}"}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{",", "Dashed", ",", "DotDashed"}], "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ImagePadding", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"50", ",", "2"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "All"}], "}"}]}], "}"}]}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "300"}], ",", 
          RowBox[{"Frame", "\[Rule]", "True"}], ",", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"\"\<Im[\[CapitalOmega]]/\[Gamma]R\>\"", ","}], "}"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{
              ",", "\"\<poles of transfer function\\nunstable when Im[\
\[CapitalOmega]]\[GreaterEqual]0\>\""}], "}"}]}], "}"}]}], ",", 
          RowBox[{"GridLines", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"{", 
               RowBox[{"1", ",", "Red"}], "}"}], "}"}], ",", "None"}], 
            "}"}]}], ",", 
          RowBox[{"PerformanceGoal", "\[Rule]", "\"\<Speed\>\""}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"p2", "=", 
        RowBox[{"Plot", "[", 
         RowBox[{
          RowBox[{"Evaluate", "[", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Re", "[", 
                 RowBox[{"\[CapitalOmega]", "/.", 
                  RowBox[{"sol", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "/.", 
                RowBox[{"{", 
                 RowBox[{"\[Chi]", "\[Rule]", 
                  RowBox[{"ratio", " ", "\[Gamma]R"}]}], "}"}]}], ")"}], "/", 
              "\[Gamma]R"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "[", "sol", "]"}]}], "}"}]}], "]"}], "]"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"ratio", ",", "0", ",", "2"}], "}"}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{",", "Dashed", ",", "DotDashed"}], "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ImagePadding", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"50", ",", "2"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"All", ",", "1"}], "}"}]}], "}"}]}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "300"}], ",", 
          RowBox[{"Frame", "\[Rule]", "True"}], ",", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"\"\<Re[\[CapitalOmega]]/\[Gamma]R\>\"", ","}], "}"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"\"\<\[Chi]/\[Gamma]R\>\"", ","}], "}"}]}], "}"}]}], 
          ",", 
          RowBox[{"GridLines", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"{", 
               RowBox[{"1", ",", "Red"}], "}"}], "}"}], ",", "None"}], 
            "}"}]}], ",", 
          RowBox[{"PerformanceGoal", "\[Rule]", "\"\<Speed\>\""}]}], "]"}]}], 
       ";"}], "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"sol", "=", 
       RowBox[{"NSolve", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"denom2", "[", 
           RowBox[{"Tla", ",", "Tlb"}], "]"}], "\[Equal]", "0"}], ",", 
         "\[CapitalOmega]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"p12", "=", 
       RowBox[{"Plot", "[", 
        RowBox[{
         RowBox[{"Evaluate", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Im", "[", 
                RowBox[{"\[CapitalOmega]", "/.", 
                 RowBox[{"sol", "[", 
                  RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "/.", 
               RowBox[{"{", 
                RowBox[{"\[Chi]", "\[Rule]", 
                 RowBox[{"ratio", " ", "\[Gamma]R"}]}], "}"}]}], ")"}], "/", 
             "\[Gamma]R"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Length", "[", "sol", "]"}]}], "}"}]}], "]"}], "]"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"ratio", ",", "0", ",", "2"}], "}"}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{",", "Dashed", ",", "DotDashed"}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ImagePadding", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"50", ",", "2"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "All"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "300"}], ",", 
         RowBox[{"Frame", "\[Rule]", "True"}], ",", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"\"\<Im[\[CapitalOmega]]/\[Gamma]R\>\"", ","}], "}"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{",", 
              RowBox[{"StringForm", "[", 
               RowBox[{
               "\"\<poles of transfer function\\nunstable when Im[\
\[CapitalOmega]]\[GreaterEqual]0\\n\!\(\*SubscriptBox[\(T\), \(l, a\)]\)=``, \
\!\(\*SubscriptBox[\(T\), \(l, b\)]\)=``\>\"", ",", "Tla", ",", "Tlb"}], 
               "]"}]}], "}"}]}], "}"}]}], ",", 
         RowBox[{"GridLines", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"1", ",", "Red"}], "}"}], "}"}], ",", "None"}], "}"}]}],
          ",", 
         RowBox[{"PerformanceGoal", "\[Rule]", "\"\<Speed\>\""}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"p22", "=", 
       RowBox[{"Plot", "[", 
        RowBox[{
         RowBox[{"Evaluate", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Re", "[", 
                RowBox[{"\[CapitalOmega]", "/.", 
                 RowBox[{"sol", "[", 
                  RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "/.", 
               RowBox[{"{", 
                RowBox[{"\[Chi]", "\[Rule]", 
                 RowBox[{"ratio", " ", "\[Gamma]R"}]}], "}"}]}], ")"}], "/", 
             "\[Gamma]R"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Length", "[", "sol", "]"}]}], "}"}]}], "]"}], "]"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"ratio", ",", "0", ",", "2"}], "}"}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{",", "Dashed", ",", "DotDashed"}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ImagePadding", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"50", ",", "2"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"All", ",", "1"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "300"}], ",", 
         RowBox[{"Frame", "\[Rule]", "True"}], ",", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"\"\<Re[\[CapitalOmega]]/\[Gamma]R\>\"", ","}], "}"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"\"\<\[Chi]/\[Gamma]R\>\"", ","}], "}"}]}], "}"}]}], ",", 
         RowBox[{"GridLines", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"1", ",", "Red"}], "}"}], "}"}], ",", "None"}], "}"}]}],
          ",", 
         RowBox[{"PerformanceGoal", "\[Rule]", "\"\<Speed\>\""}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Row", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Column", "[", 
           RowBox[{"{", 
            RowBox[{"p1", ",", "p2"}], "}"}], "]"}], ",", 
          RowBox[{"Column", "[", 
           RowBox[{"{", 
            RowBox[{"p12", ",", "p22"}], "}"}], "]"}]}], "}"}], "]"}], "*)"}],
       "\[IndentingNewLine]", 
      RowBox[{"Column", "[", 
       RowBox[{"{", 
        RowBox[{"p12", ",", "p22"}], "}"}], "]"}]}], ")"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"Clear", "[", "stabilitydISwRPPretty", "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"stabilitydISwRPPretty", "[", 
     RowBox[{"Tla_", ",", "Tlb_", ",", 
      RowBox[{"hideYAx_:", "False"}], ",", 
      RowBox[{"plotStyle_:", 
       RowBox[{"{", "}"}]}]}], "]"}], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"sol", "=", 
       RowBox[{"NSolve", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"denom2", "[", 
           RowBox[{"Tla", ",", "Tlb"}], "]"}], "\[Equal]", "0"}], ",", 
         "\[CapitalOmega]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Plot", "[", 
       RowBox[{
        RowBox[{"Evaluate", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Im", "[", 
               RowBox[{"\[CapitalOmega]", "/.", 
                RowBox[{"sol", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "/.", 
              RowBox[{"{", 
               RowBox[{"\[Chi]", "\[Rule]", 
                RowBox[{"ratio", "  ", 
                 RowBox[{"singularityThr", "[", 
                  RowBox[{"Tla", ",", "Tlb"}], "]"}]}]}], "}"}]}], ")"}], "/",
             "\[Gamma]bR"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "sol", "]"}]}], "}"}]}], "]"}], "]"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"ratio", ",", "0", ",", "1.1"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"ImagePadding", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{"hideYAx", ",", "2", ",", "30"}], "]"}], ",", "10"}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"20", ",", "1"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"ImageSize", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"Automatic", ",", "220"}], "}"}]}], ",", 
        RowBox[{"Frame", "\[Rule]", "True"}], ",", 
        RowBox[{"FrameLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", ",", "}"}], ",", 
           RowBox[{"{", ",", "}"}]}], "}"}]}], ",", 
        RowBox[{"GridLines", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"1", ",", 
              RowBox[{"Directive", "[", 
               RowBox[{"Black", ",", "Thin"}], "]"}]}], "}"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{"Directive", "[", 
               RowBox[{"Black", ",", "Thin"}], "]"}]}], "}"}], "}"}]}], 
          "}"}]}], ",", 
        RowBox[{"FrameTicksStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{"hideYAx", ",", 
               RowBox[{"Directive", "[", 
                RowBox[{
                 RowBox[{"FontOpacity", "\[Rule]", "0"}], ",", 
                 RowBox[{"FontSize", "\[Rule]", "0"}]}], "]"}], ",", 
               RowBox[{"Directive", "[", 
                RowBox[{"FontSize", "\[Rule]", "14"}], "]"}]}], "]"}], ","}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Directive", "[", 
              RowBox[{"FontSize", "\[Rule]", "14"}], "]"}], ","}], "}"}]}], 
          "}"}]}], ",", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"All", ",", "All"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1.6"}], ",", "0.15"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"PerformanceGoal", "\[Rule]", "\"\<Quality\>\""}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", "plotStyle"}]}], "]"}]}], ")"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{",", 
       RowBox[{"Style", "[", 
        RowBox[{
         RowBox[{"StringForm", "[", 
          RowBox[{
          "\"\<\\n\\n\!\(\*SubscriptBox[\(T\), \(l, \
a\)]\)=``ppm,\\n\!\(\*SubscriptBox[\(T\), \(l, b\)]\)=``ppm\>\"", ",", 
           RowBox[{"NumberForm", "[", 
            RowBox[{"N", "[", 
             RowBox[{"Tla", " ", 
              SuperscriptBox["10", "6"]}], "]"}], "]"}], ",", 
           RowBox[{"NumberForm", "[", 
            RowBox[{"N", "[", 
             RowBox[{"Tlb", " ", 
              SuperscriptBox["10", "6"]}], "]"}], "]"}]}], "]"}], ",", "14"}],
         "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"Right", ",", "Top"}], "}"}], "}"}]}], "]"}], ")"}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Tla_", ",", "Tlb_", ",", "Tlc_"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Labeled", "[", 
    RowBox[{
     RowBox[{"Grid", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"stabilitydISwRPPretty", "[", 
           RowBox[{"0", ",", "0", ",", "False", ",", 
            RowBox[{"{", 
             RowBox[{
             "Cyan", ",", "Blue", ",", "Magenta", ",", "Red", ",", "Orange"}],
              "}"}]}], "]"}], ",", 
          RowBox[{"stabilitydISwRPPretty", "[", 
           RowBox[{"Tla0", ",", "Tlb0", ",", "True", ",", 
            RowBox[{"{", 
             RowBox[{
             "Magenta", ",", "Red", ",", "Cyan", ",", "Blue", ",", "Orange"}],
              "}"}]}], "]"}]}], "}"}], "}"}], ",", 
       RowBox[{"Spacings", "\[Rule]", "0"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Style", "[", 
        RowBox[{
        "\"\<imaginary part of pole / \!\(\*SubscriptBox[\(\[Gamma]\), \(b, R\
\)]\)\>\"", ",", "16", ",", 
         RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}]}], "]"}], ",", 
       RowBox[{"Style", "[", 
        RowBox[{
        "\"\<ratio to singularity threshold, \[Chi]/\!\(\*SubscriptBox[\(\
\[Chi]\), \(thr\)]\)\>\"", ",", "16", ",", 
         RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}]}], "]"}]}], "}"}],
      ",", 
     RowBox[{"{", 
      RowBox[{"Left", ",", "Bottom"}], "}"}], ",", 
     RowBox[{"RotateLabel", "\[Rule]", "True"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
       "\"\<dIS_stability.pdf\>\""}], ",", "%"}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Manipulate", "[", 
     RowBox[{
      RowBox[{"stabilitydISwRP", "[", 
       RowBox[{"Tla", ",", "Tlb"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"Tla", ",", "0", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"Tlb", ",", "0", ",", "1"}], "}"}]}], "]"}], 
    "*)"}]}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJwdymkog3EAx/FRvJGjWN5oWOwF8YKsOZo2RzlSvHKEHJuriBeucs0TLxyx
tbWYjKGZ0qSZOZIj1wtLbZFGXqnpmZVSTzbL8/u/+PV58fsmNvdUyYI5HA6P
HZSeaFsONbREHiJrhXGvJZ2wSRA2CKOOpSOQ2bOPQu1z/iSM1bVPQRHfz8CF
KY8fli1k/dlYA1eNQUeQx4mGyi6KmDBvFMJC8wsx8MfPI79FLIY19WcDkEqx
Ew/KR8bgsI+agBpX/BwUbc4Q+zr6FqGhjasm/WfJEhRkK5bhr3q26JTVOaiv
gm8RIS2w9tZMzPCaNtxrtCTLl2yFBRM7x1BavXUJUyv2byCzqb+DvJiPR+ja
fXfBu7zp1S9Wk+dhHTqZXCNUfa9sQ7pBZIP93WJiuqPjFJ64zs+h4seUpDTQ
kpzI3jSYorCPr7GqrVcU7G6wzMJrg0oF7x11OijP5OrhWXH1DgyfGyKGCp9K
LzZoidt7WQn/AZTbF98=
  "],
 CellLabel->"In[98]:=",ExpressionUUID->"e4268e3c-0d81-4e34-bc2f-f4a464396739"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "plotting", " ", "both", " ", "quadratures", " ", "to", " ", "verify", 
     " ", "the", " ", "effect", " ", "of", " ", "the", " ", "pump", " ", 
     "phase"}], ",", " ", 
    RowBox[{
    "and", " ", "that", " ", "they", " ", "are", " ", "behaving", " ", "as", 
     " ", "claimed"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"advancePhaseByPi", "[", "params_", "]"}], ":=", 
    RowBox[{"Insert", "[", 
     RowBox[{
      RowBox[{"Delete", "[", 
       RowBox[{"params", ",", "2"}], "]"}], ",", 
      RowBox[{
       RowBox[{"params", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "+", "\[Pi]"}], ",", "2"}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"Clear", "[", "plotQNBothQuads", "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"plotQNBothQuads", "[", 
     RowBox[{"valsList_", ",", 
      RowBox[{"plotLabel_:", "None"}], ",", 
      RowBox[{"plotStyle_:", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"fRange_:", 
       RowBox[{"{", 
        RowBox[{"100", 
         RowBox[{"(*", "Hz", "*)"}], ",", 
         SuperscriptBox["10", "5"]}], 
        RowBox[{"(*", "Hz", "*)"}], "}"}]}]}], "]"}], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"p1", "=", 
       RowBox[{"LogLinearPlot", "[", 
        RowBox[{
         RowBox[{"Evaluate", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"20", 
             RowBox[{"Log10", "[", 
              RowBox[{"QNwRP", "@@", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"2", "\[Pi]", " ", "f"}], "}"}], ",", 
                 RowBox[{"advancePhaseByPi", "[", 
                  RowBox[{"valsList", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "]"}]}], "]"}]}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Length", "[", "valsList", "]"}]}], "}"}]}], "]"}], 
          "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"f", ",", 
           RowBox[{"fRange", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"fRange", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "350"}], ",", "\[IndentingNewLine]", 
         
         RowBox[{"PlotLegends", "\[Rule]", 
          RowBox[{"LineLegend", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"legendStyler", "[", 
               RowBox[{"advancePhaseByPi", "[", 
                RowBox[{"valsList", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", 
                RowBox[{"Length", "[", "valsList", "]"}]}], "}"}]}], "]"}], 
            ",", 
            RowBox[{"LabelStyle", "\[Rule]", 
             RowBox[{"Directive", "[", "10", "]"}]}], ",", 
            RowBox[{"LegendMarkerSize", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"{", 
               RowBox[{"25", ",", "15"}], "}"}], "}"}]}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ImagePadding", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"100", ",", "15"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "All"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"TicksStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"FontOpacity", "\[Rule]", "0"}], ",", 
              RowBox[{"FontSize", "\[Rule]", "0"}]}], "]"}], ","}], "}"}]}], 
         ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"fRange", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"fRange", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", "All"}], "}"}]}],
          ",", 
         RowBox[{"PlotStyle", "\[Rule]", "plotStyle"}], ",", 
         RowBox[{"Frame", "->", "True"}], ",", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "\"\<anti-squeezed quadrature\\nof quantum noise\\n|R| / dB \
(20log10)\>\"", ","}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"ToString", "[", "plotLabel", "]"}], "\[Equal]", 
                 RowBox[{"ToString", "[", "None", "]"}]}], ",", 
                "\"\<degenerate internal squeezing\\nparameters of LIGO \
Voyager\\nboth quadratures of quantum noise to verify\\ndifference in \
maximising antisqz. and minimising sqz.\>\"", ",", "plotLabel"}], "]"}]}], 
             "}"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"PerformanceGoal", "\[Rule]", "\"\<Speed\>\""}], ",", 
         RowBox[{"GridLines", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              FractionBox["\[Omega]s", 
               RowBox[{"2", "\[Pi]"}]], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 FractionBox["1", 
                  RowBox[{"2", "\[Pi]"}]], 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    SuperscriptBox["\[Omega]s", "2"], "-", 
                    SuperscriptBox[
                    RowBox[{"\[Gamma]aFn", "[", 
                    RowBox[{"valsList", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "3"}], "]"}], "]"}], "]"}], 
                    "2"]}], ")"}], 
                  RowBox[{"1", "/", "2"}]]}], ",", "Dashed"}], "}"}]}], "}"}],
             ",", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"Directive", "[", 
                RowBox[{"Black", ",", "Thin"}], "]"}]}], "}"}], "}"}]}], 
           "}"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"p2", "=", 
       RowBox[{"LogLinearPlot", "[", 
        RowBox[{
         RowBox[{"Evaluate", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"20", 
             RowBox[{"Log10", "[", 
              RowBox[{"QNwRP", "@@", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"2", "\[Pi]", " ", "f"}], "}"}], ",", 
                 RowBox[{"valsList", "[", 
                  RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Length", "[", "valsList", "]"}]}], "}"}]}], "]"}], 
          "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"f", ",", 
           RowBox[{"fRange", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"fRange", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "350"}], ",", "\[IndentingNewLine]", 
         
         RowBox[{"PlotLegends", "\[Rule]", "\[IndentingNewLine]", 
          RowBox[{"Labeled", "[", 
           RowBox[{
            RowBox[{"LineLegend", "[", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"plotStyle", "===", 
                 RowBox[{"{", "}"}]}], ",", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"ColorData", "[", 
                   RowBox[{"97", ",", "i"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", "1", ",", 
                    RowBox[{
                    RowBox[{"Length", "[", "valsList", "]"}], "+", "1"}]}], 
                   "}"}]}], "]"}], ",", "plotStyle"}], "]"}], ",", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"legendStyler", "[", 
                 RowBox[{"valsList", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "1", ",", 
                  RowBox[{"Length", "[", "valsList", "]"}]}], "}"}]}], "]"}], 
              ",", 
              RowBox[{"LabelStyle", "\[Rule]", 
               RowBox[{"Directive", "[", "10", "]"}]}], ",", 
              RowBox[{"LegendMarkerSize", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"{", 
                 RowBox[{"25", ",", "15"}], "}"}], "}"}]}]}], "]"}], ",", 
            RowBox[{"LineLegend", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Directive", "[", 
                 RowBox[{"LightGray", ",", "Thick"}], "]"}], ",", 
                RowBox[{"Directive", "[", 
                 RowBox[{"LightGray", ",", "Dashed"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
               "\"\<\!\(\*SubscriptBox[\(\[Omega]\), \(s\)]\)\>\"", ",", 
                "\"\<\!\(\*SubscriptBox[\(\[CapitalOmega]\), \
\(\(thr\)\(.\)\)]\) from singularity def\\nfor last set of parameters\>\""}], 
               "}"}], ",", 
              RowBox[{"LabelStyle", "\[Rule]", "10"}], ",", 
              RowBox[{
              "LegendLabel", "\[Rule]", "\"\<vertical gridlines\>\""}]}], 
             "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"ImagePadding", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"100", ",", "15"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"All", ",", "1"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"fRange", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"fRange", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", "All"}], "}"}]}],
          ",", 
         RowBox[{"PlotStyle", "\[Rule]", "plotStyle"}], ",", 
         RowBox[{"Frame", "->", "True"}], ",", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "\"\<squeezed quadrature\\nof quantum noise\\n|R| / dB (20log10)\
\>\"", ","}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
             "\"\<frequency, f=\[CapitalOmega]/(2\[Pi]) / Hz (log scale)\>\"",
               ","}], "}"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"PerformanceGoal", "\[Rule]", "\"\<Speed\>\""}], ",", 
         RowBox[{"GridLines", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              FractionBox["\[Omega]s", 
               RowBox[{"2", "\[Pi]"}]], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 FractionBox["1", 
                  RowBox[{"2", "\[Pi]"}]], 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    SuperscriptBox["\[Omega]s", "2"], "-", 
                    SuperscriptBox[
                    RowBox[{"\[Gamma]aFn", "[", 
                    RowBox[{"valsList", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "3"}], "]"}], "]"}], "]"}], 
                    "2"]}], ")"}], 
                  RowBox[{"1", "/", "2"}]]}], ",", "Dashed"}], "}"}]}], "}"}],
             ",", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"Directive", "[", 
                RowBox[{"Black", ",", "Thin"}], "]"}]}], "}"}], "}"}]}], 
           "}"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Column", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"p1", ",", "p2"}], "}"}], ",", 
        RowBox[{"Spacings", "\[Rule]", "0"}]}], "]"}]}], ")"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"pumpPhase0", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           FractionBox["1", "2"], "+", "0.01"}], ")"}], "\[Pi]"}]}], ",", 
       RowBox[{"Tla0", "=", "0.8"}], ",", 
       RowBox[{"\[Gamma]a", "=", 
        RowBox[{"\[Gamma]aFn", "[", "Tla0", "]"}]}], ",", 
       RowBox[{"Tlb0", "=", "0.01"}], ",", 
       RowBox[{"\[Gamma]btot", "=", 
        RowBox[{"\[Gamma]btotFn", "[", "Tlb0", "]"}]}], ",", 
       RowBox[{"Rpd0", "=", "0.01"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<value of anti-sqz.'d \!\(\*SuperscriptBox[SubscriptBox[\(S\), \(X\
\)], \(1/2\)]\) at sing. threshold value, 20log10: \>\"", ",", 
        RowBox[{"20", " ", 
         RowBox[{"Log10", "[", 
          RowBox[{"QNwRP", "[", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["\[Omega]s", "2"], "-", 
               SuperscriptBox["\[Gamma]a", "2"]}], ")"}], 
             RowBox[{"1", "/", "2"}]], ",", 
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{"\[Gamma]a", "+", "\[Gamma]btot"}], ")"}]}], ",", 
            FractionBox["\[Pi]", "2"], ",", "Tla0", ",", "Tlb0", ",", "Rpd0", 
            ",", "False"}], "]"}], "]"}]}]}], "]"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"doesn", "'"}], "t", " ", "evaluate", " ", "to", " ", 
         RowBox[{"1", "/", "0"}], " ", "because", " ", "of", " ", "numerical",
          " ", "errors", " ", "somewhere"}], ",", " ", 
        RowBox[{"I", " ", "suspect"}]}], "*)"}], ";", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<'' with RP turned on: \>\"", ",", 
        RowBox[{"20", " ", 
         RowBox[{"Log10", "[", 
          RowBox[{"QNwRP", "[", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["\[Omega]s", "2"], "-", 
               SuperscriptBox["\[Gamma]a", "2"]}], ")"}], 
             RowBox[{"1", "/", "2"}]], ",", 
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{"\[Gamma]a", "+", "\[Gamma]btot"}], ")"}]}], ",", 
            FractionBox["\[Pi]", "2"], ",", "Tla0", ",", "Tlb0", ",", "Rpd0", 
            ",", "True"}], "]"}], "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"plotQNBothQuads", "[", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "\[Gamma]R", ",", "pumpPhase0", ",", "Tla0", ",", "Tlb0", ",", 
            "Rpd0", ",", "False"}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
           "\[Gamma]R", ",", "pumpPhase0", ",", "Tla0", ",", "Tlb0", ",", 
            "Rpd0", ",", "True"}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[Gamma]btot", "+", "\[Gamma]a"}], ",", "pumpPhase0", 
            ",", "Tla0", ",", "Tlb0", ",", "Rpd0", ",", "False"}], "}"}], ",",
           "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[Gamma]btot", "+", "\[Gamma]a"}], ",", "pumpPhase0", 
            ",", "Tla0", ",", "Tlb0", ",", "Rpd0", ",", "True"}], "}"}]}], 
         "}"}], ",", "None", ",", 
        RowBox[{"{", 
         RowBox[{",", "Dashed"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          SuperscriptBox["10", 
           RowBox[{"-", "2"}]], ",", 
          SuperscriptBox["10", "5"]}], "}"}]}], "]"}]}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "can", " ", "change", " ", "pumpPhase0", " ", "to", " ", "mix", " ", 
     "the", " ", "quadratures", " ", "together"}], "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.837819726040176*^9, 3.8378197687342978`*^9}, {
   3.8378198941199837`*^9, 3.837820049379855*^9}, 3.8378200838780403`*^9, {
   3.8378201221848497`*^9, 3.837820132353396*^9}, 3.837820163141902*^9, {
   3.837820199256728*^9, 3.837820216269581*^9}, {3.83782040628401*^9, 
   3.837820441482085*^9}, {3.8378205355248213`*^9, 3.837820547789896*^9}, {
   3.837820597662633*^9, 3.837820670054874*^9}, {3.837820703685017*^9, 
   3.837820741192265*^9}, {3.837820778944907*^9, 3.837820906539443*^9}, {
   3.837820985299439*^9, 3.837821016918144*^9}, {3.8378210741077757`*^9, 
   3.83782116854655*^9}, {3.837821212791317*^9, 3.8378212530683203`*^9}, {
   3.837821286439937*^9, 3.8378213764243517`*^9}, {3.837821413160079*^9, 
   3.8378214140530567`*^9}, {3.837821477505886*^9, 3.837821678547326*^9}, {
   3.837821757245428*^9, 3.8378219235646353`*^9}, {3.837821955066226*^9, 
   3.837822047429277*^9}, {3.837822089681633*^9, 3.8378221546790953`*^9}, 
   3.8378222066127243`*^9, {3.837822243548109*^9, 3.837822332539691*^9}, 
   3.837822366398807*^9, {3.837822441709682*^9, 3.837822475547017*^9}, {
   3.8378227736500893`*^9, 3.8378227766734123`*^9}, {3.8378231009595003`*^9, 
   3.8378231768804293`*^9}, 3.837823261371016*^9, {3.837823309821023*^9, 
   3.837823314950755*^9}, {3.837823367069558*^9, 3.8378233803649893`*^9}, {
   3.837823425160326*^9, 3.8378234356175528`*^9}, 3.837823673212101*^9, {
   3.83782371093539*^9, 3.837823848977234*^9}, {3.837823881761829*^9, 
   3.8378239072724257`*^9}, {3.837824189224142*^9, 3.837824189558004*^9}, {
   3.837824230314042*^9, 3.8378244341601257`*^9}, {3.837824472591036*^9, 
   3.8378245193806467`*^9}, {3.837824707792712*^9, 3.837824728701997*^9}, {
   3.8378247588450327`*^9, 3.8378247868200808`*^9}, {3.837824921470051*^9, 
   3.837824923631015*^9}, {3.838163397539241*^9, 3.83816340015469*^9}, {
   3.838172204146768*^9, 3.838172241656785*^9}, 3.838235803030233*^9, {
   3.838235849734996*^9, 3.838235872931521*^9}, 3.838327253491844*^9, 
   3.8383286020625687`*^9, {3.8383287092640247`*^9, 3.838328710465613*^9}, {
   3.838851884782799*^9, 3.838852022560527*^9}, 3.83885221473046*^9},
 CellLabel->
  "In[120]:=",ExpressionUUID->"ff9c8117-718f-4a15-8210-6fbea6595796"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "watch", " ", "out", " ", "when", " ", "copying", " ", "from", " ", 
     RowBox[{"dIS_threshold", ".", "nb"}]}], ",", " ", 
    RowBox[{"QNwRP", " ", "is", " ", 
     SuperscriptBox["Sx", 
      RowBox[{"1", "/", "2"}]], " ", "compared", " ", "to", " ", "Sx1", " ", 
     "which", " ", "is", " ", "Sx"}], ",", " ", 
    RowBox[{
    "factor", " ", "of", " ", "2", " ", "difference", " ", "in", " ", 
     "log"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Clear", "[", "plotQNBothQuadswMin", "]"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"plotQNBothQuadswMin", "[", 
     RowBox[{"valsList_", ",", 
      RowBox[{"plotLabel_:", "None"}], ",", 
      RowBox[{"plotStyle_:", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"fRange_:", 
       RowBox[{"{", 
        RowBox[{"100", 
         RowBox[{"(*", "Hz", "*)"}], ",", 
         SuperscriptBox["10", "5"]}], 
        RowBox[{"(*", "Hz", "*)"}], "}"}]}]}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Gamma]a", "=", 
         RowBox[{"\[Gamma]aFn", "[", 
          RowBox[{"valsList", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "3"}], "]"}], "]"}], "]"}]}], ",", 
        RowBox[{"\[Gamma]btot", "=", 
         RowBox[{"\[Gamma]btotFn", "[", 
          RowBox[{"valsList", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "4"}], "]"}], "]"}], "]"}]}], ",", 
        RowBox[{"Rpd", "=", 
         RowBox[{"valsList", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "5"}], "]"}], "]"}]}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"p1", "=", 
        RowBox[{"LogLinearPlot", "[", 
         RowBox[{
          RowBox[{"Evaluate", "[", 
           RowBox[{"Join", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"20", 
                RowBox[{"Log10", "[", 
                 RowBox[{"QNwRP", "@@", 
                  RowBox[{"Join", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"2", "\[Pi]", " ", "f"}], "}"}], ",", 
                    RowBox[{"advancePhaseByPi", "[", 
                    RowBox[{"valsList", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "]"}]}], "]"}]}],
                ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", 
                 RowBox[{"Length", "[", "valsList", "]"}]}], "}"}]}], "]"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"20", 
               RowBox[{"Log10", "[", 
                RowBox[{"QNwRP", "@@", 
                 RowBox[{"Join", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"2", "\[Pi]", " ", "f"}], ",", 
                    RowBox[{"\[Chi]SqzMinThresh", "[", 
                    RowBox[{"\[Gamma]a", ",", "\[Gamma]btot", ",", "Rpd"}], 
                    "]"}]}], "}"}], ",", 
                   RowBox[{
                    RowBox[{"advancePhaseByPi", "[", 
                    RowBox[{"valsList", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ";;"}], "]"}], "]"}]}], "]"}]}], "]"}]}], 
              "}"}]}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"f", ",", 
            RowBox[{"fRange", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"fRange", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "350"}], ",", "\[IndentingNewLine]", 
          RowBox[{"PlotLegends", "\[Rule]", 
           RowBox[{"LineLegend", "[", 
            RowBox[{
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"legendStyler", "[", 
                  RowBox[{"advancePhaseByPi", "[", 
                   RowBox[{"valsList", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "1", ",", 
                   RowBox[{"Length", "[", "valsList", "]"}]}], "}"}]}], "]"}],
                ",", 
               RowBox[{"{", 
                RowBox[{"legendStyler", "[", 
                 RowBox[{"Join", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"\[Chi]SqzMinThresh", "[", 
                    RowBox[{"\[Gamma]a", ",", "\[Gamma]btot", ",", "Rpd"}], 
                    "]"}], "}"}], ",", 
                   RowBox[{
                    RowBox[{"advancePhaseByPi", "[", 
                    RowBox[{"valsList", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ";;"}], "]"}], "]"}]}], "]"}], "]"}], 
                "}"}]}], "]"}], ",", 
             RowBox[{"LabelStyle", "\[Rule]", 
              RowBox[{"Directive", "[", "10", "]"}]}], ",", 
             RowBox[{"LegendMarkerSize", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"{", 
                RowBox[{"25", ",", "15"}], "}"}], "}"}]}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ImagePadding", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"100", ",", "15"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "All"}], "}"}]}], "}"}]}], ",", 
          RowBox[{"TicksStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Directive", "[", 
              RowBox[{
               RowBox[{"FontOpacity", "\[Rule]", "0"}], ",", 
               RowBox[{"FontSize", "\[Rule]", "0"}]}], "]"}], ","}], "}"}]}], 
          ",", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"fRange", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{"fRange", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", "All"}], 
            "}"}]}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", "plotStyle"}], ",", 
          RowBox[{"Frame", "->", "True"}], ",", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "\"\<anti-squeezed quadrature\\nof quantum noise\\n|R| / dB \
(20log10)\>\"", ","}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"ToString", "[", "plotLabel", "]"}], "\[Equal]", 
                  RowBox[{"ToString", "[", "None", "]"}]}], ",", 
                 "\"\<degenerate internal squeezing\\nparameters of LIGO \
Voyager\\nboth quadratures of quantum noise to verify\\ndifference in \
maximising antisqz. and minimising sqz.\\nlast line is sqz. minimiser\>\"", 
                 ",", "plotLabel"}], "]"}]}], "}"}]}], "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"PerformanceGoal", "\[Rule]", "\"\<Speed\>\""}], ",", 
          RowBox[{"GridLines", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               FractionBox["\[Omega]s", 
                RowBox[{"2", "\[Pi]"}]], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  FractionBox["1", 
                   RowBox[{"2", "\[Pi]"}]], 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox["\[Omega]s", "2"], "-", 
                    SuperscriptBox[
                    RowBox[{"\[Gamma]aFn", "[", 
                    RowBox[{"valsList", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "3"}], "]"}], "]"}], "]"}], 
                    "2"]}], ")"}], 
                   RowBox[{"1", "/", "2"}]]}], ",", "Dashed"}], "}"}]}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Thin"}], "]"}]}], "}"}], "}"}]}], 
            "}"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"p2", "=", 
        RowBox[{"LogLinearPlot", "[", 
         RowBox[{
          RowBox[{"Evaluate", "[", 
           RowBox[{"Join", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"20", 
                RowBox[{"Log10", "[", 
                 RowBox[{"QNwRP", "@@", 
                  RowBox[{"Join", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"2", "\[Pi]", " ", "f"}], "}"}], ",", 
                    RowBox[{"valsList", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", 
                 RowBox[{"Length", "[", "valsList", "]"}]}], "}"}]}], "]"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"20", " ", 
               RowBox[{"Log10", "[", 
                RowBox[{"QNwRP", "@@", 
                 RowBox[{"Join", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"2", "\[Pi]", " ", "f"}], ",", 
                    RowBox[{"\[Chi]SqzMinThresh", "[", 
                    RowBox[{"\[Gamma]a", ",", "\[Gamma]btot", ",", "Rpd"}], 
                    "]"}]}], "}"}], ",", 
                   RowBox[{
                    RowBox[{"valsList", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ";;"}], "]"}], "]"}]}], "]"}]}], "]"}]}], 
              "}"}]}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"f", ",", 
            RowBox[{"fRange", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"fRange", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "350"}], ",", "\[IndentingNewLine]", 
          RowBox[{"PlotLegends", "\[Rule]", "\[IndentingNewLine]", 
           RowBox[{"Labeled", "[", 
            RowBox[{
             RowBox[{"LineLegend", "[", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"plotStyle", "==", 
                  RowBox[{"{", "}"}]}], ",", 
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"ColorData", "[", 
                    RowBox[{"97", ",", "i"}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"i", ",", "1", ",", 
                    RowBox[{
                    RowBox[{"Length", "[", "valsList", "]"}], "+", "1"}]}], 
                    "}"}]}], "]"}], ",", "plotStyle"}], "]"}], ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"legendStyler", "[", 
                    RowBox[{"valsList", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"i", ",", "1", ",", 
                    RowBox[{"Length", "[", "valsList", "]"}]}], "}"}]}], 
                  "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"legendStyler", "[", 
                   RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\[Chi]SqzMinThresh", "[", 
                    RowBox[{"\[Gamma]a", ",", "\[Gamma]btot", ",", "Rpd"}], 
                    "]"}], "}"}], ",", 
                    RowBox[{
                    RowBox[{"valsList", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ";;"}], "]"}], "]"}]}], "]"}], "]"}], 
                  "}"}]}], "]"}], ",", 
               RowBox[{"LabelStyle", "\[Rule]", 
                RowBox[{"Directive", "[", "10", "]"}]}], ",", 
               RowBox[{"LegendMarkerSize", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"{", 
                  RowBox[{"25", ",", "15"}], "}"}], "}"}]}]}], "]"}], ",", 
             RowBox[{"LineLegend", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Directive", "[", 
                  RowBox[{"LightGray", ",", "Thick"}], "]"}], ",", 
                 RowBox[{"Directive", "[", 
                  RowBox[{"LightGray", ",", "Dashed"}], "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "\"\<\!\(\*SubscriptBox[\(\[Omega]\), \(s\)]\)\>\"", ",", 
                 "\"\<\!\(\*SubscriptBox[\(\[CapitalOmega]\), \
\(\(thr\)\(.\)\)]\) from singularity def\\nfor last set of parameters\>\""}], 
                "}"}], ",", 
               RowBox[{"LabelStyle", "\[Rule]", "10"}], ",", 
               RowBox[{
               "LegendLabel", "\[Rule]", "\"\<vertical gridlines\>\""}]}], 
              "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"ImagePadding", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"100", ",", "15"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"All", ",", "1"}], "}"}]}], "}"}]}], ",", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"fRange", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{"fRange", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", "All"}], 
            "}"}]}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", "plotStyle"}], ",", 
          RowBox[{"Frame", "->", "True"}], ",", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "\"\<squeezed quadrature\\nof quantum noise\\n|R| / dB \
(20log10)\>\"", ","}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
              "\"\<frequency, f=\[CapitalOmega]/(2\[Pi]) / Hz (log \
scale)\>\"", ","}], "}"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"PerformanceGoal", "\[Rule]", "\"\<Speed\>\""}], ",", 
          RowBox[{"GridLines", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               FractionBox["\[Omega]s", 
                RowBox[{"2", "\[Pi]"}]], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  FractionBox["1", 
                   RowBox[{"2", "\[Pi]"}]], 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox["\[Omega]s", "2"], "-", 
                    SuperscriptBox[
                    RowBox[{"\[Gamma]aFn", "[", 
                    RowBox[{"valsList", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "3"}], "]"}], "]"}], "]"}], 
                    "2"]}], ")"}], 
                   RowBox[{"1", "/", "2"}]]}], ",", "Dashed"}], "}"}]}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Thin"}], "]"}]}], "}"}], "}"}]}], 
            "}"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Column", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"p1", ",", "p2"}], "}"}], ",", 
         RowBox[{"Spacings", "\[Rule]", "0"}]}], "]"}]}]}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "seems", " ", "to", " ", "be", " ", "the", " ", "same", " ", "for", " ", 
     "\[Epsilon]0", " ", "or", " ", "0.01", " ", "for", " ", "Tlb", " ", 
     "and", " ", "Rpd"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"pumpPhase0", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           FractionBox["1", "2"], "+", "0.00"}], ")"}], "\[Pi]"}]}], ",", 
       RowBox[{"Tla0", "=", "0.8"}], ",", 
       RowBox[{"\[Gamma]a", "=", 
        RowBox[{"\[Gamma]aFn", "[", "Tla0", "]"}]}], ",", 
       RowBox[{"Tlb0", "=", "0.01"}], ",", 
       RowBox[{"\[Gamma]btot", "=", 
        RowBox[{"\[Gamma]btotFn", "[", "Tlb0", "]"}]}], ",", 
       RowBox[{"Rpd0", "=", "0.01"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<value of anti-sqz.'d \!\(\*SuperscriptBox[SubscriptBox[\(S\), \(X\
\)], \(1/2\)]\) at sing. threshold value, 20log10: \>\"", ",", 
        RowBox[{"20", " ", 
         RowBox[{"Log10", "[", 
          RowBox[{"QNwRP", "[", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["\[Omega]s", "2"], "-", 
               SuperscriptBox["\[Gamma]a", "2"]}], ")"}], 
             RowBox[{"1", "/", "2"}]], ",", 
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{"\[Gamma]a", "+", "\[Gamma]btot"}], ")"}]}], ",", 
            FractionBox["\[Pi]", "2"], ",", "Tla0", ",", "Tlb0", ",", "Rpd0", 
            ",", "False"}], "]"}], "]"}]}]}], "]"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"doesn", "'"}], "t", " ", "evaluate", " ", "to", " ", 
         RowBox[{"1", "/", "0"}], " ", "because", " ", "of", " ", "numerical",
          " ", "errors", " ", "somewhere"}], ",", " ", 
        RowBox[{"I", " ", "suspect"}]}], "*)"}], ";", "\[IndentingNewLine]", 
      RowBox[{"plotQNBothQuadswMin", "[", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "\[Gamma]R", ",", "pumpPhase0", ",", "Tla0", ",", "Tlb0", ",", 
            "Rpd0", ",", "False"}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[Gamma]btot", "+", "\[Gamma]a"}], ",", "pumpPhase0", 
            ",", "Tla0", ",", "Tlb0", ",", "Rpd0", ",", "False"}], "}"}]}], 
         "}"}], ",", "None", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Grey", ",", 
            RowBox[{"Thickness", "[", "Small", "]"}]}], "}"}], ",", "Blue", 
          ",", 
          RowBox[{"{", 
           RowBox[{"Red", ",", "Dashed"}], "}"}]}], "}"}]}], "]"}]}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.838170803005385*^9, 3.8381708037854033`*^9}, {
   3.838170867318037*^9, 3.838170953541483*^9}, {3.838171021264039*^9, 
   3.8381711206309013`*^9}, {3.838171159808208*^9, 3.838171220984435*^9}, {
   3.83817131274048*^9, 3.838171313359448*^9}, {3.838171368534429*^9, 
   3.83817137685126*^9}, {3.838171408297114*^9, 3.838171567337982*^9}, {
   3.838171606368691*^9, 3.838171660041102*^9}, {3.838171803918716*^9, 
   3.83817183837436*^9}, {3.838172143445889*^9, 3.838172154975312*^9}, 
   3.838172192420671*^9, {3.838172224986476*^9, 3.838172230962666*^9}, {
   3.838172269676255*^9, 3.838172300748012*^9}, {3.838172375097773*^9, 
   3.8381724416724358`*^9}, {3.838172529825798*^9, 3.83817260295914*^9}, {
   3.8381726411982517`*^9, 3.8381726755762177`*^9}, {3.8381727106291857`*^9, 
   3.8381727399065733`*^9}, {3.838172775227755*^9, 3.838172785970374*^9}, {
   3.8382352716743927`*^9, 3.838235272107257*^9}, {3.838235309682899*^9, 
   3.838235333695915*^9}, 3.8383272310216503`*^9},
 CellLabel->"In[89]:=",ExpressionUUID->"4833e406-b3f7-4ca9-b9f2-c0eb49e87a4b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "transition", " ", "to", " ", "dOPO", " ", "at", " ", "threshold"}], ",", 
    " ", 
    RowBox[{"both", " ", "quadratures"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Epsilon]0", "=", 
     RowBox[{"1", " ", 
      SuperscriptBox["10", 
       RowBox[{"-", "100"}]]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"armLossList", "=", 
     RowBox[{"{", 
      RowBox[{"0.1", ",", "0.8", ",", "0.99", ",", 
       RowBox[{"1", "-", "\[Epsilon]0"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"pumpPhase0", "=", 
        RowBox[{
         RowBox[{"(", 
          FractionBox["1", "2"], ")"}], "\[Pi]"}]}], ",", 
       RowBox[{"Tlb0", "=", "0.05"}], ",", 
       RowBox[{"\[Gamma]btot", "=", 
        RowBox[{"\[Gamma]btotFn", "[", "Tlb0", "]"}]}], ",", 
       RowBox[{"Rpd0", "=", "0.05"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"plotQNBothQuads", "[", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"\[Gamma]btot", ",", "pumpPhase0", ",", 
             RowBox[{"armLossList", "[", 
              RowBox[{"[", "j", "]"}], "]"}], ",", "Tlb0", ",", "Rpd0", ",", 
             "False"}], "}"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", 
            RowBox[{"Length", "[", "armLossList", "]"}]}], "}"}]}], "]"}], 
        ",", "1"}], "]"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"now", " ", "staying", " ", "at", " ", "threshold"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"poleSol0", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Chi]", "\[Rule]", 
         RowBox[{"\[Gamma]btot", "+", "\[Gamma]a"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Chi]", "\[Rule]", 
         RowBox[{"\[Gamma]btot", "+", 
          FractionBox[
           SuperscriptBox["\[Omega]s", "2"], "\[Gamma]a"]}]}], "}"}]}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Chi]PoleThresh", "[", 
     RowBox[{"\[Gamma]a0_", ",", "\[Gamma]btot0_"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"\[Gamma]a0", "\[NotEqual]", "0"}], ",", 
      RowBox[{"Min", "[", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Chi]", "/.", "poleSol0"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\[Gamma]a", "\[Rule]", "\[Gamma]a0"}], ",", 
           RowBox[{"\[Gamma]btot", "\[Rule]", "\[Gamma]btot0"}]}], "}"}]}], 
        ")"}], "]"}], ",", 
      RowBox[{
       RowBox[{"\[Chi]", "/.", 
        RowBox[{"poleSol0", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Gamma]a", "\[Rule]", "\[Gamma]a0"}], ",", 
         RowBox[{"\[Gamma]btot", "\[Rule]", "\[Gamma]btot0"}]}], "}"}]}]}], 
     "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"pumpPhase0", "=", 
        RowBox[{
         RowBox[{"(", 
          FractionBox["1", "2"], ")"}], "\[Pi]"}]}], ",", 
       RowBox[{"Tlb0", "=", "0.05"}], ",", 
       RowBox[{"\[Gamma]btot", "=", 
        RowBox[{"\[Gamma]btotFn", "[", "Tlb0", "]"}]}], ",", 
       RowBox[{"Rpd0", "=", "0.05"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"plotQNBothQuads", "[", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\[Chi]PoleThresh", "[", 
              RowBox[{
               RowBox[{"\[Gamma]aFn", "[", 
                RowBox[{"armLossList", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "]"}], ",", "\[Gamma]btot"}],
               "]"}], ",", "pumpPhase0", ",", 
             RowBox[{"armLossList", "[", 
              RowBox[{"[", "j", "]"}], "]"}], ",", "Tlb0", ",", "Rpd0", ",", 
             "False"}], "}"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", 
            RowBox[{"Length", "[", "armLossList", "]"}]}], "}"}]}], "]"}], 
        ",", "1"}], "]"}], "]"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8383229694085197`*^9, 3.838322983955516*^9}, {
   3.838323077474971*^9, 3.838323097803342*^9}, {3.8383231793776903`*^9, 
   3.838323294350799*^9}, {3.8383233344650373`*^9, 3.83832334358179*^9}, {
   3.838323387349574*^9, 3.8383233898446836`*^9}, {3.838323421536154*^9, 
   3.8383234612193413`*^9}, {3.838323645134756*^9, 3.838323655445279*^9}, {
   3.838323707652149*^9, 3.838323749472519*^9}, {3.8383238533518953`*^9, 
   3.83832395531137*^9}, {3.838324119851063*^9, 3.838324122258486*^9}, {
   3.838324192852059*^9, 3.83832419409601*^9}, {3.838324245807311*^9, 
   3.838324287312368*^9}, 3.838324870798545*^9},
 CellLabel->"In[92]:=",ExpressionUUID->"b902bb6f-5b27-4479-acb7-ac46575451a1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "consider", " ", "whether", " ", "singularity", " ", "threshold", " ", 
    "curve", " ", "creates", " ", "any", " ", "kind", " ", "of", " ", 
    "envelope", " ", "for", " ", "the", " ", "other", " ", "curves"}], "*)"}],
   "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"pumpPhase0", "=", 
        RowBox[{"\[Pi]", "/", "2"}]}], ",", 
       RowBox[{"Tla0", "=", "0.05"}], ",", 
       RowBox[{"Tlb0", "=", "0.05"}], ",", 
       RowBox[{"\[Gamma]btot", "=", 
        RowBox[{"\[Gamma]btotFn", "[", "Tlb0", "]"}]}], ",", 
       RowBox[{"Rpd0", "=", "0.05"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Chi]Thr", "=", 
       RowBox[{"\[Chi]PoleThresh", "[", 
        RowBox[{
         RowBox[{"\[Gamma]aFn", "[", "Tla0", "]"}], ",", "\[Gamma]btot"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
          RowBox[{"\[Chi]SqzMinThresh", "[", 
           RowBox[{
            RowBox[{"\[Gamma]aFn", "[", "Tla0", "]"}], ",", "\[Gamma]btot", 
            ",", "Rpd0"}], "]"}], "/", "\[Chi]Thr"}], "]"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"\[Chi]RatioList", "=", 
       RowBox[{"Subdivide", "[", 
        RowBox[{"0.7", ",", "1", ",", "8"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"plotQNBothQuads", "[", 
       RowBox[{
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Chi]RatioList", "[", 
              RowBox[{"[", "j", "]"}], "]"}], "\[Chi]Thr"}], ",", 
            "pumpPhase0", ",", "Tla0", ",", "Tlb0", ",", "Rpd0", ",", 
            "False"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", 
            RowBox[{"Length", "[", "\[Chi]RatioList", "]"}]}], "}"}]}], "]"}],
         ",", "None", ",", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Blend", "[", 
             RowBox[{"\"\<BlueGreenYellow\>\"", ",", 
              FractionBox[
               RowBox[{"j", "-", "1"}], 
               RowBox[{"Length", "[", "\[Chi]RatioList", "]"}]]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", 
              RowBox[{
               RowBox[{"Length", "[", "\[Chi]RatioList", "]"}], "-", "1"}]}], 
             "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"Directive", "[", 
            RowBox[{"Black", ",", "Dashed"}], "]"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"4", " ", 
           RowBox[{"10", "^", "3"}]}], ",", 
          RowBox[{"6", " ", 
           RowBox[{"10", "^", "3"}]}]}], "}"}]}], "]"}]}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"doesn", "'"}], "t", " ", "look", " ", "like", " ", 
     RowBox[{"there", "'"}], "s", " ", "any", " ", "enveloping"}], 
    "*)"}]}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQB2IQ/W2W4IPHM944Tplw6wmIznimZM42841jlkqsN4j2
4eEJBNGs2bpgWiI2KwxEr7jwPQNE9zzOLwbRBr1fSkD0c9erVSD6ZGlnHYgO
uLiqGURvkf4JpnlOXm8H0TounzrA/BLFZ+xAupCx+xOIFnuW9AdE5wjasHAA
6RvCbBwg+gnLLC4Q3cPKwg+iTW4/FADR8W9DRUF0WttlKRBdvqBeBUTraT1y
B9FucVcOcgNpu6CA0yA6zFvOggdIz6tWtALRD2aHqfICaY+AcxogulsyVg9E
78lQMgTRFXMZFoHop1I+i0G0bX7XKhAt5HEATLPsv+/HB6RPVXoFg2gZ7i9R
ILpPQTUWRK/1PZoBot/d1sgB0QCfkKfO
  "],
 CellLabel->"In[98]:=",ExpressionUUID->"aa48370c-b1f3-45e9-93f1-6bea6b6796e4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "plot", " ", "dIS", " ", "for", " ", "different", " ", "pump", " ", 
     RowBox[{"phases", " ", "--"}]}], ">", " ", 
    RowBox[{"show", " ", "smooth", " ", "transition", " ", 
     RowBox[{"(", 
      RowBox[{"and", " ", 
       RowBox[{"don", "'"}], "t", " ", "use", " ", 
       RowBox[{"sing", ".", " ", "threshold"}]}], ")"}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"pumpPhase0", "=", 
       RowBox[{"\[Pi]", "/", "2"}]}], ",", 
      RowBox[{"Tla", "=", "0.7"}], ",", 
      RowBox[{"Tlb0", "=", "0.05"}], ",", 
      RowBox[{"\[Gamma]btot", "=", 
       RowBox[{"\[Gamma]btotFn", "[", "Tlb0", "]"}]}], ",", 
      RowBox[{"Rpd0", "=", "0.05"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Chi]Thr", "=", 
      RowBox[{"\[Chi]PoleThresh", "[", 
       RowBox[{
        RowBox[{"\[Gamma]aFn", "[", "Tla", "]"}], ",", "\[Gamma]btot"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Chi]Ratio0", "=", "0.7"}], ";", "\[IndentingNewLine]", 
     RowBox[{"phaseList", "=", 
      RowBox[{"Subdivide", "[", 
       RowBox[{
        FractionBox["\[Pi]", "2"], ",", 
        RowBox[{"3", 
         FractionBox["\[Pi]", "2"]}], ",", "16"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"plotQNBothQuads", "[", 
      RowBox[{
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\[Chi]Ratio0", " ", "\[Chi]Thr"}], ",", 
           RowBox[{"phaseList", "[", 
            RowBox[{"[", "j", "]"}], "]"}], ",", "Tla", ",", "Tlb0", ",", 
           "Rpd0", ",", "False"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", 
           RowBox[{"Length", "[", "phaseList", "]"}]}], "}"}]}], "]"}], ",", 
       "None", ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Blend", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Cyan", ",", "Magenta"}], "}"}], ",", 
           FractionBox[
            RowBox[{"i", "-", "1"}], 
            RowBox[{"Length", "[", "phaseList", "]"}]]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "phaseList", "]"}]}], "}"}]}], "]"}]}], 
      "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8382548888011417`*^9, 3.8382549266145697`*^9}, {
   3.838326248653496*^9, 3.838326324400138*^9}, {3.838326398830515*^9, 
   3.838326583803648*^9}, {3.8383270575585814`*^9, 3.838327184509542*^9}, {
   3.838327280997508*^9, 3.838327281520465*^9}, 3.838327366924684*^9, {
   3.838851595445065*^9, 3.838851595636232*^9}},
 CellLabel->"In[99]:=",ExpressionUUID->"559f5fa4-7725-44ab-a95c-d9ccf93ff9cf"]
},
WindowSize->{1853, 1025},
WindowMargins->{{Automatic, 0}, {0, Automatic}},
Magnification:>1.25 Inherited,
FrontEndVersion->"11.3 for Linux x86 (64-bit) (March 6, 2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 400, 8, 73, "Text",ExpressionUUID->"45536b2d-a4a5-4af5-902b-e0c4b447a39d"],
Cell[961, 30, 12022, 333, 1117, "Input",ExpressionUUID->"82ed1d9d-d455-44d6-abc1-1f61ee2e60e3"],
Cell[12986, 365, 2709, 68, 479, "Input",ExpressionUUID->"d7fd8a80-29e1-4f12-a9c5-5b0bee0a510a"],
Cell[15698, 435, 381, 10, 89, "Input",ExpressionUUID->"e2e25cae-7390-49f8-96ee-d23eff51a728"],
Cell[16082, 447, 2893, 69, 276, "Input",ExpressionUUID->"30f0d068-9672-4682-bcd1-c84a629aa724"],
Cell[18978, 518, 4635, 113, 882, "Input",ExpressionUUID->"6fe9231a-e423-450e-8ffd-ff95966f8692"],
Cell[23616, 633, 851, 17, 143, "Input",ExpressionUUID->"5482d970-0109-4d15-a2e8-9b7c4ce43fb5"],
Cell[24470, 652, 9138, 220, 562, "Input",ExpressionUUID->"d30fd5b1-af48-46e9-b26a-c7264abd19fc"],
Cell[33611, 874, 3713, 91, 898, "Input",ExpressionUUID->"fdabf410-0428-4cce-a6cb-ac8c28bc1b8d"],
Cell[37327, 967, 796, 20, 162, "Input",ExpressionUUID->"1d4ae29c-e9e3-4dfe-9c0f-df988ab62690"],
Cell[38126, 989, 2262, 61, 526, "Input",ExpressionUUID->"f55820aa-1de0-499e-b921-88ea8750a664"],
Cell[40391, 1052, 288, 4, 93, "Input",ExpressionUUID->"d0adf565-d976-40fa-b655-c2deb818e844"],
Cell[40682, 1058, 1848, 45, 289, "Input",ExpressionUUID->"20c17d5d-017a-45e0-b2cb-6145e70ebeb6"],
Cell[42533, 1105, 2293, 65, 154, "Input",ExpressionUUID->"930bcdd5-ab40-4c38-944e-35a1c6d0b402"],
Cell[44829, 1172, 1442, 38, 198, "Input",ExpressionUUID->"583a91ae-a40d-4796-a20d-cee0fef41511"],
Cell[46274, 1212, 618, 16, 92, "Input",ExpressionUUID->"b14c732f-bda2-4ada-aae6-280e1d5a1e77"],
Cell[46895, 1230, 296, 6, 60, "Input",ExpressionUUID->"7fc8280b-1778-4d20-a76a-42a8937db155"],
Cell[47194, 1238, 4576, 115, 520, "Input",ExpressionUUID->"a1110fe6-91ae-4338-b631-716e6843dd56"],
Cell[51773, 1355, 23279, 573, 6334, "Input",ExpressionUUID->"94b11244-9d7b-4b12-851c-5b6b0612a1b4"],
Cell[75055, 1930, 70226, 1702, 7551, "Input",ExpressionUUID->"24ec3452-d741-4903-8b5e-76bca56bbc49"],
Cell[145284, 3634, 5467, 135, 1109, "Input",ExpressionUUID->"97dc3119-6eb9-42ff-9ea4-9a1596ad24ab"],
Cell[150754, 3771, 2983, 76, 439, "Input",ExpressionUUID->"7bfe8f5d-81f6-44e7-8f03-898870ed5173"],
Cell[153740, 3849, 11698, 302, 1437, "Input",ExpressionUUID->"834a7529-b9e8-4cc9-a3e5-7ff553ab9071"],
Cell[165441, 4153, 2882, 60, 550, "Input",ExpressionUUID->"a9a989a0-b460-4b7c-96e2-01a888d8e486"],
Cell[168326, 4215, 2629, 63, 334, "Input",ExpressionUUID->"0d0f05aa-61c9-4bc1-ba55-9fac0938c741"],
Cell[170958, 4280, 1987, 52, 379, "Input",ExpressionUUID->"9d112f36-fbdd-43f7-917c-4a18d8cae72f"],
Cell[172948, 4334, 3190, 68, 3859, "Input",ExpressionUUID->"9dbb8255-bdd3-4fa8-bca6-029e1564df3f"],
Cell[176141, 4404, 641, 14, 634, "Input",ExpressionUUID->"08cf331e-0caa-4217-95af-ee723b93c1b8"],
Cell[176785, 4420, 2333, 46, 1718, "Input",ExpressionUUID->"6f89864b-cc61-4a72-b3fa-48050eeeb5a7"],
Cell[179121, 4468, 14031, 345, 10679, "Input",ExpressionUUID->"74395ae9-21ab-4be4-95b6-12d3b7df7666"],
Cell[193155, 4815, 1476, 33, 1112, "Input",ExpressionUUID->"24d54f1a-861b-467f-b5a7-0ab8f2298c59"],
Cell[194634, 4850, 692, 18, 543, "Input",ExpressionUUID->"9079f3e8-8099-4cd2-b41c-59589d10a5c2"],
Cell[195329, 4870, 23810, 560, 17567, "Input",ExpressionUUID->"0965fdd5-b70c-4675-b9cb-c0cff4c32991"],
Cell[219142, 5432, 1601, 31, 1420, "Input",ExpressionUUID->"81e9c8c9-35c9-4f6d-ab57-d6b989687d0f"],
Cell[220746, 5465, 1016, 24, 1250, "Input",ExpressionUUID->"1b2560e4-7c18-44c9-afcd-9de170fd4c2a"],
Cell[221765, 5491, 19249, 498, 12231, "Input",ExpressionUUID->"e4268e3c-0d81-4e34-bc2f-f4a464396739"],
Cell[241017, 5991, 18497, 434, 12071, "Input",ExpressionUUID->"ff9c8117-718f-4a15-8210-6fbea6595796"],
Cell[259517, 6427, 20623, 486, 46489, "Input",ExpressionUUID->"4833e406-b3f7-4ca9-b9f2-c0eb49e87a4b"],
Cell[280143, 6915, 5136, 129, 16785, "Input",ExpressionUUID->"b902bb6f-5b27-4479-acb7-ac46575451a1"],
Cell[285282, 7046, 3671, 92, 44090, "Input",ExpressionUUID->"aa48370c-b1f3-45e9-93f1-6bea6b6796e4"],
Cell[288956, 7140, 2830, 70, 42696, "Input",ExpressionUUID->"559f5fa4-7725-44ab-a95c-d9ccf93ff9cf"]
}
]
*)

