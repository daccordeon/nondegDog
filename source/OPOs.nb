(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    195203,       5108]
NotebookOptionsPosition[    190215,       5038]
NotebookOutlinePosition[    190583,       5054]
CellTagsIndexPosition[    190540,       5051]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell["\<\
James Gardner
Working from Yap thesis, 2020
Deriving eq. 7.12 from eq. 7.8 and eq. 7.17 from 7.16.\
\>", "Text",
 CellChangeTimes->{{3.8226797038197737`*^9, 3.822679706522724*^9}, {
  3.822679745530943*^9, 3.8226798004321527`*^9}, {3.822684345497816*^9, 
  3.822684368206997*^9}},ExpressionUUID->"a05200c5-c521-4b6e-b424-\
86e07dabe570"],

Cell[TextData[{
 "Watch out, Yap thesis uses ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["X", "2"], "=", 
    RowBox[{"-", 
     RowBox[{"i", "(", 
      RowBox[{"a", "+", 
       RowBox[{"a", "\[ConjugateTranspose]"}]}], ")"}]}]}], TraditionalForm]],
  ExpressionUUID->"271c34ff-0824-4cdc-8ba3-3846c0f32ff6"],
 " which gives a different sign in the 2nd and 4th rows of \[CapitalGamma]"
}], "Text",
 CellChangeTimes->{{3.834451710671981*^9, 
  3.834451785840048*^9}},ExpressionUUID->"ca20a264-25e2-4796-9056-\
19bee610b50e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "I", " ", "is", " ", "reserved", " ", "for", " ", "\[ImaginaryI]"}], ",", 
    " ", 
    RowBox[{
    "be", " ", "careful", " ", "not", " ", "to", " ", "confuse", " ", "I", 
     " ", "and", " ", 
     RowBox[{"Id", "!"}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Id", "=", 
     RowBox[{"IdentityMatrix", "[", "4", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"eq", ".", " ", "7.6"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"M", "=", 
     RowBox[{"\[Kappa]a", 
      RowBox[{"(", GridBox[{
         {
          RowBox[{"-", "1"}], "0", "0", 
          RowBox[{"x", " ", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"\[ImaginaryI]", " ", "\[Theta]b"}]]}]},
         {"0", 
          RowBox[{"-", "1"}], 
          RowBox[{"x", " ", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{
             RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Theta]b"}]]}], "0"},
         {"0", 
          RowBox[{"x", " ", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"\[ImaginaryI]", " ", "\[Theta]b"}]]}], 
          RowBox[{"-", "1"}], "0"},
         {
          RowBox[{"x", " ", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{
             RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Theta]b"}]]}], "0", "0", 
          
          RowBox[{"-", "1"}]}
        }], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"eq", " ", "7.11"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[CapitalGamma]", "=", 
     RowBox[{"(", GridBox[{
        {"1", "1", "0", "0"},
        {
         RowBox[{"-", "\[ImaginaryI]"}], "\[ImaginaryI]", "0", "0"},
        {"0", "0", "1", "1"},
        {"0", "0", 
         RowBox[{"-", "\[ImaginaryI]"}], "\[ImaginaryI]"}
       }], ")"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Xfin", "=", 
     RowBox[{"(", GridBox[{
        {"Xfins1"},
        {"Xfins2"},
        {"Xfini1"},
        {"Xfini2"}
       }], ")"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Xlin", "=", 
     RowBox[{"(", GridBox[{
        {"Xlins1"},
        {"Xlins2"},
        {"Xlini1"},
        {"Xlini2"}
       }], ")"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.8225998302323427`*^9, 3.822599840400818*^9}, {
  3.822599884048806*^9, 3.822599959576777*^9}, {3.8226001256082478`*^9, 
  3.822600249764122*^9}, {3.822683060551339*^9, 3.822683081260954*^9}, {
  3.8226842348802567`*^9, 3.822684250189427*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"42d83666-4f6c-4e2b-990a-a38e3d9a22ec"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"eqs", ".", " ", "7.9"}], ",", " ", "7.10"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"T", " ", "=", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{
       RowBox[{"2", "\[Kappa]af", " ", 
        RowBox[{"\[CapitalGamma]", ".", 
         RowBox[{"Inverse", "[", 
          RowBox[{
           RowBox[{"\[ImaginaryI]", " ", "\[Omega]", " ", "Id"}], "-", "M"}], 
          "]"}], ".", 
         RowBox[{"Inverse", "[", "\[CapitalGamma]", "]"}]}]}], "-", "Id"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Tl", " ", "=", " ", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{"2", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"\[Kappa]af", " ", "\[Kappa]al"}], ")"}], 
        RowBox[{"1", "/", "2"}]], 
       RowBox[{"\[CapitalGamma]", ".", " ", 
        RowBox[{"Inverse", "[", 
         RowBox[{
          RowBox[{"\[ImaginaryI]", " ", "\[Omega]", " ", "Id"}], "-", "M"}], 
         "]"}], ".", 
        RowBox[{"Inverse", "[", "\[CapitalGamma]", "]"}]}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.822680977897625*^9, 3.82268101078553*^9}, {
   3.822683043681621*^9, 3.822683053149667*^9}, 3.822683437488249*^9},
 CellLabel->"In[6]:=",ExpressionUUID->"7b8d66d9-74b8-4ae3-8d54-04d1f52a2d1b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Xfout", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"T", ".", "Xfin"}], "+", 
     RowBox[{"Tl", ".", "Xlin"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Xfout", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.8225999637524*^9, 3.8226000963480873`*^9}, {
   3.822600393237418*^9, 3.822600432692031*^9}, {3.822605096211028*^9, 
   3.82260510210367*^9}, {3.8226057543236113`*^9, 3.822605757603195*^9}, 
   3.82268097646586*^9, {3.822681014791987*^9, 3.822681020480567*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"ce9cfe77-5588-42f5-86fc-f43f3f3aae83"],

Cell[BoxData[
 RowBox[{"Collect", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Xfout", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{"\[Theta]b", "\[Rule]", "0"}], "}"}]}], ",", 
   RowBox[{"{", 
    RowBox[{
    "Xlins1", ",", "Xlins2", ",", "Xlini1", ",", "Xlini2", ",", "Xfins1", ",",
      "Xfins2", ",", "Xfini1", ",", "Xfini2"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.822600603323969*^9, 3.822600695815763*^9}, {
   3.822600745149304*^9, 3.822600753227276*^9}, {3.822601018707245*^9, 
   3.822601028253872*^9}, 3.8226051377176247`*^9, 3.82260598515656*^9, {
   3.822606022777628*^9, 3.8226060599038057`*^9}, {3.822606339434466*^9, 
   3.822606354442327*^9}, 3.822683603122847*^9, 3.835311313845462*^9},
 CellLabel->"In[10]:=",ExpressionUUID->"b6612c5d-4f15-43b0-bd96-236375be9071"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"the", " ", "variance", " ", "of", " ", 
     RowBox[{"Xfouts1", ":", " ", 
      RowBox[{
      "if", " ", "assuming", " ", "all", " ", "inputs", " ", "are", " ", 
       "vacuum"}]}]}], ",", " ", 
    RowBox[{
     RowBox[{
     "then", " ", "just", " ", "sum", " ", "the", " ", "abs", " ", "sq", " ", 
      "of", " ", "the", " ", "co"}], "-", 
     RowBox[{"efficients", " ", "of", " ", "each", " ", "input", " ", 
      RowBox[{"fluctuation", "."}]}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Vout", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "/", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                SuperscriptBox["x", "2"]}], ")"}], " ", 
              SuperscriptBox["\[Kappa]a", "2"]}], "+", 
             SuperscriptBox["\[Omega]", "2"]}], ")"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "2"}], "  ", "\[Kappa]a", " ", "\[Omega]"}], ")"}], 
           "2"]}], ")"}]}], ")"}], 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "2"}], " ", "x", " ", "\[Kappa]a", " ", 
           "\[Kappa]af"}], ")"}], "2"], "+", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "2"}], " ", "x", " ", "\[Kappa]a", " ", 
           RowBox[{"\[Sqrt]", 
            RowBox[{"(", 
             RowBox[{"\[Kappa]af", " ", "\[Kappa]al"}], ")"}]}]}], ")"}], 
         "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "2"}], " ", "\[Kappa]a", 
           RowBox[{"\[Sqrt]", 
            RowBox[{"(", 
             RowBox[{"\[Kappa]af", " ", "\[Kappa]al"}], ")"}]}]}], ")"}], 
         "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "2"}], " ", 
           RowBox[{"\[Sqrt]", 
            RowBox[{"(", 
             RowBox[{"\[Kappa]af", " ", "\[Kappa]al"}], ")"}]}], "\[Omega]"}],
           ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"\[Kappa]a", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", 
                 SuperscriptBox["x", "2"]}], ")"}], " ", "\[Kappa]a"}], "+", 
              RowBox[{"2", " ", "\[Kappa]af"}]}], ")"}]}], "+", 
           SuperscriptBox["\[Omega]", "2"]}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "2"}], " ", 
           RowBox[{"(", 
            RowBox[{"\[Kappa]a", "-", "\[Kappa]af"}], ")"}], " ", 
           "\[Omega]"}], ")"}], "2"]}], ")"}]}], "/.", 
     RowBox[{"{", 
      RowBox[{"\[Kappa]al", "\[Rule]", 
       RowBox[{"\[Kappa]a", "-", "\[Kappa]af"}]}], "}"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.822602061499239*^9, 3.8226023510262823`*^9}, {
   3.822602405984487*^9, 3.8226024104725323`*^9}, {3.8226034425528173`*^9, 
   3.8226034618208437`*^9}, 3.822605002240943*^9, {3.822606204416477*^9, 
   3.822606204803467*^9}, {3.822678784565789*^9, 3.822679091399884*^9}, {
   3.822679161577652*^9, 3.8226791629691353`*^9}, {3.8226796483378267`*^9, 
   3.8226796868710203`*^9}, {3.822681471788505*^9, 3.8226814719326687`*^9}, {
   3.8226838049271812`*^9, 3.822683915809548*^9}, {3.8226842661448183`*^9, 
   3.8226842897377357`*^9}, {3.835995643660941*^9, 3.8359956438254433`*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"60245e0a-b18c-4dbd-aeb4-35bfcf2d1ace"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"if", " ", "the", " ", "idler", " ", 
      RowBox[{"doesn", "'"}], "t", " ", "recieve", " ", "input", " ", "from", 
      " ", "f"}], "-", "port"}], ",", " ", 
    RowBox[{"then", " ", "turn", " ", "off", " ", "Xfini1"}], ",", 
    RowBox[{"Xfini2", "=", "0"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"VnoIdlerIn", "=", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "/", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", 
                 SuperscriptBox["x", "2"]}], ")"}], " ", 
               SuperscriptBox["\[Kappa]a", "2"]}], "+", 
              SuperscriptBox["\[Omega]", "2"]}], ")"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "2"}], "  ", "\[Kappa]a", " ", "\[Omega]"}], ")"}],
             "2"]}], ")"}]}], ")"}], 
       RowBox[{"(", " ", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "2"}], " ", "x", " ", "\[Kappa]a", " ", 
            RowBox[{"\[Sqrt]", 
             RowBox[{"(", 
              RowBox[{"\[Kappa]af", " ", "\[Kappa]al"}], ")"}]}]}], ")"}], 
          "2"], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "2"}], " ", "\[Kappa]a", 
            RowBox[{"\[Sqrt]", 
             RowBox[{"(", 
              RowBox[{"\[Kappa]af", " ", "\[Kappa]al"}], ")"}]}]}], ")"}], 
          "2"], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "2"}], " ", 
            RowBox[{"\[Sqrt]", 
             RowBox[{"(", 
              RowBox[{"\[Kappa]af", " ", "\[Kappa]al"}], ")"}]}], 
            "\[Omega]"}], ")"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Kappa]a", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", 
                  SuperscriptBox["x", "2"]}], ")"}], " ", "\[Kappa]a"}], "+", 
               
               RowBox[{"2", " ", "\[Kappa]af"}]}], ")"}]}], "+", 
            SuperscriptBox["\[Omega]", "2"]}], ")"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "2"}], " ", 
            RowBox[{"(", 
             RowBox[{"\[Kappa]a", "-", "\[Kappa]af"}], ")"}], " ", 
            "\[Omega]"}], ")"}], "2"]}], ")"}]}], "/.", 
      RowBox[{"{", 
       RowBox[{"\[Kappa]al", "\[Rule]", 
        RowBox[{"\[Kappa]a", "-", "\[Kappa]af"}]}], "}"}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"Simplify", "[", 
    RowBox[{"VnoIdlerIn", "\[Equal]", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"4", " ", 
         SuperscriptBox["x", "2"], " ", 
         SuperscriptBox["\[Kappa]a", "2"], " ", "\[Kappa]af", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", "\[Kappa]a"}], "-", "\[Kappa]af"}], ")"}]}], ")"}], 
       "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             SuperscriptBox["x", "2"]}], ")"}], "2"], " ", 
          SuperscriptBox["\[Kappa]a", "4"]}], "+", 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            SuperscriptBox["x", "2"]}], ")"}], " ", 
          SuperscriptBox["\[Kappa]a", "2"], " ", 
          SuperscriptBox["\[Omega]", "2"]}], "+", 
         SuperscriptBox["\[Omega]", "4"]}], ")"}]}]}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.835995470536811*^9, 3.835995552269*^9}, {
  3.835996440640106*^9, 3.835996468447757*^9}, {3.835996578431603*^9, 
  3.835996580731174*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"9c83c4e5-afbd-4588-a07e-add34736b696"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"for", " ", "reference"}], ",", " ", 
    RowBox[{"the", " ", "desired", " ", "value", " ", "is", " ", 
     RowBox[{"(", 
      RowBox[{"7.12", ",", " ", "7.18"}], ")"}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Goal", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{"1", "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"8", " ", 
          SuperscriptBox["x", "2"], 
          RowBox[{"(", 
           FractionBox["\[Kappa]af", "\[Kappa]a"], ")"}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["x", "4"], "+", 
          RowBox[{"2", 
           SuperscriptBox["x", "2"], 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               FractionBox["\[Omega]", "\[Kappa]a"], ")"}], "2"], "-", "1"}], 
            ")"}]}], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               FractionBox["\[Omega]", "\[Kappa]a"], ")"}], "2"], "+", "1"}], 
            ")"}], "2"]}], ")"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Goal", "\[Equal]", "Vout"}]}]}]], "Input",
 CellChangeTimes->{{3.82268280007688*^9, 3.822682951416771*^9}, {
  3.8226841908327093`*^9, 3.822684227844426*^9}, {3.822684315600874*^9, 
  3.82268432136008*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"3bbf1121-7a7a-465b-a9b8-efd82437aa9a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Attempting", " ", "to", " ", "recover", " ", "7.17"}], ",", " ", 
    
    RowBox[{"the", " ", "covariance", " ", "matrix"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Assumps", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x", ">", "0"}], ",", 
       RowBox[{"\[Kappa]a", ">", "0"}], ",", 
       RowBox[{"\[Kappa]af", ">", "0"}], ",", 
       RowBox[{"\[Kappa]al", ">", "0"}], ",", 
       RowBox[{"\[Theta]b", ">", "0"}], ",", 
       RowBox[{"\[Omega]", ">", "0"}], ",", 
       RowBox[{"\[Kappa]a", "\[GreaterEqual]", "\[Kappa]af"}]}], "}"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"V", " ", "=", " ", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"T", ".", 
           RowBox[{"ConjugateTranspose", "[", "T", "]"}]}], "+", 
          RowBox[{"Tl", ".", 
           RowBox[{"ConjugateTranspose", "[", "Tl", "]"}]}]}], ")"}], "/.", 
        RowBox[{"{", 
         RowBox[{"\[Kappa]al", "\[Rule]", 
          RowBox[{"\[Kappa]a", "-", "\[Kappa]af"}]}], "}"}]}], ",", 
       RowBox[{"Assumptions", "\[Rule]", "Assumps"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"V", "//", "MatrixForm"}]}]}]], "Input",
 CellChangeTimes->{{3.822681036360671*^9, 3.822681048271264*^9}, {
  3.822681085600061*^9, 3.822681085791026*^9}, {3.82268142797054*^9, 
  3.8226815684785*^9}, {3.8226816411537867`*^9, 3.822681697648925*^9}, {
  3.822681733487762*^9, 3.822681770599683*^9}, {3.822682177694689*^9, 
  3.822682185525467*^9}, {3.822682695722245*^9, 3.822682704889517*^9}, {
  3.822682751149374*^9, 3.8226827768436337`*^9}, {3.835311423844221*^9, 
  3.835311424310237*^9}, {3.83531170841926*^9, 3.835311710239997*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"876a3012-4db6-4a05-bd4a-b69a0f88b998"],

Cell[BoxData[
 RowBox[{
  RowBox[{"V", "[", 
   RowBox[{"[", "1", "]"}], "]"}], "[", 
  RowBox[{"[", "1", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.822682454207037*^9, 3.822682457470179*^9}},
 CellLabel->"In[19]:=",ExpressionUUID->"6c2ea06b-f9e4-4101-a6e9-2bed25faaa62"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "the", " ", "diagonal", " ", "elements", " ", "of", " ", "the", " ", 
    "covariance", " ", "matrix", " ", "are", " ", "the", " ", "output", " ", 
    "variances"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"V", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}], " ", "\[Equal]", " ", "Vout", "\[Equal]", 
   "Goal"}]}]], "Input",
 CellChangeTimes->{{3.822682740789555*^9, 3.822682774454265*^9}, {
  3.822684301802327*^9, 3.822684312798724*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"6109cbb5-78f3-42a3-be5f-088eaa742d11"],

Cell["Repeating calculation using other convention for \[CapitalGamma]", \
"Text",
 CellChangeTimes->{{3.834451796860199*^9, 
  3.834451809053789*^9}},ExpressionUUID->"9f769486-c43a-425b-9f57-\
c6852615a46c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[CapitalGamma]sgn", "=", 
   RowBox[{"(", GridBox[{
      {"1", "1", "0", "0"},
      {"\[ImaginaryI]", 
       RowBox[{"-", "\[ImaginaryI]"}], "0", "0"},
      {"0", "0", "1", "1"},
      {"0", "0", "\[ImaginaryI]", 
       RowBox[{"-", "\[ImaginaryI]"}]}
     }], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Tfsgn", " ", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"2", "\[Kappa]af", " ", 
      RowBox[{"\[CapitalGamma]sgn", ".", 
       RowBox[{"Inverse", "[", 
        RowBox[{
         RowBox[{"\[ImaginaryI]", " ", "\[CapitalOmega]", " ", "Id"}], "-", 
         "M"}], "]"}], ".", 
       RowBox[{"Inverse", "[", "\[CapitalGamma]sgn", "]"}]}]}], "-", "Id"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Tlsgn", " ", "=", " ", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{"2", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"\[Kappa]af", " ", "\[Kappa]al"}], ")"}], 
      RowBox[{"1", "/", "2"}]], 
     RowBox[{"\[CapitalGamma]sgn", ".", " ", 
      RowBox[{"Inverse", "[", 
       RowBox[{
        RowBox[{"\[ImaginaryI]", " ", "\[CapitalOmega]", " ", "Id"}], "-", 
        "M"}], "]"}], ".", 
      RowBox[{"Inverse", "[", "\[CapitalGamma]sgn", "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Vsgn", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Tfsgn", ".", 
         RowBox[{"Tfsgn", "\[ConjugateTranspose]"}]}], "+", 
        RowBox[{"Tlsgn", ".", 
         RowBox[{"Tlsgn", "\[ConjugateTranspose]"}]}]}], ")"}], "/.", 
      RowBox[{"{", 
       RowBox[{"\[Kappa]al", "\[Rule]", 
        RowBox[{"\[Kappa]a", "-", "\[Kappa]af"}]}], "}"}]}], ",", 
     RowBox[{"Assumptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"x", ">", "0"}], ",", 
        RowBox[{"\[Theta]b", ">", "0"}], ",", 
        RowBox[{"\[Kappa]af", ">", "0"}], ",", 
        RowBox[{"\[CapitalOmega]", ">", "0"}], ",", 
        RowBox[{"\[Kappa]a", "\[GreaterEqual]", "\[Kappa]af"}]}], "}"}]}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Vsgn", "//", "MatrixForm"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "opposite", " ", "convention", " ", "flips", " ", "the", " ", "sign", " ", 
    "of", " ", "\[Theta]b"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(", 
   RowBox[{"V", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Omega]", "\[Rule]", "\[CapitalOmega]"}], ",", 
      RowBox[{"\[Theta]b", "\[Rule]", 
       RowBox[{"-", "\[Theta]b"}]}]}], "}"}]}], ")"}], "\[Equal]", 
  "Vsgn"}]}], "Input",
 CellChangeTimes->{{3.834451812295288*^9, 3.834451837046207*^9}, {
   3.834451923830192*^9, 3.834452032172666*^9}, {3.8344520789479837`*^9, 
   3.834452093742694*^9}, {3.834452185775103*^9, 3.834452192153179*^9}, {
   3.834452478270042*^9, 3.834452483217395*^9}, {3.834452529001001*^9, 
   3.834452620112172*^9}, {3.834452651834365*^9, 3.834452670216186*^9}, {
   3.8344527489506817`*^9, 3.8344527742777233`*^9}, {3.835311433501525*^9, 
   3.8353114342305527`*^9}, {3.835311493641423*^9, 3.835311498876031*^9}, {
   3.835311726441742*^9, 3.835311743585685*^9}, 3.835311837790333*^9},
 CellLabel->"In[21]:=",ExpressionUUID->"baf790ca-fe34-42d6-97bb-71db0f768986"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SetDirectory", "[", 
    RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"print", " ", "the", " ", "notebook", " ", "to", " ", 
     RowBox[{"a", " ", ".", "pdf"}]}], ",", " ", 
    RowBox[{
    "the", " ", "notebook", " ", "needs", " ", "to", " ", "be", " ", "saved", 
     " ", "for", " ", "this", " ", "to", " ", "function"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"NotebookPrint", "[", 
  RowBox[{
   RowBox[{"EvaluationNotebook", "[", "]"}], ",", 
   RowBox[{
    RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
    "\"\<NOPO_matrices.pdf\>\""}]}], "]"}]}], "Input",
 CellLabel->"In[27]:=",ExpressionUUID->"524336a8-c033-4272-a92d-2bb29f74dd17"],

Cell["\<\
Plotting the (co)variances from degenerate and nondegenerate OPO\
\[CloseCurlyQuote]s against frequency\
\>", "Text",
 CellChangeTimes->{{3.83469099403804*^9, 3.83469101769831*^9}, {
  3.838240022803321*^9, 
  3.83824002470576*^9}},ExpressionUUID->"8e3464c1-b9c0-4855-ab8e-\
d6e4dec1a3d3"],

Cell[BoxData[
 RowBox[{
  GraphicsBox[
   TagBox[RasterBox[CompressedData["
1:eJztnQVsFMEax3F3d3i4uwUJboFSUihQIEihJTiBhzwIUtwhQIDiToMTPDiB
4MHdiktw93n8h2y5trvt7nG3t3f3/yWD3M7tzd3Mfjv76X8C+/gFx4sTJ07/
JL//8Os0qFa/fp3+1zzN7//49+7frWvvoC6Nev83qGtQv8qB8X+/2OB3Gx43
TpwEv/8WhBBCCCGEWJBfv365egiEEEJMxM/PTxQpUkTUqFHDtPb161dXf21C
CPFKrly5IlKkSCFWrFghtmzZYlr7+fOnq786IYR4Je3atRP9+vVz9TAIIYSY
wO3bt0Xy5MnFo0ePXD0UQixNeHi4WL9+vauHQZyIt8xxcHCw6Natm+bx+fPn
S71/6tSpRYIECWTLlCmTKFasmChRooQoVKiQKFCggKhVq5aYNGmSePPmjYmj
J8T5PH78WEybNk2kSZNG1K1b19XDIU7Am+b44cOHcq9/9+7dWPvu27dPwD0d
doB3795FOvblyxexdetWkTt3bnl/OHbsmJNGTIh5DBgwQBQsWFD4+/uLIUOG
yPXv6TLB2/DGOe7Tp4/o2LGjrr5TpkyRv0mTJk00+5w5c0b2wT3z9evXjhom
IS7n9OnTXiETvBlvmOPnz5/Lvfu1a9d09Ye8x28C+a8F9v3og+YNOjLiPXiD
TPB2vGGOBw8eLFq3bq2r748fP6T+Br8Jfhstzp8/HyH3ly5d6qihEuJyvEEm
eDuePsfQwUCOX7hwQVd/5fdIlSqVvAdoMX36dNkvWbJk4tmzZ44aLiEux9Nl
AvH8OQ4JCRG+vr66++vR7eNekjNnTunvAxsvIZ6Ep8sE4tlz/P79e5E+fXpx
8uRJ3e+JTbd/6dIlUaFCBenPs337dkcNlRDL4MkygfzBHef48+fPuvrBx75+
/fq6z2ur258wYYLYtm2bbOvWrRMzZ84ULVu2lLl2ZsyYIT59+mTv8AmxNO4o
E4gx3GmO4ZcDOe7j4xNrX9wbsmTJIg4fPqz7/MpvAd/MXbt2RbQ1a9aIvn37
irRp04rJkyeL79+/x3qu8ePHi8WLF+v+bEKsgjvJBGIf/zrH2PciJsqeZsQe
CvndqlUrkSRJEhE3blypb4mJ2bNni+rVqxv6Lopuv2nTpqrHV61aJY/36NEj
xvPguSFr1qwyJo4Qd4Ny3/P51zkOCgqS+2N7WsaMGcWDBw9i/Qzkyw8NDZXy
FJ+H8QYGBmr2//btm8iVK5fYvXu3oe+i6PanTp2qevzDhw/yeOLEiZlXmXgs
lPuej7vNMWKvsN+H7H3y5Ilqn0WLFknbqxGQJ1nR7SMWVw3kcFZ89pnbjXgq
7iYTiHHccY6hh8GYhw4dGu0YngmQO23z5s2Gzqn8DpD9WrnyV65cGSH3tfb7
x48fF8uWLRNv37419PmEWAV3lAnEGO44x9D1Y8zp0qUTHz9+jHRs9erVMnem
0VqKevz2+/fvL/vAvqsGfH7mzp0rbbrlypUz9PmEWIVTp07JdV6nTh1XD4U4
CXed40qVKslxw36rAFlfvHhxERYWZvh8enLywJcIfQoXLhzpdcTuvnr1SuaD
AMh1lyNHDsNjIMQKYO+krHNn+CsjtxX0pIihv3r1qsPPT2LH2XPsLOBTj3Hn
y5cvQi+zadMmqeMxWtMQfkXI24bzHThwQLMfcvygT9myZSNeg15n2LBh8u+b
N2/K1/Lnzx9jnn9CrMa8efPkczLiHFOmTCmfpeF7gesiT548okyZMg7xZYC8
x2co+lK9ebMcgbfX1zBrjp0JZHvevHnl2tmwYYN8rXz58mLJkiW6z9GmTRv5
ffEbQHeD9ZAtWzZRsmRJMWfOnGj9sT/Jnj27/J3gh7p37155DsQFKxw8eFCO
CfcBQog6iq7WTLmvwPoa7g10PJi/KlWqSJ9NzBV8OJ3Jy5cv5b4BNXrhzx/V
voD6vdhTEEK0QQymq+Q+62u4N5C5yjMjZL7aHt1M4MOTNGlSmeMBQN8fU05P
QryVFy9euEzus76G+wPdOuYG8bGYK1eyf/9+ORb4+d+5c0fW+CKERMdVcp/1
NTwD2GSRu8EKORHg0wN/ItiEevbsGU13SAj5g6vkvhXqa0BXjDxfsA126NBB
LFiwQLesQAwR+cPFixd15UozC604YvJv4PrQWvc3btyQuVOj2luINVGT+5B9
mONx48ZJ+xnyIYLw8HAxevRomRcLuhk8T9uLq+trHDlyRGTOnFnuVeE/Av8h
5B9ADsnly5fHGncEnxtCvAXYAePHjx8tZ96tW7dEp06dpE8armfs04j1UZP7
eA26UcQ84hhy4CLufsCAAdL/E3rcsWPHikSJEkmfHHtwZX0N2P9wP8H3sbUV
379/X97TsL6rVq0qdUxq4L7QsGFDh46JECujxGtAh6YA/13YdxB30r59e7l/
un37tsM+89ChQyIgIEDKJnvboEGDHDYeTyImPQ9ycOGYn5+fjIG0BboZ+Fwb
zbWrvNeV9TXwOdijaAF5j+8F+Y/8k/AJR95K+IT36tVL6py0cocR4olgP6TE
ReD6HTFihNz/GMFoTQRcc8jxt3DhQrsb6jeQ6MQk9xEbg2PY19vGxihA1wHf
e6O4ur7GyJEjxZ49e2Ltt2LFCvlcoNiV0RA3hHsUId4EYipxrWNPhL3P5cuX
Db3fXWoimFXPwtXokfuYczUqV64s4sWLZ/gzXV1f4969e7r9uhGXevToUTkm
xI7prTFIiKegxPjgORf5t7t27SprJEAPYzQnh9VxRj0L3CebN29uSoPuWg96
5H6DBg1U3wu5j+NG/batUl8DsaXIKTN8+HBpr4b/t948kuhrhB07dpg292zR
m7PjiD2ZtWvXyutx4sSJ8nqEPwf0scitUrp0aU07GPkD4o6grzKjbdmyRdeY
9Mh9LRumPXLfKvU1kIcOOXIUX1LcY/DvUqVKSV+f2DBaVwTfyay5Z4veGLdr
P927d5fXxokTJyK9jmsIr1erVi3G99tbEwHyAf6E0P3a26yuV3IVZst9K9TX
wHgR3wP7sZKHFPt8yPvGjRtLf074Jzx9+lT1/bAN2GPPJsQdKVq0qGacDfw3
bfNi49lg586dEf//l5oIsCGEhIRIe5y9Dfd8Eh2z5b4V6mvgWQi2BS2dDuy2
yC+MexNiGGAPALgPQDeF/JFGa8cS4o7AVolrEfuhqMAGimO+vr4Rr7Vo0SIi
9pE1EayL2XLfCvU1Ro0aFaseDPZb7BeQ5wtjQeyYYttydf4xQsxC0e1rXa/I
y9elSxf577t374revXtHHGNNBOuC+CjMa+3ataMdU3QytnUuFGzzrz9+/FjX
Z1mlvsa5c+d0++XgPgN9Ep43oX/CvZAQb2HMmDFS74m4XDVwbSDWHb7ybdu2
Vc2Zy5oI1gH20oIFC8r7NfQp0N9h7xwcHCzv25hL22PwW0duc4BnPvhPQg+C
48htAB2gVp5k1tcgxD2B/ezs2bMx9oHvInyctWznrIkQGfh4oD4RdMjwJ+Re
8i+sr0GI+8OaCH/BvhWxD4GBgTJGFXbKmjVryrjYgQMHSv91og3XEiHuAWsi
/MXf3z9arjHoy5EzBr8RbOJEG64lQtwD1kT4A3xbsc9XA741yZMnlzINdnSi
DtcSIe6Ft9dEQP4EyHUfHx/V4/Xq1ZPHkSeCxIy3ryVCiHvQuXNnKdeR41ct
ZwieBXAcvvGEEELcn+vXr8uafsjxq0ajRo2k3IcNICqwZyJHQFhYmGZDLQTq
Pci/wrVGiDkg7hU+85D7yENgC/LTw/fdNhe8VkNdEULshWuNEPNYunSpvJZg
s7StOYL40ly5csnccsgFjxhb+APh2QD/tm1KLhlC7IFrjRDzQM4v5O3PkCFD
pFo2sAEg9yNiaG2ZNWuWzEtGiKPgWiPEXLCfQv6CqDnpEQONPVhU6taty5yQ
xKFwrRFiHqglixw3seXBUHjz5o1ImDChrH9GiDPhWiPE8cAvAvnREHeqF+R2
QL1vQpwN1xohjgX5BipWrKi6lwoNDdV8X0BAgGjWrJkzh0aIhGuNEMeBWsR1
6tSROQeiAj0r8g6rAdsbarejdgghzoRrjRDHER4eLmuToQ4JfPaVhrplyD+M
vDOod6AGctHD1xO1AAlxJlxrhDgGyHXUD4wtHmbjxo2q70cdMyM1rgixF641
QhwDalHqiYO8evWq6vthD0B9QUKcDdcaIdbgxo0bjJMkpsC1RgghhBBCCCGE
EEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEI8gf8DDfFvug==
     "], {{0, 71}, {
     382, 0}}, {0, 255},
     ColorFunction->RGBColor],
    BoxForm`ImageTag["Byte", ColorSpace -> "RGB", Interleaving -> True],
    Selectable->False],
   DefaultBaseStyle->"ImageGraphics",
   ImageSize->{374.6666666666663, Automatic},
   ImageSizeRaw->{382, 71},
   PlotRange->{{0, 382}, {0, 71}}], ";"}]], "Input",
 CellChangeTimes->{{3.834694895943326*^9, 3.834694897665792*^9}, {
   3.834696764936166*^9, 3.834696766326467*^9}, 3.835747174513823*^9},
 CellLabel->"In[29]:=",ExpressionUUID->"a87c3ed5-bcdb-4424-adc8-8c7944ecb967"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"above", ":", " ", 
    RowBox[{"eq3", ".5", " ", "from", " ", "Min", " ", 
     RowBox[{"Jet", "'"}], "s", " ", "thesis"}]}], ",", " ", 
   RowBox[{
   "the", " ", "\[Kappa]", " ", "formula", " ", "is", " ", "only", " ", "an", 
    " ", 
    RowBox[{"approximation", "?"}]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.8346949005009317`*^9, 3.8346949286655397`*^9}},
 CellLabel->"In[30]:=",ExpressionUUID->"367c6a75-dff7-4d73-acfc-4b4ec1008503"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"degenerate", " ", "OPO"}], ",", " ", 
    RowBox[{"using", " ", "values", " ", "from", " ", "Sheon", " ", 
     RowBox[{"Chua", "'"}], "s", " ", "thesis"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"c", "=", 
     RowBox[{"3", " ", 
      SuperscriptBox["10", "8"]}]}], 
    RowBox[{"(*", 
     RowBox[{"m", " ", 
      SuperscriptBox["s", 
       RowBox[{"-", "1"}]]}], "*)"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"L", " ", "=", "1"}], 
    RowBox[{"(*", "m", "*)"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tRoundTrip", "=", 
     FractionBox[
      RowBox[{"2", "L"}], "c"]}], 
    RowBox[{"(*", 
     RowBox[{"=", 
      FractionBox["1", "FSR"]}], "*)"}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"assumes", " ", "linear", " ", "cavity"}], ",", " ", 
     RowBox[{
     "unclear", " ", "if", " ", "factor", " ", "of", " ", "2", " ", "req"}]}],
     "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Tout", "=", "0.1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"kout", "=", 
     RowBox[{
      FractionBox[
       RowBox[{"-", "1"}], 
       RowBox[{"2", " ", "tRoundTrip"}]], 
      RowBox[{"Log", "[", 
       RowBox[{"1", "-", "Tout"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"x", "=", "0.45"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"degenV1", "[", 
     RowBox[{"w_", ",", "Tin_", ",", "Tloss_"}], "]"}], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"kin", "=", 
       RowBox[{
        FractionBox[
         RowBox[{"-", "1"}], 
         RowBox[{"2", " ", "tRoundTrip"}]], 
        RowBox[{"Log", "[", 
         RowBox[{"1", "-", "Tin"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"kloss", "=", 
       RowBox[{
        FractionBox[
         RowBox[{"-", "1"}], 
         RowBox[{"2", " ", "tRoundTrip"}]], 
        RowBox[{"Log", "[", 
         RowBox[{"1", "-", "Tloss"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ktot", "=", 
       RowBox[{"kout", "+", "kin", "+", "kloss"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"g", "=", 
       RowBox[{"x", " ", "ktot"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"1", "+", 
       FractionBox[
        RowBox[{"4", " ", "kout", " ", "g"}], 
        RowBox[{
         SuperscriptBox["w", "2"], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"g", "-", "ktot"}], ")"}], "2"]}]]}]}], ")"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"degenV2", "[", 
     RowBox[{"w_", ",", "Tin_", ",", "Tloss_"}], "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"just", " ", "send", " ", "g"}], "\[Rule]", 
       RowBox[{"-", "g"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"kin", "=", 
       RowBox[{
        FractionBox[
         RowBox[{"-", "1"}], 
         RowBox[{"2", " ", "tRoundTrip"}]], 
        RowBox[{"Log", "[", 
         RowBox[{"1", "-", "Tin"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"kloss", "=", 
       RowBox[{
        FractionBox[
         RowBox[{"-", "1"}], 
         RowBox[{"2", " ", "tRoundTrip"}]], 
        RowBox[{"Log", "[", 
         RowBox[{"1", "-", "Tloss"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ktot", "=", 
       RowBox[{"kout", "+", "kin", "+", "kloss"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"g", "=", 
       RowBox[{"x", " ", "ktot"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"1", "-", 
       FractionBox[
        RowBox[{"4", " ", "kout", " ", "g"}], 
        RowBox[{
         SuperscriptBox["w", "2"], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"g", "+", "ktot"}], ")"}], "2"]}]]}]}], ")"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"\[Lambda]", "=", 
       RowBox[{
        RowBox[{"1", "\[Mu]m"}], "=", 
        RowBox[{
         SuperscriptBox["10", 
          RowBox[{"-", "6"}]], "m"}]}]}], ",", " ", 
      RowBox[{
      "want", " ", "to", " ", "consider", " ", "sidebands", " ", "of", " ", 
       "carrier"}], ",", " ", 
      RowBox[{
       RowBox[{
       "so", " ", "look", " ", "at", " ", "frequencies", " ", "around", " ", 
        "w"}], "=", 
       RowBox[{"2", "\[Pi]", 
        FractionBox["c", "\[Lambda]"]}]}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"because", " ", "of", " ", "rotating", " ", "frame"}], ",", " ", 
      RowBox[{
       RowBox[{"aren", "'"}], "t", " ", "all", " ", "frequencies", " ", 
       "already", " ", "relative", " ", "to", " ", 
       RowBox[{
        FractionBox["\[Omega]", "2"], "?"}]}]}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"lambda", "=", 
      SuperscriptBox["10", 
       RowBox[{"-", "6"}]]}], 
     RowBox[{"(*", "m", "*)"}], ";", "\[IndentingNewLine]", 
     RowBox[{"wCarrier", "=", 
      RowBox[{"N", "[", 
       RowBox[{"2", "\[Pi]", 
        FractionBox["c", "lambda"]}], "]"}]}], ";"}], 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"~", "1.9"}], "*", 
      SuperscriptBox["10", "15"], "Hz"}], "*)"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Labeled", "[", 
     RowBox[{
      RowBox[{"LogLogPlot", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", 
          RowBox[{"degenV1", "[", 
           RowBox[{"w", ",", 
            RowBox[{"Tin", "=", "0"}], ",", 
            RowBox[{"Tloss", "=", "0"}]}], "]"}], ",", 
          RowBox[{"degenV1", "[", 
           RowBox[{"w", ",", 
            RowBox[{"Tin", "=", "0.01"}], ",", 
            RowBox[{"Tloss", "=", "0.1"}]}], "]"}], ",", 
          RowBox[{"degenV2", "[", 
           RowBox[{"w", ",", 
            RowBox[{"Tin", "=", "0"}], ",", 
            RowBox[{"Tloss", "=", "0"}]}], "]"}], ",", 
          RowBox[{"degenV2", "[", 
           RowBox[{"w", ",", 
            RowBox[{"Tin", "=", "0.01"}], ",", 
            RowBox[{"Tloss", "=", "0.1"}]}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"w", ",", 
          SuperscriptBox["10", "5"], ",", 
          SuperscriptBox["10", "9"]}], "}"}], ",", 
        RowBox[{"PlotLegends", "\[Rule]", 
         RowBox[{"LineLegend", "[", 
          RowBox[{"\"\<Expressions\>\"", ",", 
           RowBox[{"LabelStyle", "\[Rule]", 
            RowBox[{"Directive", "[", "10", "]"}]}]}], "]"}]}], ",", 
        RowBox[{"PlotLabel", "\[Rule]", "\"\<degenerate OPO\>\""}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Dashed", ",", "Gray"}], "}"}], ",", ",", ",", ","}], 
          "}"}]}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "300"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "\"\<angular frequency / (log scale)\>\"", ",", " ", 
        "\"\<variance / (log scale)\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"Bottom", ",", "Left"}], "}"}], ",", 
      RowBox[{"RotateLabel", "\[Rule]", "True"}], ",", 
      RowBox[{"LabelStyle", "\[Rule]", 
       RowBox[{"Directive", "[", "10", "]"}]}]}], "]"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "plotting", " ", "quantum", " ", "noise", " ", "in", " ", "dB", " ", 
      "is", " ", "a", " ", "matter", " ", 
      RowBox[{"of", ":", " ", 
       RowBox[{
        RowBox[{"(", "1", ")"}], " ", "understanding", " ", "what", " ", 
        "kind", " ", "of", " ", "quantity", " ", "you", " ", "are", " ", 
        "plotting", " ", "and", " ", 
        RowBox[{"(", "2", ")"}], " ", "plotting", " ", "relative", " ", "to", 
        " ", "vacuum"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"e", ".", "g"}], ".1", " ", "for", " ", "variance", " ", 
      "which", " ", "is", " ", "a", " ", "squared", " ", 
      RowBox[{"(", "power", ")"}], " ", "quantity"}], ",", " ", 
     RowBox[{"plot", " ", "10", 
      SubscriptBox["log", "10"], 
      RowBox[{"(", 
       RowBox[{"V", "=", 
        SuperscriptBox["\[Sigma]", "2"]}], ")"}], " ", "since", " ", "vacuum",
       " ", "is", " ", "1"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"e", ".", "g"}], ".2", " ", "for", " ", "shot", " ", "noise", 
      " ", "transfer", " ", "fn"}], ",", " ", 
     RowBox[{"|", "R", "|", " ", 
      RowBox[{"is", " ", "amplitude"}]}], ",", "  ", 
     RowBox[{
      RowBox[{"plot", " ", "20", 
       SubscriptBox["log", "10"], 
       RowBox[{"(", 
        RowBox[{"|", "R", "|"}], ")"}], " ", "since"}], " ", "|", "R", 
      SubscriptBox["|", "vac"], " ", 
      RowBox[{"is", " ", "1"}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{"Labeled", "[", 
     RowBox[{
      RowBox[{"LogLinearPlot", "[", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"10", 
           RowBox[{"Log10", "[", "1", "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"10", 
           RowBox[{"Log10", "[", 
            RowBox[{"degenV1", "[", 
             RowBox[{
              RowBox[{"2", "\[Pi]", " ", "f"}], ",", 
              RowBox[{"Tin", "=", "0"}], ",", 
              RowBox[{"Tloss", "=", "0"}]}], "]"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"10", 
           RowBox[{"Log10", "[", 
            RowBox[{"degenV1", "[", 
             RowBox[{
              RowBox[{"2", "\[Pi]", " ", "f"}], ",", 
              RowBox[{"Tin", "=", "0.1"}], ",", 
              RowBox[{"Tloss", "=", "0.1"}]}], "]"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"10", 
           RowBox[{"Log10", "[", 
            RowBox[{"degenV2", "[", 
             RowBox[{
              RowBox[{"2", "\[Pi]", " ", "f"}], ",", 
              RowBox[{"Tin", "=", "0"}], ",", 
              RowBox[{"Tloss", "=", "0"}]}], "]"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"10", 
           RowBox[{"Log10", "[", 
            RowBox[{"degenV2", "[", 
             RowBox[{
              RowBox[{"2", "\[Pi]", " ", "f"}], ",", 
              RowBox[{"Tin", "=", "0.1"}], ",", 
              RowBox[{"Tloss", "=", "0.1"}]}], "]"}], "]"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"f", ",", 
          SuperscriptBox["10", "5"], ",", 
          SuperscriptBox["10", "9"]}], "}"}], ",", 
        RowBox[{"PlotLegends", "\[Rule]", 
         RowBox[{"LineLegend", "[", 
          RowBox[{"\"\<Expressions\>\"", ",", 
           RowBox[{"LabelStyle", "\[Rule]", 
            RowBox[{"Directive", "[", "10", "]"}]}]}], "]"}]}], ",", 
        RowBox[{"PlotLabel", "\[Rule]", "\"\<degenerate OPO\>\""}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Dashed", ",", "Gray"}], "}"}], ",", ",", ",", ","}], 
          "}"}]}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "300"}], ",", 
        RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "\"\<frequency, f=\!\(\*FractionBox[\(\[CapitalOmega]\), \(2 \
\[Pi]\)]\) / (log scale)\>\"", ",", " ", 
        "\"\<variance / dB (10\!\(\*SubscriptBox[\(log\), \(10\)]\))\>\""}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"Bottom", ",", "Left"}], "}"}], ",", 
      RowBox[{"RotateLabel", "\[Rule]", "True"}], ",", 
      RowBox[{"LabelStyle", "\[Rule]", 
       RowBox[{"Directive", "[", "10", "]"}]}]}], "]"}], 
    "\[IndentingNewLine]", "*)"}]}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJwdzltIU3EABvBT2ENgBdXynHmJkZG56QpCisxt1oMgrPCSQ+acY+n2sGar
hywTOw0zXav06Ch8cCgbKti6OV1QUIsKJ1lWeB0h1QpOXoZWm0Kd7//w8YPv
4eOTGKxFZzZSFCUTAuvfXQsktfEqw/j1MXgrZ2wSauaZGRie9i1Btnw0DtMa
NRQt+Ghv1WaY1yPZAd8cz2VgrPp9FvSWpx6E+iy9Gg5GujQw8DeoheNPOB2U
HS00wpCouQZGqp5ZYDS9wgZ/0NxFqPTMNsCgXHoDquczHbA2eWsntA5U3oOu
TP8nmKjzRCD3wMRDm9O3DNfPd6/CSy9HiXMLq8kMen/KbtjsDNXB5xlNdnib
krbC7XSxE25aX+yAhz6LXfAAo5iFaWsrc7BmS1EM6kRuolH2L1Us2JMdl8Bd
3XcLoInOLoT53juniC6qBNZ/TLBC9nHABocq5A3wtCGfmJiQa4cvTG3Eb162
HR6pbeyC+5R/+mHIMjwAe5/u8UOOeUXs1U69hvtj297CJHZigvy68pX4m/f0
/RLkO+I+aCkTuZewJzYRo2bHiRXBw8a1kzAw8qEUmqkw8WZLQSUcSrERfzoe
GmFUNElUflGcg+zZy8QLnYpBup1XbaiT34fV6VeLj3G8ym5Wl8HveTt1sMUd
1EPtYmvTgmBYukz8D7H+Y+I=
  "],
 CellLabel->"In[31]:=",ExpressionUUID->"6271967f-9ebc-4495-a23a-a5002fd3c14d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"introducing", " ", "PD", " ", "loss", " ", "as", " ", "well"}], 
    ",", " ", 
    RowBox[{
     RowBox[{
      SubscriptBox["R", "PD"], " ", "is", " ", "the", " ", "reflectivity", 
      " ", "of", " ", "the", " ", "lossless", " ", "beam"}], "-", 
     RowBox[{"splitter", " ", "between", " ", 
      RowBox[{"(", "trans", ")"}], " ", "and", " ", 
      RowBox[{"(", "PD", ")"}], " ", "fields"}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"ktotFn", "[", "Tloss_", "]"}], ":=", 
     RowBox[{"kout", "+", 
      RowBox[{
       FractionBox[
        RowBox[{"-", "1"}], 
        RowBox[{"2", " ", "tRoundTrip"}]], 
       RowBox[{"Log", "[", 
        RowBox[{"1", "-", "Tloss"}], "]"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"degenVPDloss", "[", 
     RowBox[{
     "\[CapitalOmega]_", ",", "x_", ",", "Tin_", ",", "Tloss_", ",", "Rpd_", 
      ",", 
      RowBox[{"gsgn_:", "1"}]}], "]"}], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"kin", "=", 
       RowBox[{
        FractionBox[
         RowBox[{"-", "1"}], 
         RowBox[{"2", " ", "tRoundTrip"}]], 
        RowBox[{"Log", "[", 
         RowBox[{"1", "-", "Tin"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"kloss", "=", 
       RowBox[{
        FractionBox[
         RowBox[{"-", "1"}], 
         RowBox[{"2", " ", "tRoundTrip"}]], 
        RowBox[{"Log", "[", 
         RowBox[{"1", "-", "Tloss"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ktot", "=", 
       RowBox[{"kout", "+", "kin", "+", "kloss"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"g", "=", 
       RowBox[{"gsgn", " ", "x", " ", "ktot"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"1", "+", 
       FractionBox[
        RowBox[{"4", " ", "kout", " ", "g", 
         RowBox[{"(", 
          RowBox[{"1", "-", "Rpd"}], ")"}]}], 
        RowBox[{
         SuperscriptBox["\[CapitalOmega]", "2"], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"g", "-", "ktot"}], ")"}], "2"]}]]}]}], ")"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"x0", "=", "0.45"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"LogLinearPlot", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"10", 
        RowBox[{"Log10", "[", "1", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"10", 
        RowBox[{"Log10", "[", 
         RowBox[{"degenVPDloss", "[", 
          RowBox[{
           RowBox[{"2", "\[Pi]", " ", "f"}], ",", "x0", ",", 
           RowBox[{"Tin", "=", "0"}], ",", 
           RowBox[{"Tloss", "=", "0"}], ",", 
           RowBox[{"Rpd", "=", "0"}], ",", 
           RowBox[{"gsgn", "=", "1"}]}], "]"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"10", 
        RowBox[{"Log10", "[", 
         RowBox[{"degenVPDloss", "[", 
          RowBox[{
           RowBox[{"2", "\[Pi]", " ", "f"}], ",", "x0", ",", 
           RowBox[{"Tin", "=", "0"}], ",", 
           RowBox[{"Tloss", "=", "0"}], ",", 
           RowBox[{"Rpd", "=", "0.5"}], ",", 
           RowBox[{"gsgn", "=", "1"}]}], "]"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"10", 
        RowBox[{"Log10", "[", 
         RowBox[{"degenVPDloss", "[", 
          RowBox[{
           RowBox[{"2", "\[Pi]", " ", "f"}], ",", "x0", ",", 
           RowBox[{"Tin", "=", "0.1"}], ",", 
           RowBox[{"Tloss", "=", "0.1"}], ",", 
           RowBox[{"Rpd", "=", "0"}], ",", 
           RowBox[{"gsgn", "=", "1"}]}], "]"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"10", 
        RowBox[{"Log10", "[", 
         RowBox[{"degenVPDloss", "[", 
          RowBox[{
           RowBox[{"2", "\[Pi]", " ", "f"}], ",", "x0", ",", 
           RowBox[{"Tin", "=", "0.1"}], ",", 
           RowBox[{"Tloss", "=", "0.1"}], ",", 
           RowBox[{"Rpd", "=", "0.5"}], ",", 
           RowBox[{"gsgn", "=", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"10", 
        RowBox[{"Log10", "[", 
         RowBox[{"degenVPDloss", "[", 
          RowBox[{
           RowBox[{"2", "\[Pi]", " ", "f"}], ",", "x0", ",", 
           RowBox[{"Tin", "=", "0"}], ",", 
           RowBox[{"Tloss", "=", "0"}], ",", 
           RowBox[{"Rpd", "=", "0"}], ",", 
           RowBox[{"gsgn", "=", 
            RowBox[{"-", "1"}]}]}], "]"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"10", 
        RowBox[{"Log10", "[", 
         RowBox[{"degenVPDloss", "[", 
          RowBox[{
           RowBox[{"2", "\[Pi]", " ", "f"}], ",", "x0", ",", 
           RowBox[{"Tin", "=", "0"}], ",", 
           RowBox[{"Tloss", "=", "0"}], ",", 
           RowBox[{"Rpd", "=", "0.5"}], ",", 
           RowBox[{"gsgn", "=", 
            RowBox[{"-", "1"}]}]}], "]"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"10", 
        RowBox[{"Log10", "[", 
         RowBox[{"degenVPDloss", "[", 
          RowBox[{
           RowBox[{"2", "\[Pi]", " ", "f"}], ",", "x0", ",", 
           RowBox[{"Tin", "=", "0.1"}], ",", 
           RowBox[{"Tloss", "=", "0.1"}], ",", 
           RowBox[{"Rpd", "=", "0"}], ",", 
           RowBox[{"gsgn", "=", 
            RowBox[{"-", "1"}]}]}], "]"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"10", 
        RowBox[{"Log10", "[", 
         RowBox[{"degenVPDloss", "[", 
          RowBox[{
           RowBox[{"2", "\[Pi]", " ", "f"}], ",", "x0", ",", 
           RowBox[{"Tin", "=", "0.1"}], ",", 
           RowBox[{"Tloss", "=", "0.1"}], ",", 
           RowBox[{"Rpd", "=", "0.5"}], ",", 
           RowBox[{"gsgn", "=", 
            RowBox[{"-", "1"}]}]}], "]"}], "]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"f", ",", 
       SuperscriptBox["10", "5"], ",", 
       SuperscriptBox["10", "9"]}], "}"}], ",", 
     RowBox[{"PlotLegends", "\[Rule]", 
      RowBox[{"LineLegend", "[", 
       RowBox[{"\"\<Expressions\>\"", ",", 
        RowBox[{"LabelStyle", "\[Rule]", 
         RowBox[{"Directive", "[", "10", "]"}]}]}], "]"}]}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Dashed", ",", "Gray"}], "}"}], ",", ",", "Dashed", ",", ",",
         "Dashed", ",", ",", "Dashed", ",", ",", "Dashed"}], "}"}]}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "400"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", " ", 
         RowBox[{
         "\"\<variance / dB (10\!\(\*SubscriptBox[\(log\), \(10\)]\))\>\"", 
          ","}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "\"\<frequency, f=\!\(\*FractionBox[\(\[CapitalOmega]\), \(2  \
\[Pi]\)]\) / (log scale)\>\"", ",", 
          RowBox[{"StringForm", "[", 
           RowBox[{
           "\"\<degenerate OPO\\nintracavity and PD loss\\nsqueezing param. \
x=``\>\"", ",", "x0"}], "]"}]}], "}"}]}], "}"}]}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.835217320959587*^9, 3.835217672939373*^9}, {
   3.835217707258046*^9, 3.835217775251295*^9}, {3.835217826701436*^9, 
   3.835217969465468*^9}, {3.83521800272217*^9, 3.835218003099522*^9}, {
   3.8352180662011557`*^9, 3.835218070475966*^9}, 3.83523296949238*^9, {
   3.835301105742421*^9, 3.835301109905553*^9}, {3.835816725252679*^9, 
   3.8358167281186647`*^9}, {3.835919193550868*^9, 3.835919195608033*^9}, {
   3.838239975492674*^9, 3.838240002890079*^9}, {3.8382474574132843`*^9, 
   3.83824748243508*^9}},
 CellLabel->"In[39]:=",ExpressionUUID->"b60d38f1-f753-4f86-ac1c-3ef626e3fc30"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Exp", "[", "logf", "]"}], "/.", 
    RowBox[{
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"10", 
           RowBox[{"Log10", "[", 
            RowBox[{"1", "+", 
             FractionBox[
              RowBox[{"4", " ", "\[Gamma]R", " ", "\[Chi]", 
               RowBox[{"(", 
                RowBox[{"1", "-", "Rpd0"}], ")"}]}], 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"2", "\[Pi]", " ", 
                  RowBox[{"Exp", "[", "logf", "]"}]}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"\[Chi]", "-", "\[Gamma]btot"}], ")"}], "2"]}]]}], 
            "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"logf", ",", "2"}], "}"}]}], "]"}], "\[Equal]", "0"}], ",",
        "logf"}], "]"}], "[", 
     RowBox[{"[", "2", "]"}], "]"}]}], "/.", 
   RowBox[{
    RowBox[{"C", "[", "1", "]"}], "\[Rule]", "0"}]}], "//", 
  "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"loglogConcavf", "[", 
   RowBox[{"x_", ",", "Tloss_", ",", "Rpd_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    FractionBox[
     SqrtBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{"\[Gamma]btot", "-", "\[Chi]"}], ")"}], " ", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["\[Gamma]btot", "2"], "-", 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{"\[Gamma]btot", "+", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "Rpd0"}], ")"}], " ", "\[Gamma]R"}]}],
            ")"}], " ", "\[Chi]"}], "+", 
         SuperscriptBox["\[Chi]", "2"]}]]}]], 
     RowBox[{"2", " ", "\[Pi]"}]], ")"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Gamma]R", "\[Rule]", "kout"}], ",", 
     RowBox[{"\[Chi]", "\[Rule]", 
      RowBox[{"x", " ", 
       RowBox[{"ktotFn", "[", "Tloss", "]"}]}]}], ",", 
     RowBox[{"Rpd0", "\[Rule]", "Rpd"}], ",", 
     RowBox[{"\[Gamma]btot", "\[Rule]", 
      RowBox[{"ktotFn", "[", "Tloss", "]"}]}]}], "}"}]}]}]}], "Input",
 CellChangeTimes->{{3.838252098537269*^9, 3.8382521122200003`*^9}},
 CellLabel->"In[43]:=",ExpressionUUID->"afc73798-ccaf-43e1-8845-509f309880ce"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"degenVPDloss", "[", 
    RowBox[{
    "\[CapitalOmega]_", ",", "x_", ",", "Tin_", ",", "Tloss_", ",", "Rpd_", 
     ",", 
     RowBox[{"gsgn_:", "1"}]}], "]"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Clear", "[", "dOPOchange\[Chi]", "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dOPOchange\[Chi]", "[", 
     RowBox[{"Tloss0_", ",", "Rpd0_", ",", 
      RowBox[{"yesSqz_:", "True"}], ",", 
      RowBox[{"yesAntiSqz_:", "True"}], ",", 
      RowBox[{"yesGridLines_:", "True"}]}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Tin", "=", "0"}], ",", 
        RowBox[{"Tloss", "=", "Tloss0"}], ",", 
        RowBox[{"Rpd", "=", "Rpd0"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"xValList", "=", 
        RowBox[{"{", 
         RowBox[{"0.3", ",", "0.6", ",", "0.9"}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"plot1", "=", 
        RowBox[{"LogLinearPlot", "[", 
         RowBox[{
          RowBox[{"Evaluate", "[", 
           RowBox[{"Join", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"10", 
               RowBox[{"Log10", "[", "1", "]"}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{"yesAntiSqz", ",", "\[IndentingNewLine]", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"10", 
                    RowBox[{"Log10", "[", 
                    RowBox[{"degenVPDloss", "[", 
                    RowBox[{
                    RowBox[{"2", "\[Pi]", " ", "f"}], ",", 
                    RowBox[{"xValList", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], ",", "Tin", ",", "Tloss", 
                    ",", "Rpd"}], "]"}], "]"}]}], ",", 
                   RowBox[{"{", 
                    RowBox[{"j", ",", "1", ",", 
                    RowBox[{"Length", "[", "xValList", "]"}]}], "}"}]}], 
                  "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{"10", 
                   RowBox[{"Log10", "[", 
                    RowBox[{"degenVPDloss", "[", 
                    RowBox[{
                    RowBox[{"2", "\[Pi]", " ", "f"}], ",", "1.0", ",", "Tin", 
                    ",", "Tloss", ",", "Rpd"}], "]"}], "]"}]}], "}"}]}], 
                "]"}], ",", 
               RowBox[{"{", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{"yesSqz", ",", "\[IndentingNewLine]", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"10", 
                    RowBox[{"Log10", "[", 
                    RowBox[{"degenVPDloss", "[", 
                    RowBox[{
                    RowBox[{"2", "\[Pi]", " ", "f"}], ",", 
                    RowBox[{"xValList", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], ",", "Tin", ",", "Tloss", 
                    ",", "Rpd", ",", 
                    RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
                   RowBox[{"{", 
                    RowBox[{"j", ",", "1", ",", 
                    RowBox[{"Length", "[", "xValList", "]"}]}], "}"}]}], 
                  "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{"10", 
                   RowBox[{"Log10", "[", 
                    RowBox[{"degenVPDloss", "[", 
                    RowBox[{
                    RowBox[{"2", "\[Pi]", " ", "f"}], ",", "1.0", ",", "Tin", 
                    ",", "Tloss", ",", "Rpd", ",", 
                    RowBox[{"-", "1"}]}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
               RowBox[{"{", "}"}]}], "]"}]}], "]"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"f", ",", 
            RowBox[{"5", " ", 
             SuperscriptBox["10", "4"]}], ",", 
            SuperscriptBox["10", "7"]}], "}"}], ",", 
          RowBox[{"PlotLegends", "\[Rule]", 
           RowBox[{"LineLegend", "[", 
            RowBox[{
             RowBox[{"Join", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", "\"\<x=0\>\"", "}"}], ",", "\[IndentingNewLine]", 
               
               RowBox[{"If", "[", 
                RowBox[{"yesAntiSqz", ",", "\[IndentingNewLine]", 
                 RowBox[{"Join", "[", 
                  RowBox[{
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"StringForm", "[", 
                    RowBox[{"\"\<x=``\>\"", ",", 
                    RowBox[{"xValList", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "1", ",", 
                    RowBox[{"Length", "[", "xValList", "]"}]}], "}"}]}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                   RowBox[{"{", "\"\<x=1\>\"", "}"}]}], "]"}], ",", 
                 RowBox[{"{", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{"yesSqz", ",", "\[IndentingNewLine]", 
                 RowBox[{"Join", "[", 
                  RowBox[{
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"StringForm", "[", 
                    RowBox[{"\"\<x=-``\>\"", ",", 
                    RowBox[{"xValList", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "1", ",", 
                    RowBox[{"Length", "[", "xValList", "]"}]}], "}"}]}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                   RowBox[{"{", "\"\<x=-1\>\"", "}"}]}], "]"}], ",", 
                 RowBox[{"{", "}"}]}], "]"}]}], "]"}], ",", 
             RowBox[{"LabelStyle", "\[Rule]", 
              RowBox[{"Directive", "[", "10", "]"}]}], ",", 
             RowBox[{"LegendLabel", "\[Rule]", 
              RowBox[{"StringForm", "[", 
               RowBox[{
               "\"\<f, \!\(\*FractionBox[\(\[Chi]\), \(\[Gamma]btot\)]\), \
Tin=0, Tloss=``, Rpd=``, gsgn:1\>\"", ",", "Tloss", ",", "Rpd"}], "]"}]}], 
             ",", 
             RowBox[{"LegendLayout", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"\"\<Column\>\"", ",", "2"}], "}"}]}]}], "]"}]}], ",", 
          
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Thickness", "[", "Small", "]"}], ",", "Gray"}], 
               "}"}], "}"}], ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"ColorData", "[", 
                RowBox[{"97", ",", "i"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", 
                 RowBox[{"Length", "[", "xValList", "]"}]}], "}"}]}], "]"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"{", 
               RowBox[{"Dashed", ",", 
                RowBox[{"ColorData", "[", 
                 RowBox[{"97", ",", 
                  RowBox[{
                   RowBox[{"Length", "[", "xValList", "]"}], "+", "1"}]}], 
                 "]"}]}], "}"}], "}"}], ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"ColorData", "[", 
                RowBox[{"97", ",", "i"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", 
                 RowBox[{"Length", "[", "xValList", "]"}]}], "}"}]}], "]"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"{", 
               RowBox[{"Dashed", ",", 
                RowBox[{"ColorData", "[", 
                 RowBox[{"97", ",", 
                  RowBox[{
                   RowBox[{"Length", "[", "xValList", "]"}], "+", "1"}]}], 
                 "]"}]}], "}"}], "}"}]}], "]"}]}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "400"}], ",", 
          RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
          RowBox[{"Frame", "\[Rule]", "True"}], ",", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", " ", 
              RowBox[{
              "\"\<variance / dB (10\!\(\*SubscriptBox[\(log\), \
\(10\)]\))\>\"", ","}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
              "\"\<frequency, f=\!\(\*FractionBox[\(\[CapitalOmega]\), \(2  \
\[Pi]\)]\) / (log scale)\>\"", ",", 
               "\"\<degenerate OPO\\nlog-log concavity gridlines: solid is \
anti-sqz., dashed is sqz.\\nbrute force \[ImplicitPlus]\[PlusMinus]1dB \
closeness gridlines: dotted is anti-sqz, dash-dotted is sqz.\>\""}], "}"}]}], 
            "}"}]}], ",", 
          RowBox[{"PerformanceGoal", "\[Rule]", "\"\<Speed\>\""}], ",", 
          RowBox[{"GridLines", "\[Rule]", 
           RowBox[{"If", "[", 
            RowBox[{"yesGridLines", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Join", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{"yesAntiSqz", ",", 
                   RowBox[{"Flatten", "[", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"loglogConcavf", "[", 
                    RowBox[{
                    RowBox[{"xValList", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], ",", "Tloss", ",", 
                    "Rpd"}], "]"}], ",", 
                    RowBox[{"Directive", "[", 
                    RowBox[{"ColorData", "[", 
                    RowBox[{"97", ",", "j"}], "]"}], "]"}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"f", "/.", 
                    RowBox[{
                    RowBox[{"Solve", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{"10", 
                    RowBox[{"Log10", "[", 
                    RowBox[{"degenVPDloss", "[", 
                    RowBox[{
                    RowBox[{"2", "\[Pi]", " ", "f"}], ",", 
                    RowBox[{"xValList", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], ",", "0", ",", "Tloss", 
                    ",", "Rpd"}], "]"}], "]"}]}], "-", 
                    RowBox[{"10", 
                    RowBox[{"Log10", "[", 
                    RowBox[{"degenVPDloss", "[", 
                    RowBox[{
                    RowBox[{"2", "\[Pi]", " ", "f"}], ",", "1.", ",", "0", 
                    ",", "Tloss", ",", "Rpd"}], "]"}], "]"}]}]}], "]"}], 
                    "\[Equal]", "1"}], ",", "f"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}]}], ",", 
                    RowBox[{"Directive", "[", 
                    RowBox[{"Dotted", ",", 
                    RowBox[{"ColorData", "[", 
                    RowBox[{"97", ",", "j"}], "]"}]}], "]"}]}], "}"}]}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "1", ",", 
                    RowBox[{"Length", "[", "xValList", "]"}]}], "}"}]}], 
                    "]"}], ",", "1"}], "]"}], ",", 
                   RowBox[{"{", "}"}]}], "]"}], ",", 
                 RowBox[{"If", "[", 
                  RowBox[{"yesSqz", ",", 
                   RowBox[{"Flatten", "[", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"loglogConcavf", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"xValList", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], ",", "Tloss", ",", 
                    "Rpd"}], "]"}], ",", 
                    RowBox[{"Directive", "[", 
                    RowBox[{
                    RowBox[{"ColorData", "[", 
                    RowBox[{"97", ",", "j"}], "]"}], ",", "Dashed"}], "]"}]}],
                     "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"f", "/.", 
                    RowBox[{
                    RowBox[{"Solve", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{"10", 
                    RowBox[{"Log10", "[", 
                    RowBox[{"degenVPDloss", "[", 
                    RowBox[{
                    RowBox[{"2", "\[Pi]", " ", "f"}], ",", 
                    RowBox[{"-", 
                    RowBox[{"xValList", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], ",", "0", ",", "Tloss", 
                    ",", "Rpd"}], "]"}], "]"}]}], "-", 
                    RowBox[{"10", 
                    RowBox[{"Log10", "[", 
                    RowBox[{"degenVPDloss", "[", 
                    RowBox[{
                    RowBox[{"2", "\[Pi]", " ", "f"}], ",", 
                    RowBox[{"-", "1."}], ",", "0", ",", "Tloss", ",", "Rpd"}],
                     "]"}], "]"}]}]}], "]"}], "\[Equal]", "1"}], ",", "f"}], 
                    "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}]}], ",", 
                    RowBox[{"Directive", "[", 
                    RowBox[{"DotDashed", ",", 
                    RowBox[{"ColorData", "[", 
                    RowBox[{"97", ",", "j"}], "]"}]}], "]"}]}], "}"}]}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "1", ",", 
                    RowBox[{"Length", "[", "xValList", "]"}]}], "}"}]}], 
                    "]"}], ",", "1"}], "]"}], ",", 
                   RowBox[{"{", "}"}]}], "]"}]}], "]"}], ",", 
               RowBox[{"{", "}"}]}], "}"}], ","}], "]"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"to", "-", 
          RowBox[{"do", ":", " ", 
           RowBox[{
           "label", " ", "gridlines", " ", "properly", "\[IndentingNewLine]", 
            
            RowBox[{"Labelled", "[", 
             RowBox[{"plot1", ",", 
              RowBox[{"LineLegend", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Directive", "[", 
                   RowBox[{"LightGray", ",", "Thick"}], "]"}], ",", 
                  RowBox[{"Directive", "[", 
                   RowBox[{"LightGray", ",", "Dashed"}], "]"}]}], "}"}], ",", 
                
                RowBox[{"{", 
                 RowBox[{
                 "\"\<\!\(\*SubscriptBox[\(\[Omega]\), \(s\)]\)\>\"", ",", 
                  "\"\<\!\(\*SubscriptBox[\(\[CapitalOmega]\), \(\(thr\)\(.\)\
\)]\) from singularity def\>\""}], "}"}], ",", 
                RowBox[{"LabelStyle", "\[Rule]", "10"}], ",", 
                RowBox[{
                "LegendLabel", "\[Rule]", "\"\<vertical gridlines\>\""}]}], 
               "]"}], ",", "Right"}], "]"}]}]}]}], "]"}], "*)"}], 
       "\[IndentingNewLine]", "plot1"}]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Tloss", ",", " ", "Rpd", ",", " ", "yesSqz", ",", " ", "yesAntiSqz", ",",
      " ", "yesGridLines"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"dOPOchange\[Chi]", "[", 
    RowBox[{"0", ",", "0"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"dOPOchange\[Chi]", "[", 
    RowBox[{"0.01", ",", "0.01"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"dOPOchange\[Chi]", "[", 
    RowBox[{"0.01", ",", "0.01", ",", "True", ",", "False"}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.838240038822933*^9, 3.8382403828669786`*^9}, {
   3.838240422789474*^9, 3.838240467474976*^9}, {3.838240537291263*^9, 
   3.838240665258607*^9}, {3.838240760829009*^9, 3.838240853734519*^9}, {
   3.838240914227846*^9, 3.8382409403663673`*^9}, {3.838241002910152*^9, 
   3.838241142351692*^9}, {3.838241205371266*^9, 3.838241313879662*^9}, {
   3.83824137569112*^9, 3.83824137767245*^9}, {3.838241417207621*^9, 
   3.838241458095867*^9}, 3.838245182529476*^9, {3.8382453282053213`*^9, 
   3.8382453383014936`*^9}, {3.8382454845359907`*^9, 3.838245491368634*^9}, {
   3.8382455985378647`*^9, 3.838245639387113*^9}, {3.8382456757802763`*^9, 
   3.838245697698092*^9}, {3.8382457335359983`*^9, 3.838245872145541*^9}, {
   3.838247343304119*^9, 3.8382474264887037`*^9}, 3.838247495692561*^9, {
   3.838247535308807*^9, 3.8382476050940933`*^9}, {3.838247668598584*^9, 
   3.838247670060462*^9}, {3.838247712469372*^9, 3.8382477343877573`*^9}, 
   3.8382477786074257`*^9, {3.8382479131928873`*^9, 3.8382479762760677`*^9}, {
   3.838248235419888*^9, 3.8382482698877583`*^9}, {3.8382483145681257`*^9, 
   3.838248314629726*^9}, {3.838250136230761*^9, 3.838250171417255*^9}, {
   3.838250208486579*^9, 3.838250267724625*^9}, 3.83825073872088*^9, {
   3.838252028352607*^9, 3.838252028818159*^9}, {3.838252120152019*^9, 
   3.8382521231757107`*^9}, {3.838252173733395*^9, 3.8382523691108093`*^9}, {
   3.838252472879204*^9, 3.838252473894938*^9}, {3.838253078190548*^9, 
   3.838253270686513*^9}, {3.838320899244732*^9, 3.8383209163040733`*^9}, {
   3.8383209507323303`*^9, 3.838321015127441*^9}},
 CellLabel->
  "In[110]:=",ExpressionUUID->"dc2419f5-1825-423c-8c17-c28ca7679679"],

Cell[BoxData[
 RowBox[{"LogLinearPlot", "[", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"10", 
      RowBox[{"Log10", "[", 
       RowBox[{"degenVPDloss", "[", 
        RowBox[{
         RowBox[{"2", "\[Pi]", " ", "f"}], ",", "0.5", ",", "0", ",", "0", 
         ",", "0"}], "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"10", 
      RowBox[{"Log10", "[", 
       RowBox[{"degenVPDloss", "[", 
        RowBox[{
         RowBox[{"2", "\[Pi]", " ", "f"}], ",", "0.5", ",", "0", ",", "0.05", 
         ",", "0.05"}], "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"10", 
      RowBox[{"Log10", "[", 
       RowBox[{"degenVPDloss", "[", 
        RowBox[{
         RowBox[{"2", "\[Pi]", " ", "f"}], ",", "0.9", ",", "0", ",", "0", 
         ",", "0"}], "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"10", 
      RowBox[{"Log10", "[", 
       RowBox[{"degenVPDloss", "[", 
        RowBox[{
         RowBox[{"2", "\[Pi]", " ", "f"}], ",", "0.9", ",", "0", ",", "0.05", 
         ",", "0.05"}], "]"}], "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"f", ",", 
     SuperscriptBox["10", "5"], ",", 
     SuperscriptBox["10", "9"]}], "}"}], ",", 
   RowBox[{"PlotLegends", "\[Rule]", 
    RowBox[{"LineLegend", "[", 
     RowBox[{"\"\<Expressions\>\"", ",", 
      RowBox[{"LabelStyle", "\[Rule]", 
       RowBox[{"Directive", "[", "10", "]"}]}]}], "]"}]}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "400"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
   RowBox[{"Frame", "\[Rule]", "True"}], ",", 
   RowBox[{"FrameLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", " ", 
       RowBox[{
       "\"\<variance / dB (10\!\(\*SubscriptBox[\(log\), \(10\)]\))\>\"", 
        ","}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "\"\<frequency, f=\!\(\*FractionBox[\(\[CapitalOmega]\), \(2  \[Pi]\)]\
\) / (log scale)\>\"", ",", "\"\<degenerate OPO\>\""}], "}"}]}], "}"}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.838241491659861*^9, 3.838241576176944*^9}, 
   3.838246104908763*^9},
 CellLabel->"In[50]:=",ExpressionUUID->"f68cec37-3d78-48dd-aa55-6eb290d4a71b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"nondegenerate", " ", "OPO"}], ",", " ", 
    RowBox[{"from", " ", "above", " ", 
     RowBox[{"calculation", ":", " ", 
      RowBox[{
       RowBox[{"V", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}]}], ",", " ", 
    RowBox[{
     RowBox[{"V", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "[", 
     RowBox[{"[", "3", "]"}], "]"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Vs1s1", "[", 
     RowBox[{"w_", ",", "Tin_", ",", "Tloss_"}], "]"}], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"kin", "=", 
       RowBox[{
        FractionBox[
         RowBox[{"-", "1"}], 
         RowBox[{"2", " ", "tRoundTrip"}]], 
        RowBox[{"Log", "[", 
         RowBox[{"1", "-", "Tin"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"kloss", "=", 
       RowBox[{
        FractionBox[
         RowBox[{"-", "1"}], 
         RowBox[{"2", " ", "tRoundTrip"}]], 
        RowBox[{"Log", "[", 
         RowBox[{"1", "-", "Tloss"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ktot", "=", 
       RowBox[{"kout", "+", "kin", "+", "kloss"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"g", "=", 
       RowBox[{"x", " ", "ktot"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"1", "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"8", " ", 
          SuperscriptBox["x", "2"], " ", 
          SuperscriptBox["ktot", "3"], " ", "kout"}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              SuperscriptBox["x", "2"]}], ")"}], "2"], " ", 
           SuperscriptBox["ktot", "4"]}], "+", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox["x", "2"]}], ")"}], " ", 
           SuperscriptBox["ktot", "2"], " ", 
           SuperscriptBox["w", "2"]}], "+", 
          SuperscriptBox["w", "4"]}], ")"}]}]}]}], ")"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Vs1i2", "[", 
     RowBox[{"w_", ",", "Tin_", ",", "Tloss_"}], "]"}], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"kin", "=", 
       RowBox[{
        FractionBox[
         RowBox[{"-", "1"}], 
         RowBox[{"2", " ", "tRoundTrip"}]], 
        RowBox[{"Log", "[", 
         RowBox[{"1", "-", "Tin"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"kloss", "=", 
       RowBox[{
        FractionBox[
         RowBox[{"-", "1"}], 
         RowBox[{"2", " ", "tRoundTrip"}]], 
        RowBox[{"Log", "[", 
         RowBox[{"1", "-", "Tloss"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ktot", "=", 
       RowBox[{"kout", "+", "kin", "+", "kloss"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"g", "=", 
       RowBox[{"x", " ", "ktot"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"4", " ", "x", " ", "ktot", " ", "kout", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "+", 
              SuperscriptBox["x", "2"]}], ")"}], " ", 
            SuperscriptBox["ktot", "2"]}], "+", 
           SuperscriptBox["w", "2"]}], ")"}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             SuperscriptBox["x", "2"]}], ")"}], "2"], " ", 
          SuperscriptBox["ktot", "4"]}], "+", 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            SuperscriptBox["x", "2"]}], ")"}], " ", 
          SuperscriptBox["ktot", "2"], " ", 
          SuperscriptBox["w", "2"]}], "+", 
         SuperscriptBox["w", "4"]}], ")"}]}]}], ")"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{"Labeled", "[", 
     RowBox[{
      RowBox[{"LogLinearPlot", "[", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"10", 
           RowBox[{"Log10", "[", "1", "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"10", 
           RowBox[{"Log10", "[", 
            RowBox[{"Vs1s1", "[", 
             RowBox[{
              RowBox[{"2", "\[Pi]", " ", "f"}], ",", 
              RowBox[{"Tin", "=", "0"}], ",", 
              RowBox[{"Tloss", "=", "0"}]}], "]"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"10", 
           RowBox[{"Log10", "[", 
            RowBox[{"Vs1s1", "[", 
             RowBox[{
              RowBox[{"2", "\[Pi]", " ", "f"}], ",", 
              RowBox[{"Tin", "=", "0.1"}], ",", 
              RowBox[{"Tloss", "=", "0.1"}]}], "]"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"10", 
           RowBox[{"Log10", "[", 
            RowBox[{"Vs1i2", "[", 
             RowBox[{
              RowBox[{"2", "\[Pi]", " ", "f"}], ",", 
              RowBox[{"Tin", "=", "0"}], ",", 
              RowBox[{"Tloss", "=", "0"}]}], "]"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"10", 
           RowBox[{"Log10", "[", 
            RowBox[{"Vs1i2", "[", 
             RowBox[{
              RowBox[{"2", "\[Pi]", " ", "f"}], ",", 
              RowBox[{"Tin", "=", "0.1"}], ",", 
              RowBox[{"Tloss", "=", "0.1"}]}], "]"}], "]"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"f", ",", 
          SuperscriptBox["10", "5"], ",", 
          SuperscriptBox["10", "9"]}], "}"}], ",", 
        RowBox[{"PlotLegends", "\[Rule]", 
         RowBox[{"LineLegend", "[", 
          RowBox[{"\"\<Expressions\>\"", ",", 
           RowBox[{"LabelStyle", "\[Rule]", 
            RowBox[{"Directive", "[", "10", "]"}]}]}], "]"}]}], ",", 
        RowBox[{
        "PlotLabel", "\[Rule]", 
         "\"\<nondegenerate OPO\\n\!\(\*SubscriptBox[\(V\), \(s1, s1\)]\) is \
on-diagonal, \!\(\*SubscriptBox[\(V\), \(s1, i2\)]\) is off-diagonal\>\""}], 
        ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Dashed", ",", "Gray"}], "}"}], ",", ",", ",", ","}], 
          "}"}]}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "350"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "\"\<frequency, f=\!\(\*FractionBox[\(\[CapitalOmega]\), \(2 \
\[Pi]\)]\) / (log scale)\>\"", ",", " ", 
        "\"\<covariance / dB (10\!\(\*SubscriptBox[\(log\), \(10\)]\))\>\""}],
        "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"Bottom", ",", "Left"}], "}"}], ",", 
      RowBox[{"RotateLabel", "\[Rule]", "True"}], ",", 
      RowBox[{"LabelStyle", "\[Rule]", 
       RowBox[{"Directive", "[", "10", "]"}]}]}], "]"}], 
    "\[IndentingNewLine]", "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.8346928734187813`*^9, 3.834693199941409*^9}, {
   3.834693619692971*^9, 3.834693740360461*^9}, 3.834693777616811*^9, {
   3.834697161424477*^9, 3.8346971673177567`*^9}, {3.834697298929451*^9, 
   3.8346974603004713`*^9}, 3.834697559333034*^9, 3.835129156180674*^9, {
   3.8351292374617043`*^9, 3.8351292579049883`*^9}, {3.835142835871221*^9, 
   3.8351428837988358`*^9}, {3.8351429579331617`*^9, 
   3.8351429662695837`*^9}, {3.835142998929871*^9, 3.835143096501708*^9}, {
   3.835143502958074*^9, 3.835143506615409*^9}, {3.835222075505953*^9, 
   3.835222113388472*^9}, {3.835816735036429*^9, 3.8358167388174963`*^9}, {
   3.836179454022002*^9, 3.836179455673527*^9}, {3.836179515411064*^9, 
   3.83617951675173*^9}},
 CellLabel->"In[51]:=",ExpressionUUID->"f2455dc5-ea52-4213-a106-86ca368c0212"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"adding", " ", "PD", " ", "loss"}], ",", " ", 
    RowBox[{
    "see", " ", "degenerate", " ", "OPO", " ", "case", " ", "for", " ", 
     "description", " ", "of", " ", "Rpd"}]}], "*)"}], "\[IndentingNewLine]", 
  
  RowBox[{
   RowBox[{
    RowBox[{"Vs1s1PDloss", "[", 
     RowBox[{"w_", ",", "Tin_", ",", "Tloss_", ",", "Rpd_"}], "]"}], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"kin", "=", 
       RowBox[{
        FractionBox[
         RowBox[{"-", "1"}], 
         RowBox[{"2", " ", "tRoundTrip"}]], 
        RowBox[{"Log", "[", 
         RowBox[{"1", "-", "Tin"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"kloss", "=", 
       RowBox[{
        FractionBox[
         RowBox[{"-", "1"}], 
         RowBox[{"2", " ", "tRoundTrip"}]], 
        RowBox[{"Log", "[", 
         RowBox[{"1", "-", "Tloss"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ktot", "=", 
       RowBox[{"kout", "+", "kin", "+", "kloss"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"g", "=", 
         RowBox[{"x", " ", "ktot"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"1", "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"8", " ", 
          SuperscriptBox["x", "2"], " ", 
          SuperscriptBox["ktot", "3"], " ", "kout", 
          RowBox[{"(", 
           RowBox[{"1", "-", "Rpd"}], ")"}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              SuperscriptBox["x", "2"]}], ")"}], "2"], " ", 
           SuperscriptBox["ktot", "4"]}], "+", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox["x", "2"]}], ")"}], " ", 
           SuperscriptBox["ktot", "2"], " ", 
           SuperscriptBox["w", "2"]}], "+", 
          SuperscriptBox["w", "4"]}], ")"}]}]}]}], ")"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Vs1i2PDloss", "[", 
     RowBox[{"w_", ",", "Tin_", ",", "Tloss_", ",", "Rpd_"}], "]"}], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"kin", "=", 
       RowBox[{
        FractionBox[
         RowBox[{"-", "1"}], 
         RowBox[{"2", " ", "tRoundTrip"}]], 
        RowBox[{"Log", "[", 
         RowBox[{"1", "-", "Tin"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"kloss", "=", 
       RowBox[{
        FractionBox[
         RowBox[{"-", "1"}], 
         RowBox[{"2", " ", "tRoundTrip"}]], 
        RowBox[{"Log", "[", 
         RowBox[{"1", "-", "Tloss"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ktot", "=", 
       RowBox[{"kout", "+", "kin", "+", "kloss"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"g", "=", 
         RowBox[{"x", " ", "ktot"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"4", " ", "x", " ", "ktot", " ", "kout", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "+", 
              SuperscriptBox["x", "2"]}], ")"}], " ", 
            SuperscriptBox["ktot", "2"]}], "+", 
           SuperscriptBox["w", "2"]}], ")"}], 
         RowBox[{"(", 
          RowBox[{"1", "-", "Rpd"}], ")"}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             SuperscriptBox["x", "2"]}], ")"}], "2"], " ", 
          SuperscriptBox["ktot", "4"]}], "+", 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            SuperscriptBox["x", "2"]}], ")"}], " ", 
          SuperscriptBox["ktot", "2"], " ", 
          SuperscriptBox["w", "2"]}], "+", 
         SuperscriptBox["w", "4"]}], ")"}]}]}], ")"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "plotting", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"p1", "=", 
     RowBox[{"LogLinearPlot", "[", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"10", 
          RowBox[{"Log10", "[", 
           RowBox[{"Vs1s1PDloss", "[", 
            RowBox[{
             RowBox[{"2", "\[Pi]", " ", "f"}], ",", 
             RowBox[{"Tin", "=", "0"}], ",", 
             RowBox[{"Tloss", "=", "0"}], ",", 
             RowBox[{"Rpd", "=", "0"}]}], "]"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"10", 
          RowBox[{"Log10", "[", 
           RowBox[{"Vs1s1PDloss", "[", 
            RowBox[{
             RowBox[{"2", "\[Pi]", " ", "f"}], ",", 
             RowBox[{"Tin", "=", "0"}], ",", 
             RowBox[{"Tloss", "=", "0"}], ",", 
             RowBox[{"Rpd", "=", "0.5"}]}], "]"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"10", 
          RowBox[{"Log10", "[", 
           RowBox[{"Vs1s1PDloss", "[", 
            RowBox[{
             RowBox[{"2", "\[Pi]", " ", "f"}], ",", 
             RowBox[{"Tin", "=", "0.1"}], ",", 
             RowBox[{"Tloss", "=", "0.1"}], ",", 
             RowBox[{"Rpd", "=", "0"}]}], "]"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"10", 
          RowBox[{"Log10", "[", 
           RowBox[{"Vs1s1PDloss", "[", 
            RowBox[{
             RowBox[{"2", "\[Pi]", " ", "f"}], ",", 
             RowBox[{"Tin", "=", "0.1"}], ",", 
             RowBox[{"Tloss", "=", "0.1"}], ",", 
             RowBox[{"Rpd", "=", "0.5"}]}], "]"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"10", 
          RowBox[{"Log10", "[", "1", "]"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"f", ",", 
         SuperscriptBox["10", "5"], ",", 
         SuperscriptBox["10", "9"]}], "}"}], ",", 
       RowBox[{"PlotLegends", "\[Rule]", 
        RowBox[{"LineLegend", "[", 
         RowBox[{"\"\<Expressions\>\"", ",", 
          RowBox[{"LabelStyle", "\[Rule]", 
           RowBox[{"Directive", "[", "10", "]"}]}]}], "]"}]}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{",", "Dashed", ",", ",", "Dashed", ",", 
          RowBox[{"{", 
           RowBox[{"Dashed", ",", "Gray"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"ImageSize", "\[Rule]", "350"}], ",", 
       RowBox[{"Frame", "->", "True"}], ",", 
       RowBox[{"FrameLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "\"\<variance / dB (10\!\(\*SubscriptBox[\(log\), \(10\)]\))\>\"", 
            ","}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
           ",", "\"\<nondegenerate OPO\\n\!\(\*SubscriptBox[\(V\), \(s1, \
s1\)]\) on-diagonal (top), \!\(\*SubscriptBox[\(V\), \(s1, i2\)]\) \
off-diagonal terms (bottom)\\nPD and intracavity loss\>\""}], "}"}]}], 
         "}"}]}], ",", 
       RowBox[{"TicksStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Directive", "[", 
           RowBox[{
            RowBox[{"FontOpacity", "\[Rule]", "0"}], ",", 
            RowBox[{"FontSize", "\[Rule]", "0"}]}], "]"}], ","}], "}"}]}], 
       ",", 
       RowBox[{"ImagePadding", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"40", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "All"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"p2", "=", 
     RowBox[{"LogLinearPlot", "[", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"10", 
          RowBox[{"Log10", "[", 
           RowBox[{"Vs1i2PDloss", "[", 
            RowBox[{
             RowBox[{"2", "\[Pi]", " ", "f"}], ",", 
             RowBox[{"Tin", "=", "0"}], ",", 
             RowBox[{"Tloss", "=", "0"}], ",", 
             RowBox[{"Rpd", "=", "0"}]}], "]"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"10", 
          RowBox[{"Log10", "[", 
           RowBox[{"Vs1i2PDloss", "[", 
            RowBox[{
             RowBox[{"2", "\[Pi]", " ", "f"}], ",", 
             RowBox[{"Tin", "=", "0"}], ",", 
             RowBox[{"Tloss", "=", "0"}], ",", 
             RowBox[{"Rpd", "=", "0.5"}]}], "]"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"10", 
          RowBox[{"Log10", "[", 
           RowBox[{"Vs1i2PDloss", "[", 
            RowBox[{
             RowBox[{"2", "\[Pi]", " ", "f"}], ",", 
             RowBox[{"Tin", "=", "0.1"}], ",", 
             RowBox[{"Tloss", "=", "0.1"}], ",", 
             RowBox[{"Rpd", "=", "0"}]}], "]"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"10", 
          RowBox[{"Log10", "[", 
           RowBox[{"Vs1i2PDloss", "[", 
            RowBox[{
             RowBox[{"2", "\[Pi]", " ", "f"}], ",", 
             RowBox[{"Tin", "=", "0.1"}], ",", 
             RowBox[{"Tloss", "=", "0.1"}], ",", 
             RowBox[{"Rpd", "=", "0.5"}]}], "]"}], "]"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"f", ",", 
         SuperscriptBox["10", "5"], ",", 
         SuperscriptBox["10", "9"]}], "}"}], ",", 
       RowBox[{"PlotLegends", "\[Rule]", 
        RowBox[{"LineLegend", "[", 
         RowBox[{"\"\<Expressions\>\"", ",", 
          RowBox[{"LabelStyle", "\[Rule]", 
           RowBox[{"Directive", "[", "10", "]"}]}]}], "]"}]}], ",", 
       RowBox[{"ImageSize", "\[Rule]", "350"}], ",", 
       RowBox[{"Frame", "\[Rule]", "True"}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{",", "Dashed"}], "}"}]}], ",", " ", 
       RowBox[{"FrameLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "\"\<covariance / dB (10\!\(\*SubscriptBox[\(log\), \
\(10\)]\))\>\"", ","}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
           "\"\<frequency, f=\!\(\*FractionBox[\(\[CapitalOmega]\), \(2  \
\[Pi]\)]\) / (log scale)\>\"", ","}], "}"}]}], "}"}]}], ",", 
       RowBox[{"ImagePadding", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"40", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"50", ",", "1"}], "}"}]}], "}"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Column", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"p1", ",", "p2"}], "}"}], ",", 
     RowBox[{"Spacings", "\[Rule]", "0"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8352221452215242`*^9, 3.835222197944674*^9}, {
  3.835222277592185*^9, 3.835222477888588*^9}, {3.8352225265039682`*^9, 
  3.835222889301949*^9}, {3.835223142665238*^9, 3.8352231428392267`*^9}, {
  3.835223328102748*^9, 3.83522336853197*^9}, {3.835223414686117*^9, 
  3.835223425749075*^9}, {3.835301129865756*^9, 3.835301146350882*^9}, {
  3.8358167424625387`*^9, 3.835816744867137*^9}, {3.8360009142574387`*^9, 
  3.836000916556603*^9}, {3.8361791074341297`*^9, 3.836179109194462*^9}, {
  3.83617921630606*^9, 3.8361792223804483`*^9}},
 CellLabel->"In[53]:=",ExpressionUUID->"9078f2fd-8f04-4df4-a0b7-27d6d2095637"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"demonstrating", " ", "squeezing"}], ",", " ", 
    RowBox[{"linear", " ", "combinations", " ", "of", " ", "quadratures"}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Clear", "[", "x", "]"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"watch", " ", "out", " ", "for", " ", "re"}], "-", 
      RowBox[{
      "normalisation", " ", "of", " ", "combined", " ", "quadrature"}]}], ",",
      " ", 
     RowBox[{"here", " ", 
      SuperscriptBox["2", 
       RowBox[{
        RowBox[{"-", "1"}], "/", "2"}]], " ", "has", " ", "been", " ", 
      "taken"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Vcom", "[", 
     RowBox[{"\[Psi]_", ",", "Rpd_"}], "]"}], ":=", 
    RowBox[{"1", "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "Rpd"}], ")"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"4", " ", "x", " ", "\[Kappa]a", " ", "\[Kappa]af", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "x", " ", 
             SuperscriptBox["\[Kappa]a", "2"]}], " ", "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"2", "\[Psi]"}], "]"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "+", 
                  SuperscriptBox["x", "2"]}], ")"}], " ", 
                SuperscriptBox["\[Kappa]a", "2"]}], "+", 
               SuperscriptBox["\[Omega]", "2"]}], ")"}]}]}], ")"}]}], ")"}], 
        "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              SuperscriptBox["x", "2"]}], ")"}], "2"], " ", 
           SuperscriptBox["\[Kappa]a", "4"]}], "+", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox["x", "2"]}], ")"}], " ", 
           SuperscriptBox["\[Kappa]a", "2"], " ", 
           SuperscriptBox["\[Omega]", "2"]}], "+", 
          SuperscriptBox["\[Omega]", "4"]}], ")"}]}], ")"}]}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"2", 
    RowBox[{"Vcom", "[", 
     RowBox[{
      FractionBox["\[Pi]", "4"], ",", "0"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
      "need", " ", "to", " ", "show", " ", "for", " ", "degenerate", " ", 
       "OPO", " ", "that", " ", "\[Theta]b"}], "\[NotEqual]", 
      RowBox[{
      "0", " ", "results", " ", "are", " ", "given", " ", "by", " ", "a", " ",
        "linear", " ", "combination", " ", "of", " ", "\[Theta]b"}]}], "=", 
     RowBox[{"0", " ", "quadratures"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Clear", "[", "g", "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Idd", "=", 
     RowBox[{"IdentityMatrix", "[", "2", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[CapitalGamma]d", "=", 
     RowBox[{"(", GridBox[{
        {"1", "1"},
        {
         RowBox[{"-", "I"}], "I"}
       }], ")"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Md", "=", 
     RowBox[{"(", GridBox[{
        {"0", 
         RowBox[{"Exp", "[", 
          RowBox[{"I", " ", "\[Theta]b"}], "]"}]},
        {
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "I"}], " ", "\[Theta]b"}], "]"}], "0"}
       }], ")"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Asumpsd", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Kappa]af", ">", "0"}], ",", 
       RowBox[{"\[Kappa]a", ">", "\[Kappa]af"}], ",", 
       RowBox[{"g", ">", "0"}], ",", 
       RowBox[{"\[CapitalOmega]", ">", "0"}], ",", 
       RowBox[{"Element", "[", 
        RowBox[{"\[Theta]b", ",", "Reals"}], "]"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Td", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"2", " ", "\[Kappa]af", " ", 
         RowBox[{"\[CapitalGamma]d", ".", 
          RowBox[{"Inverse", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"\[Kappa]a", "-", 
               RowBox[{"I", " ", "\[CapitalOmega]"}]}], ")"}], "Idd"}], "-", 
            RowBox[{"g", " ", "Md"}]}], "]"}], ".", 
          RowBox[{"Inverse", "[", "\[CapitalGamma]d", "]"}]}]}], "-", "Idd"}],
        ",", 
       RowBox[{"Assumptions", "\[Rule]", "Asumpsd"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Rd", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"\[Kappa]af", 
           RowBox[{"(", 
            RowBox[{"\[Kappa]a", "-", "\[Kappa]af"}], ")"}]}], ")"}], 
         RowBox[{"1", "/", "2"}]], " ", 
        RowBox[{"\[CapitalGamma]d", ".", 
         RowBox[{"Inverse", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"\[Kappa]a", "-", 
              RowBox[{"I", " ", "\[CapitalOmega]"}]}], ")"}], "Idd"}], "-", 
           RowBox[{"g", " ", "Md"}]}], "]"}], ".", 
         RowBox[{"Inverse", "[", "\[CapitalGamma]d", "]"}]}]}], ",", 
       RowBox[{"Assumptions", "\[Rule]", "Asumpsd"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Vd", "=", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Td", ".", 
         RowBox[{"ConjugateTranspose", "[", "Td", "]"}]}], "+", 
        RowBox[{"Rd", ".", 
         RowBox[{"ConjugateTranspose", "[", "Rd", "]"}]}]}], ",", 
       RowBox[{"Assumptions", "\[Rule]", "Asumpsd"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Vd", "//", "MatrixForm"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FullSimplify", "[", 
     RowBox[{"Vd", "/.", 
      RowBox[{"{", 
       RowBox[{"\[Theta]b", "\[Rule]", "0"}], "}"}]}], "]"}], "//", 
    "MatrixForm"}], "\[IndentingNewLine]", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Vd", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], ")"}], "/.", 
       RowBox[{"{", 
        RowBox[{"g", "\[Rule]", 
         RowBox[{"x", " ", "\[Kappa]a"}]}], "}"}]}], ")"}], "==", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"4", " ", "x", " ", "\[Kappa]a", " ", "\[Kappa]af", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "x", " ", 
            SuperscriptBox["\[Kappa]a", "2"]}], " ", "+", 
           RowBox[{
            RowBox[{"Cos", "[", "\[Theta]b", "]"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 SuperscriptBox["x", "2"]}], ")"}], " ", 
               SuperscriptBox["\[Kappa]a", "2"]}], "+", 
              SuperscriptBox["\[CapitalOmega]", "2"]}], ")"}]}]}], ")"}]}], 
        ")"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             SuperscriptBox["x", "2"]}], ")"}], "2"], " ", 
          SuperscriptBox["\[Kappa]a", "4"]}], "+", 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            SuperscriptBox["x", "2"]}], ")"}], " ", 
          SuperscriptBox["\[Kappa]a", "2"], " ", 
          SuperscriptBox["\[CapitalOmega]", "2"]}], "+", 
         SuperscriptBox["\[CapitalOmega]", "4"]}], ")"}]}]}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"to", "-", 
      RowBox[{"do", ":", " ", 
       RowBox[{
        RowBox[{"check", " ", "this", " ", "covariance", " ", "matrix"}], " ",
         "-", " ", 
        RowBox[{"rows", " ", "are", " ", 
         SubscriptBox[
          OverscriptBox["X", "^"], "1"], " ", "and", " ", 
         SubscriptBox[
          OverscriptBox["X", "^"], "2"]}]}]}]}], ",", " ", 
     RowBox[{
     "surely", " ", "covariances", " ", "should", " ", "be", " ", "zero", " ",
       "for", " ", "degenerate", " ", "OPO", " ", "given", " ", "vacuum", " ", 
      RowBox[{"inputs", "?"}]}]}], "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.835308593742786*^9, 3.835308718773211*^9}, {
  3.8353088820736313`*^9, 3.835308912364955*^9}, {3.835311774929598*^9, 
  3.8353117764158*^9}, {3.835319450987887*^9, 3.8353194518559933`*^9}, {
  3.835403468216269*^9, 3.835403488980576*^9}, {3.835745915289628*^9, 
  3.83574593695503*^9}},
 CellLabel->"In[58]:=",ExpressionUUID->"a0d8d83d-95cc-4f9b-8224-a99d4af539bf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"NOPO", " ", "with", " ", "asymmetric", " ", "losses"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Clear", "[", 
    RowBox[{"g", ",", "Rpd"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"M1", "=", 
     RowBox[{"(", GridBox[{
        {
         RowBox[{"-", "\[Kappa]a"}], "0", "0", "g"},
        {"0", 
         RowBox[{"-", "\[Kappa]a"}], 
         RowBox[{"g", "\[Conjugate]"}], "0"},
        {"0", "g", 
         RowBox[{"-", "\[Kappa]c"}], "0"},
        {
         RowBox[{"g", "\[Conjugate]"}], "0", "0", 
         RowBox[{"-", "\[Kappa]c"}]}
       }], ")"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"M2f", "=", 
     RowBox[{"(", GridBox[{
        {
         SuperscriptBox["\[Kappa]af", 
          RowBox[{"1", "/", "2"}]], "0", "0", "0"},
        {"0", 
         SuperscriptBox["\[Kappa]af", 
          RowBox[{"1", "/", "2"}]], "0", "0"},
        {"0", "0", 
         SuperscriptBox["\[Kappa]cf", 
          RowBox[{"1", "/", "2"}]], "0"},
        {"0", "0", "0", 
         SuperscriptBox["\[Kappa]cf", 
          RowBox[{"1", "/", "2"}]]}
       }], ")"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"M2l", "=", 
     RowBox[{"(", GridBox[{
        {
         SuperscriptBox["\[Kappa]al", 
          RowBox[{"1", "/", "2"}]], "0", "0", "0"},
        {"0", 
         SuperscriptBox["\[Kappa]al", 
          RowBox[{"1", "/", "2"}]], "0", "0"},
        {"0", "0", 
         SuperscriptBox["\[Kappa]cl", 
          RowBox[{"1", "/", "2"}]], "0"},
        {"0", "0", "0", 
         SuperscriptBox["\[Kappa]cl", 
          RowBox[{"1", "/", "2"}]]}
       }], ")"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Id", "=", 
     RowBox[{"IdentityMatrix", "[", "4", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[CapitalGamma]", "=", 
     RowBox[{"(", GridBox[{
        {"1", "1", "0", "0"},
        {
         RowBox[{"-", "\[ImaginaryI]"}], "\[ImaginaryI]", "0", "0"},
        {"0", "0", "1", "1"},
        {"0", "0", 
         RowBox[{"-", "\[ImaginaryI]"}], "\[ImaginaryI]"}
       }], ")"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.8225998302323427`*^9, 3.822599840400818*^9}, {
   3.822599884048806*^9, 3.822599959576777*^9}, {3.8226001256082478`*^9, 
   3.822600249764122*^9}, {3.822683060551339*^9, 3.822683081260954*^9}, {
   3.8226842348802567`*^9, 3.822684250189427*^9}, {3.836267217404581*^9, 
   3.836267343660534*^9}, {3.836267450169153*^9, 3.836267591294258*^9}, {
   3.836267626236208*^9, 3.8362677503556957`*^9}, {3.836267855818136*^9, 
   3.836267931939766*^9}, {3.836267962677297*^9, 3.836267963098621*^9}, {
   3.836268118298297*^9, 3.836268118737303*^9}, {3.836268568193461*^9, 
   3.8362685710834312`*^9}, {3.838344642529855*^9, 3.838344645690518*^9}, {
   3.8386663094033957`*^9, 3.8386663101100187`*^9}, {3.838667783976397*^9, 
   3.838667800987034*^9}, 3.8386679039799833`*^9},
 CellLabel->"In[1]:=",ExpressionUUID->"3368c043-dcc6-478a-b2f2-8755f03eb9ab"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"TlGen", " ", "=", " ", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{"2", 
     RowBox[{"\[CapitalGamma]", ".", "M2f", ".", 
      RowBox[{"Inverse", "[", 
       RowBox[{
        RowBox[{"\[ImaginaryI]", " ", "\[CapitalOmega]", " ", "Id"}], "-", 
        "M1"}], "]"}], ".", "M2l", ".", 
      RowBox[{"Inverse", "[", "\[CapitalGamma]", "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TfGen", " ", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"2", 
      RowBox[{"\[CapitalGamma]", ".", "M2f", ".", 
       RowBox[{"Inverse", "[", 
        RowBox[{
         RowBox[{"\[ImaginaryI]", " ", "\[CapitalOmega]", " ", "Id"}], "-", 
         "M1"}], "]"}], ".", "M2f", ".", 
       RowBox[{"Inverse", "[", "\[CapitalGamma]", "]"}]}]}], "-", "Id"}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8225998302323427`*^9, 3.822599840400818*^9}, {
  3.822599884048806*^9, 3.822599959576777*^9}, {3.8226001256082478`*^9, 
  3.822600249764122*^9}, {3.822683060551339*^9, 3.822683081260954*^9}, {
  3.8226842348802567`*^9, 3.822684250189427*^9}, {3.836267217404581*^9, 
  3.836267343660534*^9}, {3.836267450169153*^9, 3.836267591294258*^9}, {
  3.836267626236208*^9, 3.8362677503556957`*^9}, {3.836267855818136*^9, 
  3.836267931939766*^9}, {3.836267962677297*^9, 3.836267963098621*^9}, {
  3.836268118298297*^9, 3.836268118737303*^9}, {3.836268568193461*^9, 
  3.8362685710834312`*^9}, {3.838344642529855*^9, 3.838344645690518*^9}, {
  3.8386663094033957`*^9, 3.8386663101100187`*^9}, {3.838667783976397*^9, 
  3.838667800987034*^9}, {3.8386679039799833`*^9, 3.838667904185437*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"551e6a63-32d5-4861-8697-0fb253b3f971"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Assumps2", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Kappa]af", ">", "0"}], ",", 
     RowBox[{"\[Kappa]a", "\[GreaterEqual]", "\[Kappa]af"}], ",", 
     RowBox[{"\[Kappa]cf", ">", "0"}], ",", 
     RowBox[{"\[Kappa]c", "\[GreaterEqual]", "\[Kappa]cf"}], ",", 
     RowBox[{"\[CapitalOmega]", ">", "0"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"VGen", " ", "=", " ", 
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Rpd", " ", "Id"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "Rpd"}], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"TlGen", ".", 
            RowBox[{"ConjugateTranspose", "[", "TlGen", "]"}]}], "+", 
           RowBox[{"TfGen", ".", 
            RowBox[{"ConjugateTranspose", "[", "TfGen", "]"}]}]}], ")"}]}]}], 
       "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Kappa]al", "\[Rule]", 
          RowBox[{"\[Kappa]a", "-", "\[Kappa]af"}]}], ",", 
         RowBox[{"\[Kappa]cl", "\[Rule]", 
          RowBox[{"\[Kappa]c", "-", "\[Kappa]cf"}]}]}], "}"}]}], ",", 
      RowBox[{"Assumptions", "\[Rule]", "Assumps2"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"VGen", "/.", 
     RowBox[{"{", 
      RowBox[{"g", "\[Rule]", 
       RowBox[{"x", " ", "\[Kappa]a", " ", 
        RowBox[{"Exp", "[", 
         RowBox[{"\[ImaginaryI]", " ", "\[Theta]b"}], "]"}]}]}], "}"}]}], ",", 
    RowBox[{"Assumptions", "\[Rule]", 
     RowBox[{"Join", "[", 
      RowBox[{"Assumps2", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"x", ">", "0"}], ",", 
         RowBox[{"\[Theta]b", ">", "0"}], ",", 
         RowBox[{"1", ">=", "Rpd", ">=", "0"}]}], "}"}]}], "]"}]}]}], "]"}], "//",
   "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"off", "-", 
     RowBox[{
     "diagonal", " ", "terms", " ", "are", " ", "not", " ", "real"}]}], ",", 
    " ", 
    RowBox[{"to", "-", 
     RowBox[{"do", ":", " ", 
      RowBox[{
       RowBox[{"check", " ", "if", " ", "diagonal"}], "\[Equal]", 
       RowBox[{
       "centre", " ", "matrix", " ", "wrong", " ", "assumption", " ", "used", 
        " ", "any", " ", 
        RowBox[{"where", "\[IndentingNewLine]", "--"}]}], ">", " ", 
       RowBox[{
       "it", " ", "was", " ", "used", " ", "but", " ", "did", " ", "not", " ",
         "affect", " ", 
        RowBox[{"result", "\[IndentingNewLine]", "--"}]}], ">", " ", 
       RowBox[{
       "look", " ", "at", " ", "Schori", " ", "et", " ", "al", " ", "2002", 
        " ", "to", " ", "try", " ", "and", " ", "figure", " ", "out", " ", 
        "the", " ", "mistake"}]}]}]}]}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.83626796155777*^9, 3.836267968841419*^9}, {
   3.836268719843995*^9, 3.836268720299754*^9}, 3.836268750923291*^9, {
   3.838666667785899*^9, 3.838666695975082*^9}, {3.8386684554163113`*^9, 
   3.838668498307135*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"b20a28b4-1450-4c5b-974f-d5e0c9718b7f"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"1", "-", 
       FractionBox[
        RowBox[{"8", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "Rpd"}], ")"}], " ", 
         SuperscriptBox["x", "2"], " ", 
         SuperscriptBox["\[Kappa]a", "2"], " ", "\[Kappa]af", " ", 
         "\[Kappa]c"}], 
        RowBox[{
         RowBox[{
          SuperscriptBox["\[Kappa]a", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", 
               SuperscriptBox["x", "2"]}], " ", "\[Kappa]a"}], "+", 
             "\[Kappa]c"}], ")"}], "2"]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"2", " ", 
                SuperscriptBox["x", "2"]}]}], ")"}], " ", 
             SuperscriptBox["\[Kappa]a", "2"]}], "+", 
            SuperscriptBox["\[Kappa]c", "2"]}], ")"}], " ", 
          SuperscriptBox["\[CapitalOmega]", "2"]}], "+", 
         SuperscriptBox["\[CapitalOmega]", "4"]}]]}], "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"4", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "Rpd"}], ")"}], " ", "x", " ", 
         "\[Kappa]a", " ", 
         SqrtBox[
          RowBox[{"\[Kappa]af", " ", "\[Kappa]cf"}]], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["x", "2"], " ", 
            SuperscriptBox["\[Kappa]a", "2"]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"\[ImaginaryI]", " ", "\[Kappa]a"}], "+", 
              "\[CapitalOmega]"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Kappa]c"}], "+", 
              "\[CapitalOmega]"}], ")"}]}]}], ")"}], " ", 
         RowBox[{"Cos", "[", "\[Theta]b", "]"}]}], 
        RowBox[{
         RowBox[{
          SuperscriptBox["\[Kappa]a", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", 
               SuperscriptBox["x", "2"]}], " ", "\[Kappa]a"}], "+", 
             "\[Kappa]c"}], ")"}], "2"]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"2", " ", 
                SuperscriptBox["x", "2"]}]}], ")"}], " ", 
             SuperscriptBox["\[Kappa]a", "2"]}], "+", 
            SuperscriptBox["\[Kappa]c", "2"]}], ")"}], " ", 
          SuperscriptBox["\[CapitalOmega]", "2"]}], "+", 
         SuperscriptBox["\[CapitalOmega]", "4"]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"4", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "Rpd"}], ")"}], " ", "x", " ", 
         "\[Kappa]a", " ", 
         SqrtBox[
          RowBox[{"\[Kappa]af", " ", "\[Kappa]cf"}]], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["x", "2"], " ", 
            SuperscriptBox["\[Kappa]a", "2"]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"\[ImaginaryI]", " ", "\[Kappa]a"}], "+", 
              "\[CapitalOmega]"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Kappa]c"}], "+", 
              "\[CapitalOmega]"}], ")"}]}]}], ")"}], " ", 
         RowBox[{"Sin", "[", "\[Theta]b", "]"}]}], 
        RowBox[{
         RowBox[{
          SuperscriptBox["\[Kappa]a", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", 
               SuperscriptBox["x", "2"]}], " ", "\[Kappa]a"}], "+", 
             "\[Kappa]c"}], ")"}], "2"]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"2", " ", 
                SuperscriptBox["x", "2"]}]}], ")"}], " ", 
             SuperscriptBox["\[Kappa]a", "2"]}], "+", 
            SuperscriptBox["\[Kappa]c", "2"]}], ")"}], " ", 
          SuperscriptBox["\[CapitalOmega]", "2"]}], "+", 
         SuperscriptBox["\[CapitalOmega]", "4"]}]]}]},
     {"0", 
      RowBox[{"1", "-", 
       FractionBox[
        RowBox[{"8", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "Rpd"}], ")"}], " ", 
         SuperscriptBox["x", "2"], " ", 
         SuperscriptBox["\[Kappa]a", "2"], " ", "\[Kappa]af", " ", 
         "\[Kappa]c"}], 
        RowBox[{
         RowBox[{
          SuperscriptBox["\[Kappa]a", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", 
               SuperscriptBox["x", "2"]}], " ", "\[Kappa]a"}], "+", 
             "\[Kappa]c"}], ")"}], "2"]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"2", " ", 
                SuperscriptBox["x", "2"]}]}], ")"}], " ", 
             SuperscriptBox["\[Kappa]a", "2"]}], "+", 
            SuperscriptBox["\[Kappa]c", "2"]}], ")"}], " ", 
          SuperscriptBox["\[CapitalOmega]", "2"]}], "+", 
         SuperscriptBox["\[CapitalOmega]", "4"]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"4", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "Rpd"}], ")"}], " ", "x", " ", 
         "\[Kappa]a", " ", 
         SqrtBox[
          RowBox[{"\[Kappa]af", " ", "\[Kappa]cf"}]], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["x", "2"], " ", 
            SuperscriptBox["\[Kappa]a", "2"]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"\[ImaginaryI]", " ", "\[Kappa]a"}], "+", 
              "\[CapitalOmega]"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Kappa]c"}], "+", 
              "\[CapitalOmega]"}], ")"}]}]}], ")"}], " ", 
         RowBox[{"Sin", "[", "\[Theta]b", "]"}]}], 
        RowBox[{
         RowBox[{
          SuperscriptBox["\[Kappa]a", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", 
               SuperscriptBox["x", "2"]}], " ", "\[Kappa]a"}], "+", 
             "\[Kappa]c"}], ")"}], "2"]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"2", " ", 
                SuperscriptBox["x", "2"]}]}], ")"}], " ", 
             SuperscriptBox["\[Kappa]a", "2"]}], "+", 
            SuperscriptBox["\[Kappa]c", "2"]}], ")"}], " ", 
          SuperscriptBox["\[CapitalOmega]", "2"]}], "+", 
         SuperscriptBox["\[CapitalOmega]", "4"]}]]}], 
      FractionBox[
       RowBox[{"4", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "Rpd"}], ")"}], " ", "x", " ", "\[Kappa]a",
         " ", 
        SqrtBox[
         RowBox[{"\[Kappa]af", " ", "\[Kappa]cf"}]], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["x", "2"], " ", 
           SuperscriptBox["\[Kappa]a", "2"]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[ImaginaryI]", " ", "\[Kappa]a"}], "+", 
             "\[CapitalOmega]"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Kappa]c"}], "+", 
             "\[CapitalOmega]"}], ")"}]}]}], ")"}], " ", 
        RowBox[{"Cos", "[", "\[Theta]b", "]"}]}], 
       RowBox[{
        RowBox[{
         SuperscriptBox["\[Kappa]a", "2"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              SuperscriptBox["x", "2"]}], " ", "\[Kappa]a"}], "+", 
            "\[Kappa]c"}], ")"}], "2"]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"2", " ", 
               SuperscriptBox["x", "2"]}]}], ")"}], " ", 
            SuperscriptBox["\[Kappa]a", "2"]}], "+", 
           SuperscriptBox["\[Kappa]c", "2"]}], ")"}], " ", 
         SuperscriptBox["\[CapitalOmega]", "2"]}], "+", 
        SuperscriptBox["\[CapitalOmega]", "4"]}]]},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{"4", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "Rpd"}], ")"}], " ", "x", " ", 
         "\[Kappa]a", " ", 
         SqrtBox[
          RowBox[{"\[Kappa]af", " ", "\[Kappa]cf"}]], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["x", "2"], " ", 
            SuperscriptBox["\[Kappa]a", "2"]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Kappa]a"}], "+", 
              "\[CapitalOmega]"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"\[ImaginaryI]", " ", "\[Kappa]c"}], "+", 
              "\[CapitalOmega]"}], ")"}]}]}], ")"}], " ", 
         RowBox[{"Cos", "[", "\[Theta]b", "]"}]}], 
        RowBox[{
         RowBox[{
          SuperscriptBox["\[Kappa]a", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", 
               SuperscriptBox["x", "2"]}], " ", "\[Kappa]a"}], "+", 
             "\[Kappa]c"}], ")"}], "2"]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"2", " ", 
                SuperscriptBox["x", "2"]}]}], ")"}], " ", 
             SuperscriptBox["\[Kappa]a", "2"]}], "+", 
            SuperscriptBox["\[Kappa]c", "2"]}], ")"}], " ", 
          SuperscriptBox["\[CapitalOmega]", "2"]}], "+", 
         SuperscriptBox["\[CapitalOmega]", "4"]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"4", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "Rpd"}], ")"}], " ", "x", " ", 
         "\[Kappa]a", " ", 
         SqrtBox[
          RowBox[{"\[Kappa]af", " ", "\[Kappa]cf"}]], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["x", "2"], " ", 
            SuperscriptBox["\[Kappa]a", "2"]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Kappa]a"}], "+", 
              "\[CapitalOmega]"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"\[ImaginaryI]", " ", "\[Kappa]c"}], "+", 
              "\[CapitalOmega]"}], ")"}]}]}], ")"}], " ", 
         RowBox[{"Sin", "[", "\[Theta]b", "]"}]}], 
        RowBox[{
         RowBox[{
          SuperscriptBox["\[Kappa]a", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", 
               SuperscriptBox["x", "2"]}], " ", "\[Kappa]a"}], "+", 
             "\[Kappa]c"}], ")"}], "2"]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"2", " ", 
                SuperscriptBox["x", "2"]}]}], ")"}], " ", 
             SuperscriptBox["\[Kappa]a", "2"]}], "+", 
            SuperscriptBox["\[Kappa]c", "2"]}], ")"}], " ", 
          SuperscriptBox["\[CapitalOmega]", "2"]}], "+", 
         SuperscriptBox["\[CapitalOmega]", "4"]}]]}], 
      RowBox[{"1", "-", 
       FractionBox[
        RowBox[{"8", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "Rpd"}], ")"}], " ", 
         SuperscriptBox["x", "2"], " ", 
         SuperscriptBox["\[Kappa]a", "3"], " ", "\[Kappa]cf"}], 
        RowBox[{
         RowBox[{
          SuperscriptBox["\[Kappa]a", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", 
               SuperscriptBox["x", "2"]}], " ", "\[Kappa]a"}], "+", 
             "\[Kappa]c"}], ")"}], "2"]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"2", " ", 
                SuperscriptBox["x", "2"]}]}], ")"}], " ", 
             SuperscriptBox["\[Kappa]a", "2"]}], "+", 
            SuperscriptBox["\[Kappa]c", "2"]}], ")"}], " ", 
          SuperscriptBox["\[CapitalOmega]", "2"]}], "+", 
         SuperscriptBox["\[CapitalOmega]", "4"]}]]}], "0"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{"4", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "Rpd"}], ")"}], " ", "x", " ", 
         "\[Kappa]a", " ", 
         SqrtBox[
          RowBox[{"\[Kappa]af", " ", "\[Kappa]cf"}]], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["x", "2"], " ", 
            SuperscriptBox["\[Kappa]a", "2"]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Kappa]a"}], "+", 
              "\[CapitalOmega]"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"\[ImaginaryI]", " ", "\[Kappa]c"}], "+", 
              "\[CapitalOmega]"}], ")"}]}]}], ")"}], " ", 
         RowBox[{"Sin", "[", "\[Theta]b", "]"}]}], 
        RowBox[{
         RowBox[{
          SuperscriptBox["\[Kappa]a", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", 
               SuperscriptBox["x", "2"]}], " ", "\[Kappa]a"}], "+", 
             "\[Kappa]c"}], ")"}], "2"]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"2", " ", 
                SuperscriptBox["x", "2"]}]}], ")"}], " ", 
             SuperscriptBox["\[Kappa]a", "2"]}], "+", 
            SuperscriptBox["\[Kappa]c", "2"]}], ")"}], " ", 
          SuperscriptBox["\[CapitalOmega]", "2"]}], "+", 
         SuperscriptBox["\[CapitalOmega]", "4"]}]]}], 
      FractionBox[
       RowBox[{"4", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "Rpd"}], ")"}], " ", "x", " ", "\[Kappa]a",
         " ", 
        SqrtBox[
         RowBox[{"\[Kappa]af", " ", "\[Kappa]cf"}]], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["x", "2"], " ", 
           SuperscriptBox["\[Kappa]a", "2"]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Kappa]a"}], "+", 
             "\[CapitalOmega]"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[ImaginaryI]", " ", "\[Kappa]c"}], "+", 
             "\[CapitalOmega]"}], ")"}]}]}], ")"}], " ", 
        RowBox[{"Cos", "[", "\[Theta]b", "]"}]}], 
       RowBox[{
        RowBox[{
         SuperscriptBox["\[Kappa]a", "2"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              SuperscriptBox["x", "2"]}], " ", "\[Kappa]a"}], "+", 
            "\[Kappa]c"}], ")"}], "2"]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"2", " ", 
               SuperscriptBox["x", "2"]}]}], ")"}], " ", 
            SuperscriptBox["\[Kappa]a", "2"]}], "+", 
           SuperscriptBox["\[Kappa]c", "2"]}], ")"}], " ", 
         SuperscriptBox["\[CapitalOmega]", "2"]}], "+", 
        SuperscriptBox["\[CapitalOmega]", "4"]}]], "0", 
      RowBox[{"1", "-", 
       FractionBox[
        RowBox[{"8", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "Rpd"}], ")"}], " ", 
         SuperscriptBox["x", "2"], " ", 
         SuperscriptBox["\[Kappa]a", "3"], " ", "\[Kappa]cf"}], 
        RowBox[{
         RowBox[{
          SuperscriptBox["\[Kappa]a", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", 
               SuperscriptBox["x", "2"]}], " ", "\[Kappa]a"}], "+", 
             "\[Kappa]c"}], ")"}], "2"]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"2", " ", 
                SuperscriptBox["x", "2"]}]}], ")"}], " ", 
             SuperscriptBox["\[Kappa]a", "2"]}], "+", 
            SuperscriptBox["\[Kappa]c", "2"]}], ")"}], " ", 
          SuperscriptBox["\[CapitalOmega]", "2"]}], "+", 
         SuperscriptBox["\[CapitalOmega]", "4"]}]]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.838690063243208*^9},
 CellLabel->
  "Out[11]//MatrixForm=",ExpressionUUID->"1a07ee66-8f84-4b2c-a677-\
66ee3317a31f"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Rpd", " ", "Id"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "Rpd"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"TlGen", ".", 
          RowBox[{"ConjugateTranspose", "[", "TlGen", "]"}]}], "+", 
         RowBox[{"TfGen", ".", 
          RowBox[{"ConjugateTranspose", "[", "TfGen", "]"}]}]}], ")"}]}]}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"g", "\[Rule]", 
        RowBox[{"x", " ", "\[Kappa]a", " ", 
         RowBox[{"Exp", "[", 
          RowBox[{"\[ImaginaryI]", " ", "\[Theta]b"}], "]"}]}]}], ",", 
       RowBox[{"\[Kappa]al", "\[Rule]", 
        RowBox[{"\[Kappa]a", "-", "\[Kappa]af"}]}], ",", 
       RowBox[{"\[Kappa]cl", "\[Rule]", 
        RowBox[{"\[Kappa]c", "-", "\[Kappa]cf"}]}]}], "}"}]}], ",", 
    RowBox[{"Assumptions", "\[Rule]", 
     RowBox[{"Join", "[", 
      RowBox[{"Assumps2", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"x", ">", "0"}], ",", 
         RowBox[{"\[Theta]b", ">", "0"}], ",", 
         RowBox[{"1", ">=", "Rpd", ">=", "0"}]}], "}"}]}], "]"}]}]}], "]"}], "//",
   "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "\[Equal]", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"ConjugateTranspose", "[", "%", "]"}], ",", 
     RowBox[{"Assumptions", "\[Rule]", 
      RowBox[{"Join", "[", 
       RowBox[{"Assumps2", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"x", ">", "0"}], ",", 
          RowBox[{"\[Theta]b", ">", "0"}], ",", 
          RowBox[{"1", ">=", "Rpd", ">=", "0"}]}], "}"}]}], "]"}]}]}], 
    "]"}]}], "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.838666708142048*^9, 3.838666771029999*^9}, {
  3.838666842515074*^9, 3.838666844894525*^9}, {3.838685823871354*^9, 
  3.838685861529482*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"63c6354e-fbd1-4ba6-8470-83ebb82f7923"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "checking", " ", "that", " ", "it", " ", "reduces", " ", "to", " ", 
    "previous", " ", "result"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"reduVGen", "=", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{
       RowBox[{"VGen", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[Kappa]c", "->", "\[Kappa]a"}], ",", 
          RowBox[{"\[Kappa]cf", "->", "\[Kappa]af"}], ",", 
          RowBox[{"g", "\[Rule]", 
           RowBox[{"x", " ", "\[Kappa]a", " ", 
            RowBox[{"Exp", "[", 
             RowBox[{"\[ImaginaryI]", " ", "\[Theta]b"}], "]"}]}]}]}], 
         "}"}]}], ",", 
       RowBox[{"Assumptions", "\[Rule]", 
        RowBox[{"Join", "[", 
         RowBox[{"Assumps2", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"x", ">", "0"}], ",", 
            RowBox[{"\[Theta]b", ">", "0"}], ",", 
            RowBox[{"1", ">=", "Rpd", ">=", "0"}]}], "}"}]}], "]"}]}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"reduVGen", "//", "MatrixForm"}], "\[IndentingNewLine]", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"reduVGen", "/.", 
        RowBox[{"{", 
         RowBox[{"Rpd", "\[Rule]", "0"}], "}"}]}], ")"}], "\[Equal]", 
      RowBox[{"(", 
       RowBox[{"V", "/.", 
        RowBox[{"{", 
         RowBox[{"\[Omega]", "\[Rule]", "\[CapitalOmega]"}], "}"}]}], ")"}]}],
      ",", 
     RowBox[{"Assumptions", "\[Rule]", "Assumps2"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.836268164691433*^9, 3.836268253262068*^9}, {
  3.836268340219005*^9, 3.83626836318045*^9}, {3.836268420946361*^9, 
  3.836268421845707*^9}, {3.8362684550325527`*^9, 3.836268470202567*^9}, {
  3.8362685092272387`*^9, 3.83626858913509*^9}},
 CellLabel->"In[81]:=",ExpressionUUID->"2c6adc32-547d-4451-80df-88bf16a96440"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"NB", ":", " ", 
    RowBox[{
    "diagonal", " ", "elements", " ", "are", " ", "no", " ", "longer", " ", 
     "all", " ", "equal"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"VGen", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], "\[Equal]", 
      RowBox[{"VGen", "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "2"}], "]"}], "]"}]}], ",", 
     RowBox[{"Assumptions", "\[Rule]", "Assumps2"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"VGen", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], "\[Equal]", 
      RowBox[{"VGen", "[", 
       RowBox[{"[", 
        RowBox[{"3", ",", "3"}], "]"}], "]"}]}], ",", 
     RowBox[{"Assumptions", "\[Rule]", "Assumps2"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{"VGen", "[", 
     RowBox[{"[", 
      RowBox[{"2", ",", "2"}], "]"}], "]"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"%", "\[Equal]", 
      RowBox[{"1", "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"8", " ", 
          RowBox[{"(", 
           RowBox[{"1", "-", "Rpd"}], ")"}], " ", "\[Kappa]af", " ", 
          "\[Kappa]c", " ", 
          SuperscriptBox[
           RowBox[{"Abs", "[", "g", "]"}], "2"]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["\[Kappa]a", "2"], "+", 
             SuperscriptBox["\[CapitalOmega]", "2"]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["\[Kappa]c", "2"], "+", 
             SuperscriptBox["\[CapitalOmega]", "2"]}], ")"}]}], "+", 
          SuperscriptBox[
           RowBox[{"Abs", "[", "g", "]"}], "4"], "+", 
          RowBox[{"2", " ", "g", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "\[Kappa]a"}], " ", "\[Kappa]c"}], "+", 
             SuperscriptBox["\[CapitalOmega]", "2"]}], ")"}], " ", 
           RowBox[{"Conjugate", "[", "g", "]"}]}]}], ")"}]}]}]}], ",", 
     "Assumps2"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Collect", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["\[Kappa]a", "2"], "+", 
         SuperscriptBox["\[CapitalOmega]", "2"]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["\[Kappa]c", "2"], "+", 
         SuperscriptBox["\[CapitalOmega]", "2"]}], ")"}]}], "+", 
      SuperscriptBox[
       RowBox[{"Abs", "[", "g", "]"}], "4"], "+", 
      RowBox[{"2", " ", "g", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "\[Kappa]a"}], " ", "\[Kappa]c"}], "+", 
         SuperscriptBox["\[CapitalOmega]", "2"]}], ")"}], " ", 
       RowBox[{"Conjugate", "[", "g", "]"}]}]}], ",", "\[CapitalOmega]"}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.836268603060947*^9, 3.836268681206856*^9}, {
  3.836268787457456*^9, 3.8362687876200733`*^9}, {3.836268863053626*^9, 
  3.8362690086984367`*^9}, {3.836269073496616*^9, 3.8362690740177193`*^9}, {
  3.8362692008746433`*^9, 3.836269206775701*^9}},
 CellLabel->"In[84]:=",ExpressionUUID->"5c6334b0-d781-4eb4-8412-6808af495f18"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
     "noise", " ", "budget", " ", "for", " ", "NOPO", "\[IndentingNewLine]", 
      "VGen"}], " ", "=", " ", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Rpd", " ", "Id"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "Rpd"}], ")"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"TlGen", ".", 
             RowBox[{"ConjugateTranspose", "[", "TlGen", "]"}]}], "+", 
            RowBox[{"TfGen", ".", 
             RowBox[{"ConjugateTranspose", "[", "TfGen", "]"}]}]}], ")"}]}]}],
         "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[Kappa]al", "\[Rule]", 
           RowBox[{"\[Kappa]a", "-", "\[Kappa]af"}]}], ",", 
          RowBox[{"\[Kappa]cl", "\[Rule]", 
           RowBox[{"\[Kappa]c", "-", "\[Kappa]cf"}]}]}], "}"}]}], ",", 
       RowBox[{"Assumptions", "\[Rule]", "Assumps2"}]}], "]"}]}], ";"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"VGenl", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "Rpd"}], ")"}], 
         RowBox[{"(", 
          RowBox[{"TlGen", ".", 
           RowBox[{"ConjugateTranspose", "[", "TlGen", "]"}]}], ")"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[Kappa]al", "\[Rule]", 
           RowBox[{"\[Kappa]a", "-", "\[Kappa]af"}]}], ",", 
          RowBox[{"\[Kappa]cl", "\[Rule]", 
           RowBox[{"\[Kappa]c", "-", "\[Kappa]cf"}]}]}], "}"}]}], ",", 
       RowBox[{"Assumptions", "\[Rule]", "Assumps2"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"VGenf", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "Rpd"}], ")"}], 
         RowBox[{"(", 
          RowBox[{"TfGen", ".", 
           RowBox[{"ConjugateTranspose", "[", "TfGen", "]"}]}], ")"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[Kappa]al", "\[Rule]", 
           RowBox[{"\[Kappa]a", "-", "\[Kappa]af"}]}], ",", 
          RowBox[{"\[Kappa]cl", "\[Rule]", 
           RowBox[{"\[Kappa]c", "-", "\[Kappa]cf"}]}]}], "}"}]}], ",", 
       RowBox[{"Assumptions", "\[Rule]", "Assumps2"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"VGenpd", "=", 
     RowBox[{"Rpd", " ", "Id"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"V11l", "[", 
     RowBox[{
     "\[CapitalOmega]0_", ",", "g0_", ",", "Tal_", ",", "Tcl_", ",", "Tcf_", 
      ",", "Rpd0_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"VGenl", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[CapitalOmega]", "\[Rule]", "\[CapitalOmega]0"}], ",", 
       RowBox[{"g", "\[Rule]", "g0"}], ",", 
       RowBox[{"\[Kappa]af", "\[Rule]", "kout"}], ",", 
       RowBox[{"\[Kappa]a", "\[Rule]", 
        RowBox[{"kout", "+", 
         RowBox[{
          FractionBox[
           RowBox[{"-", "1"}], 
           RowBox[{"2", " ", "tRoundTrip"}]], 
          RowBox[{"Log", "[", 
           RowBox[{"1", "-", "Tal"}], "]"}]}]}]}], ",", 
       RowBox[{"\[Kappa]cf", "\[Rule]", 
        RowBox[{
         FractionBox[
          RowBox[{"-", "1"}], 
          RowBox[{"2", " ", "tRoundTrip"}]], 
         RowBox[{"Log", "[", 
          RowBox[{"1", "-", "Tcf"}], "]"}]}]}], ",", 
       RowBox[{"\[Kappa]c", "\[Rule]", 
        RowBox[{
         RowBox[{
          FractionBox[
           RowBox[{"-", "1"}], 
           RowBox[{"2", " ", "tRoundTrip"}]], 
          RowBox[{"Log", "[", 
           RowBox[{"1", "-", "Tcf"}], "]"}]}], "+", 
         RowBox[{
          FractionBox[
           RowBox[{"-", "1"}], 
           RowBox[{"2", " ", "tRoundTrip"}]], 
          RowBox[{"Log", "[", 
           RowBox[{"1", "-", "Tcl"}], "]"}]}]}]}], ",", 
       RowBox[{"Rpd", "\[Rule]", "Rpd0"}]}], "}"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"V11f", "[", 
     RowBox[{
     "\[CapitalOmega]0_", ",", "g0_", ",", "Tal_", ",", "Tcl_", ",", "Tcf_", 
      ",", "Rpd0_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"VGenf", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[CapitalOmega]", "\[Rule]", "\[CapitalOmega]0"}], ",", 
       RowBox[{"g", "\[Rule]", "g0"}], ",", 
       RowBox[{"\[Kappa]af", "\[Rule]", "kout"}], ",", 
       RowBox[{"\[Kappa]a", "\[Rule]", 
        RowBox[{"kout", "+", 
         RowBox[{
          FractionBox[
           RowBox[{"-", "1"}], 
           RowBox[{"2", " ", "tRoundTrip"}]], 
          RowBox[{"Log", "[", 
           RowBox[{"1", "-", "Tal"}], "]"}]}]}]}], ",", 
       RowBox[{"\[Kappa]cf", "\[Rule]", 
        RowBox[{
         FractionBox[
          RowBox[{"-", "1"}], 
          RowBox[{"2", " ", "tRoundTrip"}]], 
         RowBox[{"Log", "[", 
          RowBox[{"1", "-", "Tcf"}], "]"}]}]}], ",", 
       RowBox[{"\[Kappa]c", "\[Rule]", 
        RowBox[{
         RowBox[{
          FractionBox[
           RowBox[{"-", "1"}], 
           RowBox[{"2", " ", "tRoundTrip"}]], 
          RowBox[{"Log", "[", 
           RowBox[{"1", "-", "Tcf"}], "]"}]}], "+", 
         RowBox[{
          FractionBox[
           RowBox[{"-", "1"}], 
           RowBox[{"2", " ", "tRoundTrip"}]], 
          RowBox[{"Log", "[", 
           RowBox[{"1", "-", "Tcl"}], "]"}]}]}]}], ",", 
       RowBox[{"Rpd", "\[Rule]", "Rpd0"}]}], "}"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"V11pd", "[", 
     RowBox[{
     "\[CapitalOmega]0_", ",", "g0_", ",", "Tal_", ",", "Tcl_", ",", "Tcf_", 
      ",", "Rpd0_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"VGenpd", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[CapitalOmega]", "\[Rule]", "\[CapitalOmega]0"}], ",", 
       RowBox[{"g", "\[Rule]", "g0"}], ",", 
       RowBox[{"\[Kappa]af", "\[Rule]", "kout"}], ",", 
       RowBox[{"\[Kappa]a", "\[Rule]", 
        RowBox[{"kout", "+", 
         RowBox[{
          FractionBox[
           RowBox[{"-", "1"}], 
           RowBox[{"2", " ", "tRoundTrip"}]], 
          RowBox[{"Log", "[", 
           RowBox[{"1", "-", "Tal"}], "]"}]}]}]}], ",", 
       RowBox[{"\[Kappa]cf", "\[Rule]", 
        RowBox[{
         FractionBox[
          RowBox[{"-", "1"}], 
          RowBox[{"2", " ", "tRoundTrip"}]], 
         RowBox[{"Log", "[", 
          RowBox[{"1", "-", "Tcf"}], "]"}]}]}], ",", 
       RowBox[{"\[Kappa]c", "\[Rule]", 
        RowBox[{
         RowBox[{
          FractionBox[
           RowBox[{"-", "1"}], 
           RowBox[{"2", " ", "tRoundTrip"}]], 
          RowBox[{"Log", "[", 
           RowBox[{"1", "-", "Tcf"}], "]"}]}], "+", 
         RowBox[{
          FractionBox[
           RowBox[{"-", "1"}], 
           RowBox[{"2", " ", "tRoundTrip"}]], 
          RowBox[{"Log", "[", 
           RowBox[{"1", "-", "Tcl"}], "]"}]}]}]}], ",", 
       RowBox[{"Rpd", "\[Rule]", "Rpd0"}]}], "}"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"V11tot", "[", 
     RowBox[{
     "\[CapitalOmega]0_", ",", "g0_", ",", "Tal_", ",", "Tcl_", ",", "Tcf_", 
      ",", "Rpd0_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"VGen", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[CapitalOmega]", "\[Rule]", "\[CapitalOmega]0"}], ",", 
       RowBox[{"g", "\[Rule]", "g0"}], ",", 
       RowBox[{"\[Kappa]af", "\[Rule]", "kout"}], ",", 
       RowBox[{"\[Kappa]a", "\[Rule]", 
        RowBox[{"kout", "+", 
         RowBox[{
          FractionBox[
           RowBox[{"-", "1"}], 
           RowBox[{"2", " ", "tRoundTrip"}]], 
          RowBox[{"Log", "[", 
           RowBox[{"1", "-", "Tal"}], "]"}]}]}]}], ",", 
       RowBox[{"\[Kappa]cf", "\[Rule]", 
        RowBox[{
         FractionBox[
          RowBox[{"-", "1"}], 
          RowBox[{"2", " ", "tRoundTrip"}]], 
         RowBox[{"Log", "[", 
          RowBox[{"1", "-", "Tcf"}], "]"}]}]}], ",", 
       RowBox[{"\[Kappa]c", "\[Rule]", 
        RowBox[{
         RowBox[{
          FractionBox[
           RowBox[{"-", "1"}], 
           RowBox[{"2", " ", "tRoundTrip"}]], 
          RowBox[{"Log", "[", 
           RowBox[{"1", "-", "Tcf"}], "]"}]}], "+", 
         RowBox[{
          FractionBox[
           RowBox[{"-", "1"}], 
           RowBox[{"2", " ", "tRoundTrip"}]], 
          RowBox[{"Log", "[", 
           RowBox[{"1", "-", "Tcl"}], "]"}]}]}]}], ",", 
       RowBox[{"Rpd", "\[Rule]", "Rpd0"}]}], "}"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.836596250578486*^9, 3.836596349713683*^9}, {
  3.836596417771418*^9, 3.8365964514821033`*^9}, {3.8365972236011047`*^9, 
  3.836597223974588*^9}},
 CellLabel->"In[89]:=",ExpressionUUID->"faf5c973-6b5c-4d5c-b10b-0c9da42af65d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"plotNoiseBudgetNOPO", "[", "params_", "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"LogLinearPlot", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"20", 
       RowBox[{"Log10", "[", "1", "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"20", " ", 
       RowBox[{"Log10", "[", 
        RowBox[{"V11l", "@@", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", "\[Pi]", " ", "f"}], "}"}], ",", "params"}], "]"}]}],
         "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"20", " ", 
       RowBox[{"Log10", "[", 
        RowBox[{"V11f", "@@", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", "\[Pi]", " ", "f"}], "}"}], ",", "params"}], "]"}]}],
         "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"20", " ", 
       RowBox[{"Log10", "[", 
        RowBox[{"V11pd", "@@", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", "\[Pi]", " ", "f"}], "}"}], ",", "params"}], "]"}]}],
         "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"20", " ", 
       RowBox[{"Log10", "[", 
        RowBox[{"V11tot", "@@", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", "\[Pi]", " ", "f"}], "}"}], ",", "params"}], "]"}]}],
         "]"}]}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"f", ",", "10", ",", 
      SuperscriptBox["10", "9"]}], "}"}], ",", 
    RowBox[{"PlotLegends", "\[Rule]", 
     RowBox[{"LineLegend", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\"\<vacuum\>\"", ",", "\"\<loss port: a and c\>\"", ",", 
         "\"\<SRM: a and c\>\"", ",", "\"\<detection loss\>\"", ",", 
         "\"\<total noise\>\""}], "}"}], ",", 
       RowBox[{"LabelStyle", "\[Rule]", 
        RowBox[{"Directive", "[", "10", "]"}]}], ",", 
       RowBox[{"LegendLabel", "\[Rule]", "\"\<quantum noise budget\>\""}]}], 
      "]"}]}], ",", 
    RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Directive", "[", 
        RowBox[{"Gray", ",", "Dashed"}], "]"}], ",", ",", ",", ",", 
       RowBox[{"Directive", "[", 
        RowBox[{"Black", ",", "Dashed"}], "]"}]}], "}"}]}], ",", 
    RowBox[{"Frame", "->", "True"}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\"\<variance / dB (20log10)\>\"", ","}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<frequency, f=\!\(\*FractionBox[\(\[CapitalOmega]\), \(2  \
\[Pi]\)]\) / Hz\>\"", ",", "\"\<nondegenerate OPO (NOPO)\>\""}], "}"}]}], 
      "}"}]}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"plotNoiseBudgetNOPO", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"0.85", " ", "kout"}], ",", "0", ",", "0", ",", "0", ",", "0"}], 
   "}"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"plotNoiseBudgetNOPO", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"0.85", " ", "kout"}], ",", "0.1", ",", "0", ",", "0", ",", 
    "0.1"}], "}"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"plotNoiseBudgetNOPO", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"0.85", " ", "kout"}], ",", "0.1", ",", "0.1", ",", "0.1", ",", 
    "0.1"}], "}"}], "]"}]}], "Input",
 CellChangeTimes->{
  3.83659670953619*^9, {3.836596746959393*^9, 3.836596828562962*^9}, {
   3.8365969163625393`*^9, 3.836596938166669*^9}, {3.836597061472568*^9, 
   3.836597417038447*^9}, {3.836597470596114*^9, 3.836597498964363*^9}},
 CellLabel->"In[96]:=",ExpressionUUID->"e5eb1624-3b5b-4418-aa0a-46605361e47b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Schori", " ", "et", " ", "al"}], ",", " ", 
    RowBox[{"2002", " ", "method"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"$Assumptions", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[CapitalOmega]", "\[GreaterEqual]", "0"}], ",", 
       RowBox[{"\[Chi]", "\[GreaterEqual]", "0"}], ",", 
       RowBox[{"\[Gamma]btot", "\[GreaterEqual]", "\[Gamma]bR", ">", "0"}], 
       ",", 
       RowBox[{"\[Gamma]ctot", "\[GreaterEqual]", "\[Gamma]cR", ">", "0"}], 
       ",", 
       RowBox[{"1", ">", "Rpd", "\[GreaterEqual]", "0"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"I2", "=", 
     RowBox[{"IdentityMatrix", "[", "2", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"M", "=", 
     RowBox[{
      RowBox[{"(", GridBox[{
         {"\[Gamma]btot", "0"},
         {"0", "\[Gamma]ctot"}
        }], ")"}], "-", 
      RowBox[{"\[ImaginaryI]", " ", "\[CapitalOmega]", " ", "I2"}], "-", 
      RowBox[{"(", GridBox[{
         {"0", "\[Chi]"},
         {"\[Chi]", "0"}
        }], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Mr", "=", 
     RowBox[{
      SuperscriptBox["2", 
       RowBox[{"1", "/", "2"}]], 
      RowBox[{"(", GridBox[{
         {
          SuperscriptBox["\[Gamma]bR", 
           RowBox[{"1", "/", "2"}]], "0"},
         {"0", 
          SuperscriptBox["\[Gamma]cR", 
           RowBox[{"1", "/", "2"}]]}
        }], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Ml", "=", 
     RowBox[{
      SuperscriptBox["2", 
       RowBox[{"1", "/", "2"}]], 
      RowBox[{"(", GridBox[{
         {
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"\[Gamma]btot", "-", "\[Gamma]bR"}], ")"}], 
           RowBox[{"1", "/", "2"}]], "0"},
         {"0", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"\[Gamma]ctot", "-", "\[Gamma]cR"}], ")"}], 
           RowBox[{"1", "/", "2"}]]}
        }], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Tin", "=", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", "Rpd"}], ")"}], 
        RowBox[{"1", "/", "2"}]], 
       RowBox[{"(", 
        RowBox[{"I2", "-", 
         RowBox[{"Mr", ".", 
          RowBox[{"Inverse", "[", "M", "]"}], ".", "Mr"}]}], ")"}]}], "//", 
      "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Tl", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "-", "Rpd"}], ")"}], 
         RowBox[{"1", "/", "2"}]]}], 
       RowBox[{"Mr", ".", 
        RowBox[{"Inverse", "[", "M", "]"}], ".", "Ml"}]}], "//", 
      "Simplify"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FlipI", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[ImaginaryI]", "\[Rule]", 
        RowBox[{"-", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"Complex", "[", 
         RowBox[{"RePart_", ",", "ImPart_"}], "]"}], "\[Rule]", 
        RowBox[{"Complex", "[", 
         RowBox[{"RePart", ",", 
          RowBox[{"-", "ImPart"}]}], "]"}]}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ConjugateFlipI", "=", 
     RowBox[{
      RowBox[{"Conjugate", "[", "f_", "]"}], ":>", 
      RowBox[{"(", 
       RowBox[{"f", "/.", "FlipI"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"V", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Rpd", " ", "I2"}], "+", 
         RowBox[{"Tin", ".", 
          RowBox[{"ConjugateTranspose", "[", "Tin", "]"}]}], "+", 
         RowBox[{"Tl", ".", 
          RowBox[{"ConjugateTranspose", "[", "Tl", "]"}]}]}], ")"}], "/.", 
       "ConjugateFlipI"}], "//", "FullSimplify"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.838689511507783*^9, 3.838689637286807*^9}, {
  3.838689693916954*^9, 3.838689930296603*^9}, {3.838690003237286*^9, 
  3.8386900332730207`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"4da6c5bf-93a5-471c-a240-8e3549647020"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"V", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{
  3.83868989710961*^9, {3.838689982347588*^9, 3.838689983363193*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"be5069a2-2733-4a15-8dee-0f10450d10e7"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"1", "-", 
       FractionBox[
        RowBox[{"8", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "Rpd"}], ")"}], " ", "\[Gamma]bR", " ", 
         "\[Gamma]ctot", " ", 
         SuperscriptBox["\[Chi]", "2"]}], 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "\[Gamma]btot"}], " ", "\[Gamma]ctot"}], "+", 
            SuperscriptBox["\[Chi]", "2"]}], ")"}], "2"], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["\[Gamma]btot", "2"], "+", 
            SuperscriptBox["\[Gamma]ctot", "2"], "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["\[Chi]", "2"]}]}], ")"}], " ", 
          SuperscriptBox["\[CapitalOmega]", "2"]}], "+", 
         SuperscriptBox["\[CapitalOmega]", "4"]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"4", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "Rpd"}], ")"}], " ", 
         SqrtBox[
          RowBox[{"\[Gamma]bR", " ", "\[Gamma]cR"}]], " ", "\[Chi]", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["\[Chi]", "2"], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Gamma]btot"}], "+", 
              "\[CapitalOmega]"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"\[ImaginaryI]", " ", "\[Gamma]ctot"}], "+", 
              "\[CapitalOmega]"}], ")"}]}]}], ")"}]}], 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "\[Gamma]btot"}], " ", "\[Gamma]ctot"}], "+", 
            SuperscriptBox["\[Chi]", "2"]}], ")"}], "2"], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["\[Gamma]btot", "2"], "+", 
            SuperscriptBox["\[Gamma]ctot", "2"], "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["\[Chi]", "2"]}]}], ")"}], " ", 
          SuperscriptBox["\[CapitalOmega]", "2"]}], "+", 
         SuperscriptBox["\[CapitalOmega]", "4"]}]]}]},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{"4", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "Rpd"}], ")"}], " ", 
         SqrtBox[
          RowBox[{"\[Gamma]bR", " ", "\[Gamma]cR"}]], " ", "\[Chi]", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["\[Chi]", "2"], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"\[ImaginaryI]", " ", "\[Gamma]btot"}], "+", 
              "\[CapitalOmega]"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Gamma]ctot"}], "+", 
              "\[CapitalOmega]"}], ")"}]}]}], ")"}]}], 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "\[Gamma]btot"}], " ", "\[Gamma]ctot"}], "+", 
            SuperscriptBox["\[Chi]", "2"]}], ")"}], "2"], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["\[Gamma]btot", "2"], "+", 
            SuperscriptBox["\[Gamma]ctot", "2"], "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["\[Chi]", "2"]}]}], ")"}], " ", 
          SuperscriptBox["\[CapitalOmega]", "2"]}], "+", 
         SuperscriptBox["\[CapitalOmega]", "4"]}]]}], 
      RowBox[{"1", "-", 
       FractionBox[
        RowBox[{"8", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "Rpd"}], ")"}], " ", "\[Gamma]btot", " ", 
         "\[Gamma]cR", " ", 
         SuperscriptBox["\[Chi]", "2"]}], 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "\[Gamma]btot"}], " ", "\[Gamma]ctot"}], "+", 
            SuperscriptBox["\[Chi]", "2"]}], ")"}], "2"], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["\[Gamma]btot", "2"], "+", 
            SuperscriptBox["\[Gamma]ctot", "2"], "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["\[Chi]", "2"]}]}], ")"}], " ", 
          SuperscriptBox["\[CapitalOmega]", "2"]}], "+", 
         SuperscriptBox["\[CapitalOmega]", "4"]}]]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.838689897930336*^9, {3.838689967568328*^9, 3.838689983954906*^9}, {
   3.838690027019969*^9, 3.838690034635103*^9}, 3.838690077268614*^9},
 CellLabel->
  "Out[11]//MatrixForm=",ExpressionUUID->"325d19ee-3cae-4b62-9b07-\
f05f82abdf91"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"combination", " ", "correlations"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Vcom1", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        SuperscriptBox[
         RowBox[{"Cos", "[", "\[Psi]", "]"}], "2"], 
        RowBox[{"V", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "+", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"Sin", "[", "\[Psi]", "]"}], "2"], 
        RowBox[{"V", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"Cos", "[", "\[Psi]", "]"}], 
        RowBox[{"Sin", "[", "\[Psi]", "]"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"V", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "2"}], "]"}], "]"}], "+", 
          RowBox[{"V", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ")"}]}]}], "//", 
      "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Vcom2", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        SuperscriptBox[
         RowBox[{"Sin", "[", "\[Psi]", "]"}], "2"], 
        RowBox[{"V", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "+", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"Cos", "[", "\[Psi]", "]"}], "2"], 
        RowBox[{"V", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "-", 
       RowBox[{
        RowBox[{"Cos", "[", "\[Psi]", "]"}], 
        RowBox[{"Sin", "[", "\[Psi]", "]"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"V", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "2"}], "]"}], "]"}], "+", 
          RowBox[{"V", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ")"}]}]}], "//", 
      "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"1", "+", 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{
        RowBox[{"Numerator", "[", 
         RowBox[{"Together", "[", "Vcom1", "]"}], "]"}], "-", 
        RowBox[{"Denominator", "[", 
         RowBox[{"Together", "[", "Vcom1", "]"}], "]"}]}], 
       RowBox[{"Denominator", "[", 
        RowBox[{"Together", "[", "Vcom1", "]"}], "]"}]], "//", 
      "FullSimplify"}], ")"}]}], "\[IndentingNewLine]", 
   RowBox[{"1", "+", 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{
        RowBox[{"Numerator", "[", 
         RowBox[{"Together", "[", "Vcom2", "]"}], "]"}], "-", 
        RowBox[{"Denominator", "[", 
         RowBox[{"Together", "[", "Vcom2", "]"}], "]"}]}], 
       RowBox[{"Denominator", "[", 
        RowBox[{"Together", "[", "Vcom2", "]"}], "]"}]], "//", 
      "FullSimplify"}], ")"}]}]}]}]], "Input",
 CellChangeTimes->{{3.838692215867223*^9, 3.838692221108374*^9}, {
  3.838692363418994*^9, 3.838692424860334*^9}, {3.838692517532959*^9, 
  3.838692519837575*^9}, {3.838692554600873*^9, 3.838692566775495*^9}, {
  3.838692651099352*^9, 3.83869265159711*^9}, {3.8386927535785646`*^9, 
  3.838692761331246*^9}, {3.8386932403840647`*^9, 3.8386932487788763`*^9}},
 CellLabel->"In[30]:=",ExpressionUUID->"5a758d13-5230-4cf2-a53b-811ab8e19d55"],

Cell[BoxData[
 RowBox[{"1", "-", 
  FractionBox[
   RowBox[{"4", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "Rpd"}], ")"}], " ", "\[Chi]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Gamma]btot", " ", "\[Gamma]cR"}], "+", 
         RowBox[{"\[Gamma]bR", " ", "\[Gamma]ctot"}]}], ")"}], " ", 
       "\[Chi]"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "\[Gamma]btot"}], " ", "\[Gamma]cR"}], "+", 
         RowBox[{"\[Gamma]bR", " ", "\[Gamma]ctot"}]}], ")"}], " ", "\[Chi]", 
       " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", "\[Psi]"}], "]"}]}], "+", 
      RowBox[{
       SqrtBox[
        RowBox[{"\[Gamma]bR", " ", "\[Gamma]cR"}]], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Gamma]btot", " ", "\[Gamma]ctot"}], "+", 
         SuperscriptBox["\[Chi]", "2"], "+", 
         SuperscriptBox["\[CapitalOmega]", "2"]}], ")"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"2", " ", "\[Psi]"}], "]"}]}]}], ")"}]}], 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "\[Gamma]btot"}], " ", "\[Gamma]ctot"}], "+", 
       SuperscriptBox["\[Chi]", "2"]}], ")"}], "2"], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["\[Gamma]btot", "2"], "+", 
       SuperscriptBox["\[Gamma]ctot", "2"], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["\[Chi]", "2"]}]}], ")"}], " ", 
     SuperscriptBox["\[CapitalOmega]", "2"]}], "+", 
    SuperscriptBox["\[CapitalOmega]", "4"]}]]}]], "Output",
 CellChangeTimes->{3.838692567337392*^9, 3.83869265417293*^9, 
  3.838693252587021*^9, 3.838693889692799*^9},
 CellLabel->"Out[32]=",ExpressionUUID->"597aac52-ed92-4705-9e52-e5b108f14fb5"],

Cell[BoxData[
 RowBox[{"1", "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"4", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "Rpd"}], ")"}], " ", "\[Chi]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"\[Gamma]btot", " ", "\[Gamma]cR"}], "+", 
           RowBox[{"\[Gamma]bR", " ", "\[Gamma]ctot"}]}], ")"}]}], " ", 
        "\[Chi]"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[Gamma]btot"}], " ", "\[Gamma]cR"}], "+", 
          RowBox[{"\[Gamma]bR", " ", "\[Gamma]ctot"}]}], ")"}], " ", "\[Chi]",
         " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", "\[Psi]"}], "]"}]}], "+", 
       RowBox[{
        SqrtBox[
         RowBox[{"\[Gamma]bR", " ", "\[Gamma]cR"}]], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Gamma]btot", " ", "\[Gamma]ctot"}], "+", 
          SuperscriptBox["\[Chi]", "2"], "+", 
          SuperscriptBox["\[CapitalOmega]", "2"]}], ")"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"2", " ", "\[Psi]"}], "]"}]}]}], ")"}]}], ")"}], "/", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "\[Gamma]btot"}], " ", "\[Gamma]ctot"}], "+", 
        SuperscriptBox["\[Chi]", "2"]}], ")"}], "2"], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["\[Gamma]btot", "2"], "+", 
        SuperscriptBox["\[Gamma]ctot", "2"], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["\[Chi]", "2"]}]}], ")"}], " ", 
      SuperscriptBox["\[CapitalOmega]", "2"]}], "+", 
     SuperscriptBox["\[CapitalOmega]", "4"]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.838692567337392*^9, 3.83869265417293*^9, 
  3.838693252587021*^9, 3.8386938901753063`*^9},
 CellLabel->"Out[33]=",ExpressionUUID->"ebcabeee-a525-4ce4-85ce-883ca93439a8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"4", "\[Epsilon]", " ", "\[Eta]", " ", 
       FractionBox[
        RowBox[{
         RowBox[{"2", "\[Epsilon]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Sigma]", " ", 
             SuperscriptBox[
              RowBox[{"Cos", "[", "\[Psi]", "]"}], "2"]}], "+", 
            RowBox[{
             RowBox[{"1", "/", "\[Sigma]"}], " ", 
             SuperscriptBox[
              RowBox[{"Sin", "[", "\[Psi]", "]"}], "2"]}]}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["\[CapitalDelta]", "2"], "+", "1", "+", 
            SuperscriptBox["\[Epsilon]", "2"]}], ")"}], 
          RowBox[{"Sin", "[", 
           RowBox[{"2", "\[Psi]"}], "]"}]}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["\[CapitalDelta]", "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"EE", "+", "\[CapitalLambda]"}], ")"}], "2"]}], ")"}], 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["\[CapitalDelta]", "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"EE", "-", "\[CapitalLambda]"}], ")"}], "2"]}], 
          ")"}]}]]}]}], ")"}], "/.", 
    RowBox[{"EE", "->", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["\[Epsilon]", "2"], "+", 
        SuperscriptBox["\[CapitalLambda]", "2"], "-", "1"}], ")"}], 
      RowBox[{"1", "/", "2"}]]}]}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Epsilon]", "\[Rule]", 
      RowBox[{"\[Chi]", "/", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"\[Gamma]btot", " ", "\[Gamma]ctot"}], ")"}], 
        RowBox[{"1", "/", "2"}]]}]}], ",", 
     RowBox[{"\[Sigma]", "->", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"\[Gamma]btot", "/", "\[Gamma]ctot"}], ")"}], 
       RowBox[{"1", "/", "2"}]]}], ",", 
     RowBox[{"\[CapitalDelta]", "\[Rule]", 
      RowBox[{"\[CapitalOmega]", "/", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"\[Gamma]btot", " ", "\[Gamma]ctot"}], ")"}], 
        RowBox[{"1", "/", "2"}]]}]}], ",", 
     RowBox[{"\[CapitalLambda]", "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"\[Gamma]btot", "/", "\[Gamma]ctot"}], ")"}], 
          RowBox[{"1", "/", "2"}]], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"\[Gamma]ctot", "/", "\[Gamma]btot"}], ")"}], 
          RowBox[{"1", "/", "2"}]]}], ")"}], "/", "2"}]}], ",", 
     RowBox[{"\[Eta]", "\[Rule]", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"\[Gamma]bR", " ", "\[Gamma]cR"}], ")"}], 
       RowBox[{"1", "/", "2"}]]}]}], "}"}]}], "//", "FullSimplify"}]], "Input",\

 CellChangeTimes->{{3.838693309332933*^9, 3.8386933468714046`*^9}, {
  3.838693475055512*^9, 3.83869377730016*^9}},
 CellLabel->"In[28]:=",ExpressionUUID->"0c4968ca-d6cd-4a6c-9acd-bf207f8e43ab"],

Cell[BoxData[
 RowBox[{"1", "+", 
  FractionBox[
   RowBox[{"4", " ", "\[Gamma]btot", " ", 
    SqrtBox[
     FractionBox[
      RowBox[{"\[Gamma]bR", " ", "\[Gamma]cR", " ", "\[Gamma]ctot"}], 
      "\[Gamma]btot"]], " ", "\[Chi]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "\[Gamma]btot", " ", "\[Chi]", " ", 
       SuperscriptBox[
        RowBox[{"Cos", "[", "\[Psi]", "]"}], "2"]}], "+", 
      RowBox[{"2", " ", "\[Gamma]ctot", " ", "\[Chi]", " ", 
       SuperscriptBox[
        RowBox[{"Sin", "[", "\[Psi]", "]"}], "2"]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Gamma]btot", " ", "\[Gamma]ctot"}], "+", 
         SuperscriptBox["\[Chi]", "2"], "+", 
         SuperscriptBox["\[CapitalOmega]", "2"]}], ")"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"2", " ", "\[Psi]"}], "]"}]}]}], ")"}]}], 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "\[Gamma]btot"}], " ", "\[Gamma]ctot"}], "+", 
       SuperscriptBox["\[Chi]", "2"]}], ")"}], "2"], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["\[Gamma]btot", "2"], "+", 
       SuperscriptBox["\[Gamma]ctot", "2"], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["\[Chi]", "2"]}]}], ")"}], " ", 
     SuperscriptBox["\[CapitalOmega]", "2"]}], "+", 
    SuperscriptBox["\[CapitalOmega]", "4"]}]]}]], "Output",
 CellChangeTimes->{3.838693784167816*^9, 3.838693868799098*^9},
 CellLabel->"Out[28]=",ExpressionUUID->"0fb4e79c-7e19-4ce6-bfbb-2f958864d6fc"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"U", "=", 
   RowBox[{"(", GridBox[{
      {
       RowBox[{"Cos", "[", "\[Psi]", "]"}], 
       RowBox[{"Sin", "[", "\[Psi]", "]"}]},
      {
       RowBox[{"-", 
        RowBox[{"Sin", "[", "\[Psi]", "]"}]}], 
       RowBox[{"Cos", "[", "\[Psi]", "]"}]}
     }], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"VcomMat", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Rpd", " ", "I2"}], "+", 
       RowBox[{"U", ".", "Tin", ".", 
        RowBox[{"ConjugateTranspose", "[", "Tin", "]"}], ".", 
        RowBox[{"Inverse", "[", "U", "]"}]}], "+", 
       RowBox[{"U", ".", "Tl", ".", 
        RowBox[{"ConjugateTranspose", "[", "Tl", "]"}], ".", 
        RowBox[{"Inverse", "[", "U", "]"}]}]}], ")"}], "/.", 
     "ConjugateFlipI"}], "//", "FullSimplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"VcomMat", "/.", 
   RowBox[{"Rpd", "\[Rule]", "0"}]}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"VcomMat", "/.", 
      RowBox[{"Rpd", "\[Rule]", "0"}]}], ")"}], "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1"}], "]"}], "]"}], "\[Equal]", 
   RowBox[{"(", 
    RowBox[{"Vcom1", "/.", 
     RowBox[{"Rpd", "\[Rule]", "0"}]}], ")"}]}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"U", ".", "V", ".", 
      RowBox[{"Inverse", "[", "U", "]"}]}], ")"}], "/.", 
    RowBox[{"Rpd", "\[Rule]", "0"}]}], "//", "FullSimplify"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"1", "+", 
    FractionBox[
     RowBox[{"4", " ", "\[Chi]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"\[Gamma]btot", " ", "\[Gamma]cR"}], "+", 
           RowBox[{"\[Gamma]bR", " ", "\[Gamma]ctot"}]}], ")"}], " ", 
         "\[Chi]"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "\[Gamma]btot"}], " ", "\[Gamma]cR"}], "+", 
           RowBox[{"\[Gamma]bR", " ", "\[Gamma]ctot"}]}], ")"}], " ", 
         "\[Chi]", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", "\[Psi]"}], "]"}]}], "+", 
        RowBox[{
         SqrtBox[
          RowBox[{"\[Gamma]bR", " ", "\[Gamma]cR"}]], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"\[Gamma]btot", " ", "\[Gamma]ctot"}], "+", 
           SuperscriptBox["\[Chi]", "2"], "+", 
           SuperscriptBox["\[CapitalOmega]", "2"]}], ")"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", "\[Psi]"}], "]"}]}]}], ")"}]}], 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "\[Gamma]btot"}], " ", "\[Gamma]ctot"}], "+", 
         SuperscriptBox["\[Chi]", "2"]}], ")"}], "2"], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["\[Gamma]btot", "2"], "+", 
         SuperscriptBox["\[Gamma]ctot", "2"], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["\[Chi]", "2"]}]}], ")"}], " ", 
       SuperscriptBox["\[CapitalOmega]", "2"]}], "+", 
      SuperscriptBox["\[CapitalOmega]", "4"]}]]}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.8386939819493427`*^9, 3.838694035882656*^9}, {
  3.838694439651301*^9, 3.8386944848867826`*^9}, {3.838694568227573*^9, 
  3.83869461360351*^9}, {3.838694667611924*^9, 3.838694720205694*^9}},
 CellLabel->"In[60]:=",ExpressionUUID->"6c27349e-91f3-4255-b27d-61717ae8d716"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox[
       RowBox[{
        RowBox[{"4", " ", "\[Gamma]bR", " ", "\[Gamma]ctot", " ", 
         SuperscriptBox["\[Chi]", "2"]}], "-", 
        RowBox[{"2", " ", "\[Gamma]btot", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "\[Gamma]cR"}], "+", "\[Gamma]ctot"}], 
          ")"}], " ", 
         SuperscriptBox["\[Chi]", "2"]}], "+", 
        RowBox[{
         SuperscriptBox["\[Gamma]ctot", "2"], " ", 
         SuperscriptBox["\[CapitalOmega]", "2"]}], "+", 
        RowBox[{
         SuperscriptBox["\[Gamma]btot", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["\[Gamma]ctot", "2"], "+", 
           SuperscriptBox["\[CapitalOmega]", "2"]}], ")"}]}], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["\[Chi]", "2"], "+", 
           SuperscriptBox["\[CapitalOmega]", "2"]}], ")"}], "2"], "+", 
        RowBox[{"4", " ", "\[Chi]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "\[Gamma]btot"}], " ", "\[Gamma]cR"}], "+", 
              RowBox[{"\[Gamma]bR", " ", "\[Gamma]ctot"}]}], ")"}], " ", 
            "\[Chi]", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", "\[Psi]"}], "]"}]}], "+", 
           RowBox[{
            SqrtBox[
             RowBox[{"\[Gamma]bR", " ", "\[Gamma]cR"}]], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"\[Gamma]btot", " ", "\[Gamma]ctot"}], "+", 
              SuperscriptBox["\[Chi]", "2"], "+", 
              SuperscriptBox["\[CapitalOmega]", "2"]}], ")"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"2", " ", "\[Psi]"}], "]"}]}]}], ")"}]}]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "\[Gamma]btot"}], " ", "\[Gamma]ctot"}], "+", 
           SuperscriptBox["\[Chi]", "2"]}], ")"}], "2"], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["\[Gamma]btot", "2"], "+", 
           SuperscriptBox["\[Gamma]ctot", "2"], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["\[Chi]", "2"]}]}], ")"}], " ", 
         SuperscriptBox["\[CapitalOmega]", "2"]}], "+", 
        SuperscriptBox["\[CapitalOmega]", "4"]}]], 
      FractionBox[
       RowBox[{"4", " ", "\[Chi]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], " ", 
           SqrtBox[
            RowBox[{"\[Gamma]bR", " ", "\[Gamma]cR"}]], " ", 
           RowBox[{"(", 
            RowBox[{"\[Gamma]btot", "-", "\[Gamma]ctot"}], ")"}], " ", 
           "\[CapitalOmega]"}], "+", 
          RowBox[{
           SqrtBox[
            RowBox[{"\[Gamma]bR", " ", "\[Gamma]cR"}]], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[Gamma]btot", " ", "\[Gamma]ctot"}], "+", 
             SuperscriptBox["\[Chi]", "2"], "+", 
             SuperscriptBox["\[CapitalOmega]", "2"]}], ")"}], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", "\[Psi]"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[Gamma]btot", " ", "\[Gamma]cR"}], "-", 
             RowBox[{"\[Gamma]bR", " ", "\[Gamma]ctot"}]}], ")"}], " ", 
           "\[Chi]", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"2", " ", "\[Psi]"}], "]"}]}]}], ")"}]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "\[Gamma]btot"}], " ", "\[Gamma]ctot"}], "+", 
           SuperscriptBox["\[Chi]", "2"]}], ")"}], "2"], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["\[Gamma]btot", "2"], "+", 
           SuperscriptBox["\[Gamma]ctot", "2"], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["\[Chi]", "2"]}]}], ")"}], " ", 
         SuperscriptBox["\[CapitalOmega]", "2"]}], "+", 
        SuperscriptBox["\[CapitalOmega]", "4"]}]]},
     {
      FractionBox[
       RowBox[{"4", " ", "\[Chi]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[ImaginaryI]", " ", 
           SqrtBox[
            RowBox[{"\[Gamma]bR", " ", "\[Gamma]cR"}]], " ", 
           RowBox[{"(", 
            RowBox[{"\[Gamma]btot", "-", "\[Gamma]ctot"}], ")"}], " ", 
           "\[CapitalOmega]"}], "+", 
          RowBox[{
           SqrtBox[
            RowBox[{"\[Gamma]bR", " ", "\[Gamma]cR"}]], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[Gamma]btot", " ", "\[Gamma]ctot"}], "+", 
             SuperscriptBox["\[Chi]", "2"], "+", 
             SuperscriptBox["\[CapitalOmega]", "2"]}], ")"}], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", "\[Psi]"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[Gamma]btot", " ", "\[Gamma]cR"}], "-", 
             RowBox[{"\[Gamma]bR", " ", "\[Gamma]ctot"}]}], ")"}], " ", 
           "\[Chi]", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"2", " ", "\[Psi]"}], "]"}]}]}], ")"}]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "\[Gamma]btot"}], " ", "\[Gamma]ctot"}], "+", 
           SuperscriptBox["\[Chi]", "2"]}], ")"}], "2"], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["\[Gamma]btot", "2"], "+", 
           SuperscriptBox["\[Gamma]ctot", "2"], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["\[Chi]", "2"]}]}], ")"}], " ", 
         SuperscriptBox["\[CapitalOmega]", "2"]}], "+", 
        SuperscriptBox["\[CapitalOmega]", "4"]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"4", " ", "\[Gamma]bR", " ", "\[Gamma]ctot", " ", 
         SuperscriptBox["\[Chi]", "2"]}], "-", 
        RowBox[{"2", " ", "\[Gamma]btot", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "\[Gamma]cR"}], "+", "\[Gamma]ctot"}], 
          ")"}], " ", 
         SuperscriptBox["\[Chi]", "2"]}], "+", 
        RowBox[{
         SuperscriptBox["\[Gamma]ctot", "2"], " ", 
         SuperscriptBox["\[CapitalOmega]", "2"]}], "+", 
        RowBox[{
         SuperscriptBox["\[Gamma]btot", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["\[Gamma]ctot", "2"], "+", 
           SuperscriptBox["\[CapitalOmega]", "2"]}], ")"}]}], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["\[Chi]", "2"], "+", 
           SuperscriptBox["\[CapitalOmega]", "2"]}], ")"}], "2"], "-", 
        RowBox[{"4", " ", "\[Chi]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "\[Gamma]btot"}], " ", "\[Gamma]cR"}], "+", 
              RowBox[{"\[Gamma]bR", " ", "\[Gamma]ctot"}]}], ")"}], " ", 
            "\[Chi]", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", "\[Psi]"}], "]"}]}], "+", 
           RowBox[{
            SqrtBox[
             RowBox[{"\[Gamma]bR", " ", "\[Gamma]cR"}]], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"\[Gamma]btot", " ", "\[Gamma]ctot"}], "+", 
              SuperscriptBox["\[Chi]", "2"], "+", 
              SuperscriptBox["\[CapitalOmega]", "2"]}], ")"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"2", " ", "\[Psi]"}], "]"}]}]}], ")"}]}]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "\[Gamma]btot"}], " ", "\[Gamma]ctot"}], "+", 
           SuperscriptBox["\[Chi]", "2"]}], ")"}], "2"], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["\[Gamma]btot", "2"], "+", 
           SuperscriptBox["\[Gamma]ctot", "2"], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["\[Chi]", "2"]}]}], ")"}], " ", 
         SuperscriptBox["\[CapitalOmega]", "2"]}], "+", 
        SuperscriptBox["\[CapitalOmega]", "4"]}]]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.838694487200164*^9, 3.838694489413739*^9}, 
   3.838694569514312*^9, 3.8386946195855923`*^9, {3.83869470936512*^9, 
   3.8386947206750927`*^9}},
 CellLabel->
  "Out[62]//MatrixForm=",ExpressionUUID->"df35366b-39c2-4167-863f-\
2aa689668663"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.838694487200164*^9, 3.838694489413739*^9}, 
   3.838694569514312*^9, 3.8386946195855923`*^9, {3.83869470936512*^9, 
   3.838694720680326*^9}},
 CellLabel->"Out[63]=",ExpressionUUID->"97fa1d3d-7492-4a52-9987-567d8dd78fdb"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox[
       RowBox[{
        RowBox[{"2", " ", "\[Gamma]btot", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "\[Gamma]cR"}], "-", "\[Gamma]ctot"}], ")"}], 
         " ", 
         SuperscriptBox["\[Chi]", "2"]}], "+", 
        RowBox[{"4", " ", "\[Gamma]bR", " ", "\[Gamma]ctot", " ", 
         SuperscriptBox["\[Chi]", "2"]}], "+", 
        RowBox[{
         SuperscriptBox["\[Gamma]ctot", "2"], " ", 
         SuperscriptBox["\[CapitalOmega]", "2"]}], "+", 
        RowBox[{
         SuperscriptBox["\[Gamma]btot", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["\[Gamma]ctot", "2"], "+", 
           SuperscriptBox["\[CapitalOmega]", "2"]}], ")"}]}], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["\[Chi]", "2"], "+", 
           SuperscriptBox["\[CapitalOmega]", "2"]}], ")"}], "2"], "+", 
        RowBox[{"4", " ", "\[Chi]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "\[Gamma]btot"}], " ", "\[Gamma]cR"}], "+", 
              RowBox[{"\[Gamma]bR", " ", "\[Gamma]ctot"}]}], ")"}], " ", 
            "\[Chi]", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", "\[Psi]"}], "]"}]}], "+", 
           RowBox[{
            SqrtBox[
             RowBox[{"\[Gamma]bR", " ", "\[Gamma]cR"}]], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"\[Gamma]btot", " ", "\[Gamma]ctot"}], "+", 
              SuperscriptBox["\[Chi]", "2"], "+", 
              SuperscriptBox["\[CapitalOmega]", "2"]}], ")"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"2", " ", "\[Psi]"}], "]"}]}]}], ")"}]}]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "\[Gamma]btot"}], " ", "\[Gamma]ctot"}], "+", 
           SuperscriptBox["\[Chi]", "2"]}], ")"}], "2"], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["\[Gamma]btot", "2"], "+", 
           SuperscriptBox["\[Gamma]ctot", "2"], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["\[Chi]", "2"]}]}], ")"}], " ", 
         SuperscriptBox["\[CapitalOmega]", "2"]}], "+", 
        SuperscriptBox["\[CapitalOmega]", "4"]}]], 
      FractionBox[
       RowBox[{"4", " ", "\[Chi]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], " ", 
           SqrtBox[
            RowBox[{"\[Gamma]bR", " ", "\[Gamma]cR"}]], " ", 
           RowBox[{"(", 
            RowBox[{"\[Gamma]btot", "-", "\[Gamma]ctot"}], ")"}], " ", 
           "\[CapitalOmega]"}], "+", 
          RowBox[{
           SqrtBox[
            RowBox[{"\[Gamma]bR", " ", "\[Gamma]cR"}]], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[Gamma]btot", " ", "\[Gamma]ctot"}], "+", 
             SuperscriptBox["\[Chi]", "2"], "+", 
             SuperscriptBox["\[CapitalOmega]", "2"]}], ")"}], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", "\[Psi]"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[Gamma]btot", " ", "\[Gamma]cR"}], "-", 
             RowBox[{"\[Gamma]bR", " ", "\[Gamma]ctot"}]}], ")"}], " ", 
           "\[Chi]", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"2", " ", "\[Psi]"}], "]"}]}]}], ")"}]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "\[Gamma]btot"}], " ", "\[Gamma]ctot"}], "+", 
           SuperscriptBox["\[Chi]", "2"]}], ")"}], "2"], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["\[Gamma]btot", "2"], "+", 
           SuperscriptBox["\[Gamma]ctot", "2"], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["\[Chi]", "2"]}]}], ")"}], " ", 
         SuperscriptBox["\[CapitalOmega]", "2"]}], "+", 
        SuperscriptBox["\[CapitalOmega]", "4"]}]]},
     {
      FractionBox[
       RowBox[{"4", " ", "\[Chi]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[ImaginaryI]", " ", 
           SqrtBox[
            RowBox[{"\[Gamma]bR", " ", "\[Gamma]cR"}]], " ", 
           RowBox[{"(", 
            RowBox[{"\[Gamma]btot", "-", "\[Gamma]ctot"}], ")"}], " ", 
           "\[CapitalOmega]"}], "+", 
          RowBox[{
           SqrtBox[
            RowBox[{"\[Gamma]bR", " ", "\[Gamma]cR"}]], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[Gamma]btot", " ", "\[Gamma]ctot"}], "+", 
             SuperscriptBox["\[Chi]", "2"], "+", 
             SuperscriptBox["\[CapitalOmega]", "2"]}], ")"}], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", "\[Psi]"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[Gamma]btot", " ", "\[Gamma]cR"}], "-", 
             RowBox[{"\[Gamma]bR", " ", "\[Gamma]ctot"}]}], ")"}], " ", 
           "\[Chi]", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"2", " ", "\[Psi]"}], "]"}]}]}], ")"}]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "\[Gamma]btot"}], " ", "\[Gamma]ctot"}], "+", 
           SuperscriptBox["\[Chi]", "2"]}], ")"}], "2"], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["\[Gamma]btot", "2"], "+", 
           SuperscriptBox["\[Gamma]ctot", "2"], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["\[Chi]", "2"]}]}], ")"}], " ", 
         SuperscriptBox["\[CapitalOmega]", "2"]}], "+", 
        SuperscriptBox["\[CapitalOmega]", "4"]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"2", " ", "\[Gamma]btot", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "\[Gamma]cR"}], "-", "\[Gamma]ctot"}], ")"}], 
         " ", 
         SuperscriptBox["\[Chi]", "2"]}], "+", 
        RowBox[{"4", " ", "\[Gamma]bR", " ", "\[Gamma]ctot", " ", 
         SuperscriptBox["\[Chi]", "2"]}], "+", 
        RowBox[{
         SuperscriptBox["\[Gamma]ctot", "2"], " ", 
         SuperscriptBox["\[CapitalOmega]", "2"]}], "+", 
        RowBox[{
         SuperscriptBox["\[Gamma]btot", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["\[Gamma]ctot", "2"], "+", 
           SuperscriptBox["\[CapitalOmega]", "2"]}], ")"}]}], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["\[Chi]", "2"], "+", 
           SuperscriptBox["\[CapitalOmega]", "2"]}], ")"}], "2"], "-", 
        RowBox[{"4", " ", "\[Chi]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "\[Gamma]btot"}], " ", "\[Gamma]cR"}], "+", 
              RowBox[{"\[Gamma]bR", " ", "\[Gamma]ctot"}]}], ")"}], " ", 
            "\[Chi]", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", "\[Psi]"}], "]"}]}], "+", 
           RowBox[{
            SqrtBox[
             RowBox[{"\[Gamma]bR", " ", "\[Gamma]cR"}]], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"\[Gamma]btot", " ", "\[Gamma]ctot"}], "+", 
              SuperscriptBox["\[Chi]", "2"], "+", 
              SuperscriptBox["\[CapitalOmega]", "2"]}], ")"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"2", " ", "\[Psi]"}], "]"}]}]}], ")"}]}]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "\[Gamma]btot"}], " ", "\[Gamma]ctot"}], "+", 
           SuperscriptBox["\[Chi]", "2"]}], ")"}], "2"], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["\[Gamma]btot", "2"], "+", 
           SuperscriptBox["\[Gamma]ctot", "2"], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["\[Chi]", "2"]}]}], ")"}], " ", 
         SuperscriptBox["\[CapitalOmega]", "2"]}], "+", 
        SuperscriptBox["\[CapitalOmega]", "4"]}]]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.838694487200164*^9, 3.838694489413739*^9}, 
   3.838694569514312*^9, 3.8386946195855923`*^9, {3.83869470936512*^9, 
   3.8386947206842012`*^9}},
 CellLabel->
  "Out[64]//MatrixForm=",ExpressionUUID->"dd68f0b0-7cda-4fe4-b5a2-\
0f993fc65222"]
}, Open  ]]
},
WindowSize->{1562, 862},
WindowMargins->{{1922, Automatic}, {Automatic, 166}},
Magnification:>1.5 Inherited,
FrontEndVersion->"11.3 for Linux x86 (64-bit) (March 6, 2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 347, 8, 125, "Text",ExpressionUUID->"a05200c5-c521-4b6e-b424-86e07dabe570"],
Cell[908, 30, 538, 15, 54, "Text",ExpressionUUID->"ca20a264-25e2-4796-9056-19bee610b50e"],
Cell[1449, 47, 2665, 78, 677, "Input",ExpressionUUID->"42d83666-4f6c-4e2b-990a-a38e3d9a22ec"],
Cell[4117, 127, 1354, 36, 120, "Input",ExpressionUUID->"7b8d66d9-74b8-4ae3-8d54-04d1f52a2d1b"],
Cell[5474, 165, 623, 12, 82, "Input",ExpressionUUID->"ce9cfe77-5588-42f5-86fc-f43f3f3aae83"],
Cell[6100, 179, 887, 19, 47, "Input",ExpressionUUID->"b6612c5d-4f15-43b0-bd96-236375be9071"],
Cell[6990, 200, 3877, 101, 268, "Input",ExpressionUUID->"60245e0a-b18c-4dbd-aeb4-35bfcf2d1ace"],
Cell[10870, 303, 4180, 116, 272, "Input",ExpressionUUID->"9c83c4e5-afbd-4588-a07e-add34736b696"],
Cell[15053, 421, 1517, 42, 157, "Input",ExpressionUUID->"3bbf1121-7a7a-465b-a9b8-efd82437aa9a"],
Cell[16573, 465, 1919, 45, 184, "Input",ExpressionUUID->"876a3012-4db6-4a05-bd4a-b69a0f88b998"],
Cell[18495, 512, 274, 6, 47, "Input",ExpressionUUID->"6c2ea06b-f9e4-4101-a6e9-2bed25faaa62"],
Cell[18772, 520, 641, 15, 82, "Input",ExpressionUUID->"6109cbb5-78f3-42a3-be5f-088eaa742d11"],
Cell[19416, 537, 208, 4, 54, "Text",ExpressionUUID->"9f769486-c43a-425b-9f57-c6852615a46c"],
Cell[19627, 543, 3337, 84, 375, "Input",ExpressionUUID->"baf790ca-fe34-42d6-97bb-71db0f768986"],
Cell[22967, 629, 784, 20, 116, "Input",ExpressionUUID->"524336a8-c033-4272-a92d-2bb29f74dd17"],
Cell[23754, 651, 299, 7, 54, "Text",ExpressionUUID->"8e3464c1-b9c0-4855-ab8e-d6e4dec1a3d3"],
Cell[24056, 660, 4960, 86, 126, "Input",ExpressionUUID->"a87c3ed5-bcdb-4424-adc8-8c7944ecb967"],
Cell[29019, 748, 497, 11, 47, "Input",ExpressionUUID->"367c6a75-dff7-4d73-acfc-4b4ec1008503"],
Cell[29519, 761, 12468, 324, 2092, "Input",ExpressionUUID->"6271967f-9ebc-4495-a23a-a5002fd3c14d"],
Cell[41990, 1087, 7717, 196, 1194, "Input",ExpressionUUID->"b60d38f1-f753-4f86-ac1c-3ef626e3fc30"],
Cell[49710, 1285, 2377, 67, 345, "Input",ExpressionUUID->"afc73798-ccaf-43e1-8845-509f309880ce"],
Cell[52090, 1354, 18065, 394, 1874, "Input",ExpressionUUID->"dc2419f5-1825-423c-8c17-c28ca7679679"],
Cell[70158, 1750, 2171, 55, 337, "Input",ExpressionUUID->"f68cec37-3d78-48dd-aa55-6eb290d4a71b"],
Cell[72332, 1807, 7751, 199, 1242, "Input",ExpressionUUID->"f2455dc5-ea52-4213-a106-86ca368c0212"],
Cell[80086, 2008, 11319, 295, 1631, "Input",ExpressionUUID->"9078f2fd-8f04-4df4-a0b7-27d6d2095637"],
Cell[91408, 2305, 8765, 240, 832, "Input",ExpressionUUID->"a0d8d83d-95cc-4f9b-8224-a99d4af539bf"],
Cell[100176, 2547, 3040, 79, 649, "Input",ExpressionUUID->"3368c043-dcc6-478a-b2f2-8755f03eb9ab"],
Cell[103219, 2628, 1737, 35, 82, "Input",ExpressionUUID->"551e6a63-32d5-4861-8697-0fb253b3f971"],
Cell[CellGroupData[{
Cell[104981, 2667, 3180, 82, 286, "Input",ExpressionUUID->"b20a28b4-1450-4c5b-974f-d5e0c9718b7f"],
Cell[108164, 2751, 18281, 519, 368, "Output",ExpressionUUID->"1a07ee66-8f84-4b2c-a677-66ee3317a31f"]
}, Open  ]],
Cell[126460, 3273, 1970, 52, 184, "Input",ExpressionUUID->"63c6354e-fbd1-4ba6-8470-83ebb82f7923"],
Cell[128433, 3327, 1905, 48, 184, "Input",ExpressionUUID->"2c6adc32-547d-4451-80df-88bf16a96440"],
Cell[130341, 3377, 3446, 93, 264, "Input",ExpressionUUID->"5c6334b0-d781-4eb4-8412-6808af495f18"],
Cell[133790, 3472, 8999, 252, 1034, "Input",ExpressionUUID->"faf5c973-6b5c-4d5c-b10b-0c9da42af65d"],
Cell[142792, 3726, 3692, 95, 544, "Input",ExpressionUUID->"e5eb1624-3b5b-4418-aa0a-46605361e47b"],
Cell[146487, 3823, 4189, 125, 514, "Input",ExpressionUUID->"4da6c5bf-93a5-471c-a240-8e3549647020"],
Cell[CellGroupData[{
Cell[150701, 3952, 228, 4, 47, "Input",ExpressionUUID->"be5069a2-2733-4a15-8dee-0f10450d10e7"],
Cell[150932, 3958, 5312, 145, 177, "Output",ExpressionUUID->"325d19ee-3cae-4b62-9b07-f05f82abdf91"]
}, Open  ]],
Cell[CellGroupData[{
Cell[156281, 4108, 3263, 91, 271, "Input",ExpressionUUID->"5a758d13-5230-4cf2-a53b-811ab8e19d55"],
Cell[159547, 4201, 1847, 52, 134, "Output",ExpressionUUID->"597aac52-ed92-4705-9e52-e5b108f14fb5"],
Cell[161397, 4255, 1974, 55, 161, "Output",ExpressionUUID->"ebcabeee-a525-4ce4-85ce-883ca93439a8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[163408, 4315, 3105, 86, 181, "Input",ExpressionUUID->"0c4968ca-d6cd-4a6c-9acd-bf207f8e43ab"],
Cell[166516, 4403, 1562, 41, 127, "Output",ExpressionUUID->"0fb4e79c-7e19-4ce6-bfbb-2f958864d6fc"]
}, Open  ]],
Cell[CellGroupData[{
Cell[168115, 4449, 3588, 102, 319, "Input",ExpressionUUID->"6c27349e-91f3-4255-b27d-61717ae8d716"],
Cell[171706, 4553, 9135, 238, 177, "Output",ExpressionUUID->"df35366b-39c2-4167-863f-2aa689668663"],
Cell[180844, 4793, 275, 4, 53, "Output",ExpressionUUID->"97fa1d3d-7492-4a52-9987-567d8dd78fdb"],
Cell[181122, 4799, 9077, 236, 234, "Output",ExpressionUUID->"dd68f0b0-7cda-4fe4-b5a2-0f993fc65222"]
}, Open  ]]
}
]
*)

